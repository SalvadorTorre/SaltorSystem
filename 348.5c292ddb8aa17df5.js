"use strict";(self.webpackChunkSaltorSystem=self.webpackChunkSaltorSystem||[]).push([[348],{9348:(gt,j,u)=>{u.r(j),u.d(j,{ModuloCotizacion:()=>dt});var x=u(177),O=u(8871),m=u(9417),F=u(4412),z=u(152),v=u(3294),k=u(5558),y=u(8141),P=u(5964),S=u(8032),g=u.n(S),R=u(5378),N=u(4941),G=u.n(N),t=u(8699),M=u(9287);let V=(()=>{class s{constructor(e){this.http=e}guardarCotizacion(e){return this.http.PostRequest("/cotizacion",e)}editarCotizacion(e,o){return this.http.PutRequest(`/cotizacion/${e}`,o)}buscarTodasCotizacion(e,o){let i=`/cotizacion?page=${e}&limit=${o}`;return console.log(i),this.http.GetRequest(i)}eliminarCotizacion(e){return this.http.DeleteRequest(`/eliminar-cotizacion/${e}`,"")}buscarCotizacionPorNombre(e,o,i){return this.http.GetRequest(`/cotizacion-nombre/${i}`)}buscarCotizacionDetalle(e){return this.http.GetRequest(`/detalle-cotizacion/${e}`)}getByNumero(e){return console.log("ServicioCotizacion - getByNumero llamado con n\xfamero:",e),this.http.GetRequest(`/cotizacion-numero/${e}`)}buscarCotizacion(e,o,i,n,a){let r=`/cotizacion?page=${e}&limit=${o}`;return console.log("paso por servicio buscar"),i&&(r+=`&codigo=${i}`),n&&(r+=`&nomcliente=${n}`),a&&(r+=`&fecha=${a}`),this.http.GetRequest(r)}static{this.\u0275fac=function(o){return new(o||s)(t.KVO(M.a))}}static{this.\u0275prov=t.jDH({token:s,factory:s.\u0275fac,providedIn:"root"})}}return s})();var D=u(3290);let B=(()=>{class s{constructor(e){this.http=e}guardardetCotizacion(e){return this.http.PostRequest("/detcotizacion",e)}editardetCotizacion(e,o){return this.http.PutRequest(`/detcotizacion/${e}`,o)}buscarTodasdetCotizacion(e,o,i){let n=`/cotizacion?page=${e}&limit=${o}`;return i&&(n+=`&descripcion=${i}`),console.log(n),this.http.GetRequest(n)}eliminardetCotizacion(e){return this.http.DeleteRequest(`/detcotizacion/${e}`,"")}buscardetCotizacion(e){return this.http.GetRequest(`/detcotizacion/${e}`)}static{this.\u0275fac=function(o){return new(o||s)(t.KVO(M.a))}}static{this.\u0275prov=t.jDH({token:s,factory:s.\u0275fac,providedIn:"root"})}}return s})();var A=u(9743),U=u(6687),Y=u(8747);const X=["inputCodmerc"],q=["descripcionInput"],J=["Tabladetalle"],L=["input5"],K=["buscarcodmercInput"];function W(s,p){if(1&s){const e=t.RV6();t.j41(0,"tr",114)(1,"td",115),t.EFF(2),t.k0s(),t.j41(3,"td"),t.EFF(4),t.k0s(),t.j41(5,"td",116),t.EFF(6),t.k0s(),t.j41(7,"td",117),t.EFF(8),t.k0s(),t.j41(9,"td",116)(10,"div",118)(11,"button",119),t.bIt("click",function(){const n=t.eBV(e).$implicit,a=t.XpG();return t.Njj(a.editarCotizacion(n))}),t.nrm(12,"i",120),t.k0s(),t.j41(13,"button",121),t.bIt("click",function(){const n=t.eBV(e).$implicit,a=t.XpG();return t.Njj(a.consultarCotizacion(n))}),t.nrm(14,"i",122),t.k0s(),t.j41(15,"button",123),t.bIt("click",function(){const n=t.eBV(e).$implicit,a=t.XpG();return t.Njj(a.generarPDF(n))}),t.nrm(16,"i",124),t.k0s(),t.j41(17,"button",125),t.nrm(18,"i",126),t.k0s(),t.j41(19,"button",127),t.bIt("click",function(){const n=t.eBV(e).$implicit,a=t.XpG();return t.Njj(a.eliminarCotizacion(n.ct_codcoti))}),t.nrm(20,"i",128),t.k0s()()()()}if(2&s){const e=p.$implicit,o=t.XpG();t.R7$(2),t.SpI(" ",e.ct_codcoti," "),t.R7$(2),t.JRh(e.ct_nomclie),t.R7$(2),t.JRh(o.formatFechaFiltro(e.ct_feccoti)),t.R7$(2),t.SpI(" ",e.ct_valcoti," ")}}function H(s,p){if(1&s){const e=t.RV6();t.j41(0,"li",32)(1,"a",129),t.bIt("click",function(){const n=t.eBV(e).$implicit,a=t.XpG();return t.Njj(a.changePage(n))}),t.EFF(2),t.k0s()()}if(2&s){const e=p.$implicit,o=t.XpG();t.AVh("active",o.currentPage===e),t.R7$(2),t.JRh(e)}}function Q(s,p){if(1&s){const e=t.RV6();t.j41(0,"a",130),t.bIt("click",function(){const n=t.eBV(e).$implicit,a=t.XpG();return t.Njj(a.cargarDatosCliente(n))}),t.nrm(1,"i",131),t.j41(2,"span"),t.EFF(3),t.k0s()()}if(2&s){const e=p.$implicit,o=p.index,i=t.XpG();t.AVh("active",o===i.selectedIndex),t.R7$(3),t.JRh(e.cl_nomClie)}}function Z(s,p){1&s&&(t.j41(0,"div",132),t.nrm(1,"i",133),t.EFF(2,"Este campo es obligatorio "),t.k0s())}function tt(s,p){if(1&s){const e=t.RV6();t.j41(0,"a",130),t.bIt("click",function(){const n=t.eBV(e).$implicit,a=t.XpG();return t.Njj(a.cargarDatosInventario(n))}),t.nrm(1,"i",134),t.j41(2,"span"),t.EFF(3),t.k0s()()}if(2&s){const e=p.$implicit,o=p.index,i=t.XpG();t.AVh("active",o===i.selectedIndexcodmerc),t.R7$(3),t.JRh(e.in_codmerc)}}function et(s,p){if(1&s){const e=t.RV6();t.j41(0,"a",130),t.bIt("click",function(){const n=t.eBV(e).$implicit,a=t.XpG();return t.Njj(a.cargarDatosInventario(n))}),t.nrm(1,"i",134),t.j41(2,"span"),t.EFF(3),t.k0s()()}if(2&s){const e=p.$implicit,o=p.index,i=t.XpG();t.AVh("active",o===i.selectedIndexcoddescripcionmerc),t.R7$(3),t.JRh(e.in_desmerc)}}function it(s,p){if(1&s){const e=t.RV6();t.j41(0,"div",118)(1,"button",137),t.bIt("click",function(){t.eBV(e);const i=t.XpG().$implicit,n=t.XpG();return t.Njj(n.editarItem(i))}),t.nrm(2,"i",120),t.k0s(),t.j41(3,"button",138),t.bIt("click",function(){t.eBV(e);const i=t.XpG().$implicit,n=t.XpG();return t.Njj(n.borarItem(i))}),t.nrm(4,"i",128),t.k0s()()}}function ot(s,p){if(1&s&&(t.j41(0,"tr",114)(1,"td",115),t.EFF(2),t.k0s(),t.j41(3,"td"),t.EFF(4),t.k0s(),t.j41(5,"td",116),t.EFF(6),t.k0s(),t.j41(7,"td",135),t.EFF(8),t.nI1(9,"currency"),t.k0s(),t.j41(10,"td",117),t.EFF(11),t.nI1(12,"currency"),t.k0s(),t.j41(13,"td",116),t.DNE(14,it,5,0,"div",136),t.k0s()()),2&s){const e=p.$implicit,o=t.XpG();t.R7$(2),t.SpI(" ",null==e.producto?null:e.producto.in_codmerc," "),t.R7$(2),t.JRh(null==e.producto?null:e.producto.in_desmerc),t.R7$(2),t.JRh(e.cantidad),t.R7$(2),t.JRh(t.bMT(9,6,e.precio)),t.R7$(3),t.JRh(t.bMT(12,8,e.total)),t.R7$(3),t.Y8G("ngIf",o.habilitarIcono)}}function nt(s,p){1&s&&(t.j41(0,"tr")(1,"td",139),t.nrm(2,"i",140),t.EFF(3," No hay productos agregados "),t.k0s()())}function rt(s,p){if(1&s&&(t.j41(0,"button",141),t.nrm(1,"i",142),t.EFF(2,"Guardar Cotizaci\xf3n "),t.k0s()),2&s){const e=t.XpG();t.Y8G("disabled",0===e.items.length)}}const w=function(s){return{show:s}},at=function(s){return{"is-invalid":s}},st=[{path:"",component:(()=>{class s{constructor(e,o,i,n,a,r,l,c){this.fb=e,this.servicioCotizacion=o,this.servicioCliente=i,this.serviciodetCotizacion=n,this.http=a,this.servicioInventario=r,this.ServicioUsuario=l,this.ServicioRnc=c,this.totalItems=0,this.pageSize=10,this.currentPage=1,this.maxPagesToShow=5,this.txtdescripcion="",this.txtcodigo="",this.txtfecha="",this.descripcion="",this.codigo="",this.fecha="",this.cotizacionNumero="",this.mensaje="",this.factura="",this.cotizacionData=null,this.descripcionBuscar=new F.t(""),this.codigoBuscar=new F.t(""),this.fechaBuscar=new F.t(""),this.habilitarFormulario=!1,this.modoedicionCotizacion=!1,this.modoconsultaCotizacion=!1,this.cotizacionList=[],this.detCotizacionList=[],this.selectedCotizacion=null,this.items=[],this.totalGral=0,this.totalItbis=0,this.subTotal=0,this.codmerc="",this.descripcionmerc="",this.cantidadmerc=0,this.preciomerc=0,this.precioform=new m.MJ,this.cantidadform=new m.MJ,this.isEditing=!1,this.itemToEdit=null,this.codnotfound=!1,this.desnotfound=!1,this.mensagePantalla=!1,this.codmerVacio=!1,this.desmerVacio=!1,this.habilitarCampos=!1,this.sucursales=[],this.sucursalSeleccionada=null,this.habilitarIcono=!0,this.clientesNombreCache=new Map,this.codigoSubject=new F.t(""),this.nomclienteSubject=new F.t(""),this.isDisabled=!0,this.buscarNombre=new m.MJ,this.resultadoNombre=[],this.selectedIndex=0,this.buscarcodmerc=new m.MJ,this.buscardescripcionmerc=new m.MJ,this.nativeElement=new m.MJ,this.resultadoCodmerc=[],this.selectedIndexcodmerc=0,this.resultadodescripcionmerc=[],this.selectedIndexcoddescripcionmerc=0,this.cancelarBusquedaDescripcion=!1,this.cancelarBusquedaCodigo=!1,this.form=this.fb.group({ct_codvend:["",m.k0.required]}),this.crearFormularioCotizacion(),console.log("formulario",this.formularioCotizacion.value),this.nomclienteSubject.pipe((0,z.B)(500),(0,v.F)(),(0,k.n)(d=>(this.txtdescripcion=d,this.servicioCotizacion.buscarCotizacion(this.currentPage,this.pageSize,this.codigo,this.txtdescripcion)))).subscribe(d=>{this.cotizacionList=d.data,this.totalItems=d.pagination.total,this.currentPage=d.pagination.page}),this.codigoBuscar.pipe((0,z.B)(500),(0,v.F)(),(0,k.n)(d=>(this.txtcodigo=d,this.servicioCotizacion.buscarCotizacion(this.currentPage,this.pageSize,this.txtcodigo,this.txtdescripcion,this.txtfecha)))).subscribe(d=>{this.cotizacionList=d.data,this.totalItems=d.pagination.total,this.currentPage=d.pagination.page}),this.fechaBuscar.pipe((0,z.B)(500),(0,v.F)(),(0,k.n)(d=>(this.txtfecha=d,this.servicioCotizacion.buscarCotizacion(this.currentPage,this.pageSize,this.txtcodigo,this.txtdescripcion,this.txtfecha)))).subscribe(d=>{this.cotizacionList=d.data,this.totalItems=d.pagination.total,this.currentPage=d.pagination.page})}agregarCotizacion(){this.formularioCotizacion.disable()}crearformulariodetCotizacion(){this.formulariodetCotizacion=this.fb.group({dc_codcoti:[""],dc_codmerc:[""],dc_descrip:[""],dc_canmerc:[""],dc_premerc:[""],dc_valmerc:[""],dc_unidad:[""],dc_costmer:[""],dc_codclie:[""],dc_status:[""]})}seleccionarCotizacion(e){this.selectedCotizacion=e}ngOnInit(){this.buscarTodasCotizacion(1),this.buscarcodmerc.valueChanges.pipe((0,z.B)(50),(0,v.F)(),(0,y.M)(()=>{this.resultadoCodmerc=[]}),(0,P.p)(e=>""!==e.trim()&&!this.cancelarBusquedaCodigo&&!this.isEditing),(0,k.n)(e=>this.http.GetRequest(`/productos-buscador/${e}`))).subscribe(e=>{if(console.log(e.data),!e)return this.resultadoCodmerc=[],this.codnotfound=!1,void console.log("paso blanco");Array.isArray(e.data)&&e.data.length?(this.resultadoCodmerc=e.data.sort((o,i)=>o.in_codmerc.localeCompare(i.in_codmerc,void 0,{numeric:!0,sensitivity:"base"})),this.selectedIndex=-1,this.codnotfound=!1):this.codnotfound=!0}),this.buscardescripcionmerc.valueChanges.pipe((0,z.B)(50),(0,v.F)(),(0,y.M)(()=>{this.resultadodescripcionmerc=[]}),(0,P.p)(e=>""!==e&&!this.cancelarBusquedaDescripcion&&!this.isEditing),(0,k.n)(e=>this.http.GetRequest(`/productos-buscador-desc/${e}`))).subscribe(e=>{console.log(e.data),e?Array.isArray(e.data)&&e.data.length?(this.resultadodescripcionmerc=e.data,this.desnotfound=!1):this.desnotfound=!0:(this.resultadodescripcionmerc=[],this.desnotfound=!1,console.log("2"))}),this.buscarNombre.valueChanges.pipe((0,z.B)(500),(0,v.F)(),(0,y.M)(()=>{this.resultadoNombre=[]}),(0,P.p)(e=>""!==e),(0,k.n)(e=>this.http.GetRequest(`/cliente-nombre/${e}`))).subscribe(e=>{console.log(e.data),e?Array.isArray(e.data)&&(this.resultadoNombre=e.data):this.resultadoNombre=[]})}crearFormularioCotizacion(){const o=this.formatofecha(new Date);this.formularioCotizacion=this.fb.group({ct_codcoti:[""],ct_feccoti:[o],ct_valcoti:[""],ct_itbis:[""],ct_codclie:[""],ct_nomclie:[""],ct_rnc:[""],ct_telclie:[""],ct_dirclie:[""],ct_correo:[""],ct_codvend:["",m.k0.required],ct_nomvend:[""],ct_status:[""],ct_codzona:[""]}),console.log(this.formularioCotizacion.value)}habilitarFormularioEmpresa(){this.habilitarFormulario=!1}nuevaCotizacion(){this.modoedicionCotizacion=!1,this.tituloModalCotizacion="Nueva Cotizacion",$("#modalcotizacion").modal("show"),this.habilitarFormulario=!0,this.formularioCotizacion.get("ct_codcoti").disable(),this.formularioCotizacion.get("ct_feccoti").disable(),this.formularioCotizacion.get("ct_nomvend").disable(),setTimeout(()=>{$("#input1").focus()},500)}cerrarModalCotizacion(){this.habilitarFormulario=!1,this.formularioCotizacion.reset(),this.modoedicionCotizacion=!1,this.modoconsultaCotizacion=!1,this.mensagePantalla=!1,$("#modalcotizacion").modal("hide"),this.crearFormularioCotizacion(),this.limpiarTabla(),this.limpiarCampos(),this.habilitarIcono=!0,document.querySelectorAll(".seccion-productos input").forEach(o=>{o.disabled=!1})}editardetCotizacion(e){this.cotizacionid=e.dc_codcoti}editarCotizacion(e){this.cotizacionid=e.ct_codcoti,this.modoedicionCotizacion=!0,this.formularioCotizacion.patchValue(e),this.tituloModalCotizacion="Editando Cotizacion",$("#modalcotizacion").modal("show"),this.habilitarFormulario=!0,this.formularioCotizacion.get("ct_codvend").disable(),document.querySelectorAll(".seccion-productos input").forEach(i=>{i.disabled=!0}),this.items=[],this.servicioCotizacion.buscarCotizacionDetalle(e.ct_codcoti).subscribe(i=>{let n=0,r=0;i.data.forEach(c=>{const h=c.dc_canmerc,f=c.dc_premerc,C=h*f;this.items.push({producto:{in_codmerc:c.dc_codmerc,in_desmerc:c.dc_descrip,in_grumerc:"",in_tipoproduct:"",in_canmerc:0,in_caninve:0,in_fecinve:null,in_eximini:0,in_cosmerc:0,in_premerc:0,in_precmin:0,in_costpro:0,in_ucosto:0,in_porgana:0,in_peso:0,in_longitud:0,in_unidad:0,in_medida:0,in_longitu:0,in_fecmodif:null,in_amacen:0,in_imagen:"",in_status:"",in_itbis:!1,in_minvent:0},cantidad:h,precio:f,total:C}),n+=C,this.totalItbis+=.18*C}),r=n+this.totalItbis,this.subTotal=n,this.totalItbis=this.totalItbis,this.totalGral=r})}buscarTodasCotizacion(e){this.servicioCotizacion.buscarTodasCotizacion(e,this.pageSize).subscribe(o=>{console.log(o),this.cotizacionList=o.data})}consultarCotizacion(e){this.modoconsultaCotizacion=!0,this.formularioCotizacion.patchValue(e),this.tituloModalCotizacion="Consulta Cotizacion",$("#modalcotizacion").modal("show"),this.habilitarFormulario=!0,this.formularioCotizacion.disable(),this.habilitarIcono=!1,document.querySelectorAll(".seccion-productos input").forEach(i=>{i.disabled=!0}),this.items=[],this.servicioCotizacion.buscarCotizacionDetalle(e.ct_codcoti).subscribe(i=>{let n=0,r=0;i.data.forEach(c=>{const h=c.dc_canmerc,f=c.dc_premerc,C=h*f;this.items.push({producto:{in_codmerc:c.dc_codmerc,in_desmerc:c.dc_descrip,in_grumerc:"",in_tipoproduct:"",in_canmerc:0,in_caninve:0,in_fecinve:null,in_eximini:0,in_cosmerc:0,in_premerc:0,in_precmin:0,in_costpro:0,in_ucosto:0,in_porgana:0,in_peso:0,in_longitud:0,in_unidad:0,in_medida:0,in_longitu:0,in_fecmodif:null,in_amacen:0,in_imagen:"",in_status:"",in_itbis:!1,in_minvent:0},cantidad:h,precio:f,total:C}),n+=C,this.totalItbis+=.18*C}),r=n+this.totalItbis,this.subTotal=n,this.totalItbis=this.totalItbis,this.totalGral=r})}generarPDF(e){console.log("No. Cotizacion",e),e.ct_codcoti&&""!==e.ct_codcoti.trim()?this.servicioCotizacion.getByNumero(e.ct_codcoti).subscribe(o=>{this.cotizacionData=o.data,console.log(this.cotizacionData.length),o?(this.cotizacionData=o,console.log("cotizacionData",this.cotizacionData),this.mensaje=""):(this.cotizacionData=null,this.mensaje="No se encontr\xf3 una cotizacion con ese n\xfamero")}):alert("Debe ingresar un n\xfamero de cotizacion")}eliminarCotizacion(e){g().fire({title:"\xbfEst\xe1 seguro de eliminar este Cotizacion?",text:"\xa1No podr\xe1 revertir esto!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Si, eliminar!"}).then(o=>{o.isConfirmed&&this.servicioCotizacion.eliminarCotizacion(e).subscribe(i=>{g().fire({title:"Excelente!",text:"Empresa eliminado correctamente.",icon:"success",timer:2e3,showConfirmButton:!1}),this.buscarTodasCotizacion(this.currentPage)})})}descripcionEntra(e){this.nomclienteSubject.next(e.target.value.toUpperCase())}codigoEntra(e){this.codigoBuscar.next(e.target.value.toUpperCase())}fechaEntra(e){const i=e.target.value?.trim(),n=this.formatFechaFiltro(i);this.txtfecha=n,this.fechaBuscar.next(n)}guardarCotizacion(){this.formularioCotizacion.get("ct_valcoti")?.patchValue(this.totalGral),this.formularioCotizacion.get("ct_itbis")?.patchValue(this.totalItbis),this.formularioCotizacion.markAllAsTouched(),this.formularioCotizacion.updateValueAndValidity();const o={cotizacion:this.formularioCotizacion.getRawValue(),detalle:this.items,idCotizacion:this.formularioCotizacion.get("ct_codcoti")?.value};if(this.formularioCotizacion.valid)if(this.modoedicionCotizacion){const i={cotizacion:this.formularioCotizacion.getRawValue(),detalle:this.items,idCotizacion:this.cotizacionid};this.servicioCotizacion.editarCotizacion(this.cotizacionid,i).subscribe({next:n=>{g().fire({title:"Excelente!",text:"Cotizacion editada correctamente.",icon:"success",timer:3e3,showConfirmButton:!1}),this.buscarCotizacion(this.currentPage),this.formularioCotizacion.reset(),this.crearFormularioCotizacion(),$("#modalcotizacion").modal("hide")},error:n=>{g().fire({icon:"error",title:"A V I S O",text:"No se pudo editar la cotizaci\xf3n."})}})}else this.formularioCotizacion.valid?this.servicioCotizacion.guardarCotizacion(o).subscribe({next:i=>{g().fire({title:"Excelente!",text:"Cotizacion creada correctamente.",icon:"success",timer:1500,showConfirmButton:!1}),this.buscarCotizacion(this.currentPage),this.formularioCotizacion.reset(),this.crearFormularioCotizacion(),this.formularioCotizacion.enable(),$("#modalcotizacion").modal("hide")},error:i=>{g().fire({icon:"error",title:"A V I S O",text:"No se pudo crear la cotizaci\xf3n."})}}):console.log(this.formularioCotizacion.value);else{g().fire({icon:"warning",title:"Campos incompletos",text:"La cotizaci\xf3n no fue guardada. Verifique los campos requeridos (por ejemplo, Vendedor)."});const i=this.formularioCotizacion.get("ct_codvend");i&&i.invalid&&(i.markAsTouched(),setTimeout(()=>{this.vendedorInput?.nativeElement?.focus(),this.vendedorInput?.nativeElement?.scrollIntoView({behavior:"smooth",block:"center"})},0))}}convertToUpperCase(e){const o=e.target,i=o.selectionStart,n=o.selectionEnd;o.value=o.value.toUpperCase(),null!==i&&null!==n&&o.setSelectionRange(i,n)}moveFocus(e,o){"Enter"===e.key&&o&&(e.preventDefault(),o.focus())}changePage(e){this.currentPage=e,this.servicioCotizacion.buscarCotizacion(this.currentPage,this.pageSize,this.txtcodigo,this.txtdescripcion,this.txtfecha).subscribe(o=>{this.cotizacionList=o.data,this.totalItems=o.pagination.total,this.currentPage=e,this.formularioCotizacion.reset()})}buscarCotizacion(e){this.currentPage=e,this.servicioCotizacion.buscarCotizacion(this.currentPage,this.pageSize,this.txtcodigo,this.txtdescripcion,this.txtfecha).subscribe(o=>{this.cotizacionList=o.data,this.totalItems=o.pagination.total,this.currentPage=o.pagination.page??e})}get totalPages(){return Math.ceil(this.totalItems/this.pageSize)}get pages(){const e=this.totalPages,o=this.currentPage,i=this.maxPagesToShow;if(e<=i)return Array.from({length:e},(r,l)=>l+1);const n=Math.max(1,o-Math.floor(i/2)),a=Math.min(e,n+i-1);return Array.from({length:a-n+1},(r,l)=>n+l)}limpiaBusqueda(){this.txtdescripcion="",this.txtcodigo="",this.txtfecha="",this.buscarTodasCotizacion(1)}agregaItem(e){if(e.preventDefault(),this.isEditing)console.log("editando"),this.itemToEdit.producto=this.productoselect,this.itemToEdit.codmerc=this.codmerc,this.itemToEdit.descripcionmerc=this.descripcionmerc,this.itemToEdit.precio=this.preciomerc,this.itemToEdit.cantidad=this.cantidadmerc,this.itemToEdit.total=this.cantidadmerc*this.preciomerc,this.actualizarTotales(),this.isEditing=!1,this.itemToEdit=null;else{if(!this.productoselect||this.cantidadmerc<=0||this.preciomerc<=0)return this.mensagePantalla=!0,void g().fire({icon:"error",title:"A V I S O",text:"Por favor complete todos los campos requeridos antes de agregar el \xedtem."}).then(()=>{this.mensagePantalla=!1});const o=this.cantidadmerc*this.preciomerc;this.totalGral+=o;const i=.18*o;this.totalItbis+=i,this.subTotal+=o-i,this.items.push({producto:this.productoselect,cantidad:this.cantidadmerc,precio:this.preciomerc,total:o}),this.cancelarBusquedaDescripcion=!1,this.cancelarBusquedaCodigo=!1}this.limpiarCampos()}limpiarCampos(){this.codmerc="",this.descripcionmerc="",this.preciomerc=0,this.cantidadmerc=0,this.isEditing=!1}limpiarTabla(){this.items=[],this.totalGral=0,this.totalItbis=0,this.subTotal=0}borarItem(e){const o=this.items.indexOf(e);if(o>-1){this.totalGral-=e.total;const i=.18*e.total;this.totalItbis-=i,this.subTotal-=e.total-i,this.items.splice(o,1)}}editarItem(e){this.index_item=this.items.indexOf(e),this.isEditing=!0,this.itemToEdit=e,this.productoselect=e.producto,this.codmerc=e.producto.in_codmerc,this.descripcionmerc=e.producto.in_desmerc,this.preciomerc=e.precio,this.cantidadmerc=e.cantidad}actualizarTotales(){this.totalGral=this.items.reduce((e,o)=>e+o.total,0),this.totalItbis=this.items.reduce((e,o)=>e+.18*o.total,0),this.subTotal=this.items.reduce((e,o)=>e+(o.total-.18*o.total),0)}buscarPorCodigo(e){}nombreClientePorCodigo(e){return e?this.clientesNombreCache.get(e)||(this.servicioCliente.buscarCliente(Number(e)).subscribe(i=>{this.clientesNombreCache.set(e,i?.data?.cl_nomClie||"")}),""):""}buscarClienteporNombre(){this.servicioCliente.buscarporNombre(this.formularioCotizacion.get("ct_nomclie").value).subscribe(e=>{console.log(e)})}formatofecha(e){const o=e.getFullYear(),i=(e.getMonth()+1).toString().padStart(2,"0");return`${e.getDate().toString().padStart(2,"0")}/${i}/${o}`}formatFechaFiltro(e){if(!e&&0!==e)return"";if(e instanceof Date&&!isNaN(e.getTime())){const o=e.getFullYear(),i=(e.getMonth()+1).toString().padStart(2,"0");return`${e.getDate().toString().padStart(2,"0")}/${i}/${o}`}if("number"==typeof e){const o=new Date(e);if(!isNaN(o.getTime())){const i=o.getFullYear(),n=(o.getMonth()+1).toString().padStart(2,"0");return`${o.getDate().toString().padStart(2,"0")}/${n}/${i}`}}if("string"==typeof e){let o=e.trim();if(o.includes("T")&&(o=o.split("T")[0]),o.includes(" ")&&(o=o.split(" ")[0]),/^\d{4}-\d{2}-\d{2}$/.test(o)){const[c,d,h]=o.split("-");return`${h}/${d}/${c}`}if(/^\d{4}\/\d{2}\/\d{2}$/.test(o)){const[c,d,h]=o.split("/");return`${h}/${d}/${c}`}if(/^\d{2}\/\d{2}\/\d{4}$/.test(o))return o;const r=o.split(/[\/-]/);if(3===r.length){const c=r.findIndex(d=>4===d.length);if(0===c){const[d,h,f]=r;if(2===h.length&&2===f.length)return`${f}/${h}/${d}`}else if(2===c){const[d,h,f]=r;if(2===d.length&&2===h.length)return`${d}/${h}/${f}`}}const l=new Date(o);if(!isNaN(l.getTime())){const c=l.getFullYear(),d=(l.getMonth()+1).toString().padStart(2,"0");return`${l.getDate().toString().padStart(2,"0")}/${d}/${c}`}return o}return""}cargarDatosCliente(e){this.resultadoNombre=[],this.buscarNombre.reset(),""!==e.cl_nomClie&&(console.log("dd"),this.formularioCotizacion.patchValue({ct_codclie:e.cl_codClie,ct_nomclie:e.cl_nomClie,ct_rnc:e.cl_rnc,ct_telclie:e.cl_telClie,ct_dirclie:e.cl_dirClie,ct_codzona:e.cl_codZona}))}handleKeydown(e){const o=e.key,i=this.resultadoNombre.length-1;"ArrowDown"===o?(console.log("paso 56"),this.selectedIndex<i?this.selectedIndex++:this.selectedIndex=0,e.preventDefault()):"ArrowUp"===o?(console.log("paso 677"),this.selectedIndex>0?this.selectedIndex--:this.selectedIndex=i,e.preventDefault()):"Enter"===o&&(this.selectedIndex>=0&&this.selectedIndex<=i&&this.cargarDatosCliente(this.resultadoNombre[this.selectedIndex]),e.preventDefault())}cargarDatosInventario(e){console.log(e),this.resultadoCodmerc=[],this.resultadodescripcionmerc=[],this.codmerc=e.in_codmerc,this.preciomerc=e.in_premerc,this.descripcionmerc=e.in_desmerc,this.productoselect=e,this.cancelarBusquedaDescripcion=!0,this.cancelarBusquedaCodigo=!0,this.formularioCotizacion.patchValue({dc_codmerc:e.in_codmerc,dc_desmerc:e.in_desmerc,dc_canmerc:e.in_canmerc,dc_premerc:e.in_premerc,dc_cosmerc:e.in_cosmerc,dc_unidad:e.in_unidad}),$("#input8").focus(),$("#input8").select()}handleKeydownInventario(e){const o=e.key,i=this.resultadoCodmerc.length-1;"ArrowDown"===o?(console.log("paso"),this.selectedIndexcodmerc=this.selectedIndexcodmerc<i?this.selectedIndexcodmerc+1:0,e.preventDefault()):"ArrowUp"===o?(console.log("paso2"),this.selectedIndexcodmerc=this.selectedIndexcodmerc>0?this.selectedIndexcodmerc-1:i,e.preventDefault()):"Enter"===o&&(this.selectedIndexcodmerc>=0&&this.selectedIndexcodmerc<=i&&this.cargarDatosInventario(this.resultadoCodmerc[this.selectedIndexcodmerc]),e.preventDefault())}handleKeydownInventariosdesc(e){const o=e.key,i=this.resultadodescripcionmerc.length-1;"ArrowDown"===o?(this.selectedIndexcoddescripcionmerc=this.selectedIndexcoddescripcionmerc<i?this.selectedIndexcoddescripcionmerc+1:0,e.preventDefault()):"ArrowUp"===o?(this.selectedIndexcoddescripcionmerc=this.selectedIndexcoddescripcionmerc>0?this.selectedIndexcoddescripcionmerc-1:i,e.preventDefault()):"Enter"===o&&(this.selectedIndexcoddescripcionmerc>=0&&this.selectedIndexcoddescripcionmerc<=i&&this.cargarDatosInventario(this.resultadodescripcionmerc[this.selectedIndexcoddescripcionmerc]),e.preventDefault())}onEnter(e,o){const i=e*o;this.totalGral+=i;const n=.18*i;this.totalItbis+=n,this.subTotal+=i-n,this.items.push({producto:this.productoselect,cantidad:e,precio:o,total:i})}buscarUsuario(e,o){e.preventDefault();const i=this.formularioCotizacion.get("ct_codvend")?.value;if(!i)return this.mensagePantalla=!0,void g().fire({icon:"error",title:"A V I S O",text:"Codigo de usuario invalido."}).then(()=>{this.mensagePantalla=!1});this.ServicioUsuario.buscarUsuarioPorClave(i).subscribe(n=>{if(!n.data.length)return this.mensagePantalla=!0,void g().fire({icon:"error",title:"A V I S O",text:"Codigo de usuario invalido."}).then(()=>{this.mensagePantalla=!1});this.formularioCotizacion.patchValue({ct_nomvend:n.data[0].idUsuario}),o?.focus(),console.log(n.data[0].idUsuario)})}buscarRnc(e,o){e.preventDefault();const i=this.formularioCotizacion.get("ct_rnc")?.value;if(i){if(9!==i.length&&11!==i.length)return this.mensagePantalla=!0,void g().fire({icon:"error",title:"A V I S O",text:"Rnc invalido."}).then(()=>{this.mensagePantalla=!1});this.ServicioRnc.buscarRncPorrncId(i).subscribe(n=>{if(console.log(n.data),!n.data)return this.mensagePantalla=!0,void g().fire({icon:"error",title:"A V I S O",text:"Rnc invalido."}).then(()=>{this.mensagePantalla=!1});this.formularioCotizacion.patchValue({ct_nomclie:n.data.rason}),o?.focus(),console.log(n.data[0].rason)}),this.mensagePantalla=!1}else o?.focus();this.mensagePantalla=!1}moveFocuscodmerc(e,o){if("Enter"===e.key||"Tab"===e.key){if(e.preventDefault(),this.codmerVacio=""===e.target.value.trim(),this.codnotfound)return console.log(this.codnotfound),this.mensagePantalla=!0,g().fire({icon:"error",title:"A V I S O",text:"Codigo invalido.",focusConfirm:!0,allowEnterKey:!0}).then(()=>{this.mensagePantalla=!1}),this.codmerVacio=!1,this.codnotfound=!1,this.codmerc="",void(this.descripcionmerc="");!0===this.codmerVacio?(o.focus(),this.codmerVacio=!1,console.log("vedadero")):($("#input8").focus(),$("#input8").select()),this.codmerVacio=!1}}moveFocusdesc(e,o){if("Enter"===e.key||"Tab"===e.key){if(e.preventDefault(),""===e.target.value.trim()&&(this.desmerVacio=!0,console.log("vedadero")),this.desnotfound)return this.mensagePantalla=!0,g().fire({icon:"error",title:"A V I S O",text:"Codigo invalido."}).then(()=>{this.mensagePantalla=!1}),void(this.desnotfound=!0);if(!0===this.desmerVacio)return this.mensagePantalla=!0,g().fire({icon:"error",title:"A V I S O",text:"Codigo invalido."}).then(()=>{this.mensagePantalla=!1}),void(this.desnotfound=!0);$("#input8").focus(),$("#input8").select(),this.desmerVacio=!1}}moveFocusCantidad(e,o){if("Enter"===e.key||"Tab"===e.key){if(e.preventDefault(),!this.productoselect||this.cantidadmerc<=0)return this.mensagePantalla=!0,void g().fire({icon:"error",title:"A V I S O",text:"Por favor complete todos los campos requeridos antes de agregar el \xedtem."}).then(()=>{this.mensagePantalla=!1});$("#input9").focus(),$("#input9").select()}}moveFocusnomclie(e,o){e.preventDefault(),console.log(o),e.target instanceof HTMLInputElement&&(e.target.value?o.focus():(this.mensagePantalla=!0,g().fire({icon:"error",title:"A V I S O",text:"Por favor complete el campo Nombre del Cliente Para Poder continual."}).then(()=>{this.mensagePantalla=!1})))}submitForm(){this.mensagePantalla&&this.form.invalid?(console.log(this.mensagePantalla),console.log(this.form.invalid)):(console.log(this.mensagePantalla),console.log(this.form.invalid),this.cerrarModalCotizacion())}generatePDF(e){console.log(e),this.servicioCotizacion.buscarCotizacionDetalle(e.ct_codcoti).subscribe(o=>{let i=0,a=0;o.data.forEach(_=>{const E=_.dc_canmerc,T=_.dc_premerc,I=E*T;this.items.push({producto:{in_codmerc:_.dc_codmerc,in_desmerc:_.dc_descrip,in_grumerc:"",in_tipoproduct:"",in_canmerc:0,in_caninve:0,in_fecinve:null,in_eximini:0,in_cosmerc:0,in_premerc:0,in_precmin:0,in_costpro:0,in_ucosto:0,in_porgana:0,in_peso:0,in_longitud:0,in_unidad:0,in_medida:0,in_longitu:0,in_fecmodif:null,in_amacen:0,in_imagen:"",in_status:"",in_itbis:!1,in_minvent:0},cantidad:E,precio:T,total:I}),i+=I,this.totalItbis+=.18*I}),a=i+this.totalItbis,this.subTotal=i,this.totalItbis=this.totalItbis,this.totalGral=a;const l=_=>_.toLocaleString("es-DO",{style:"currency",currency:"DOP"}),c=new R.default,ut=(c.internal.pageSize.getWidth()-20)/2;c.addImage("assets/logo2.png","PNG",ut,10,20,20),c.setFontSize(16),c.text("CENTRAL HIERRO, SRL",105,40,{align:"center"}),c.setFontSize(10),c.text("#172 Esq. Albert Thomas",105,47,{align:"center"}),c.text("809-384-2000, 809-384-200",105,52,{align:"center"}),c.text("1-30-29922-6",105,57,{align:"center"}),c.setFontSize(14),c.text("COTIZACION",105,70,{align:"center"}),c.setFontSize(10),c.text(`No. ${e.ct_codcoti}`,14,80),c.text(`Fecha: ${e.ct_feccoti}`,14,85),c.text(`Vendedido por: ${e.ct_nomvend}`,14,90),c.setFontSize(12),c.text("CLIENTE",14,100),c.setFontSize(10),c.text(e.ct_nomclie,14,106),G()(c,{head:[["Cantidad","Descripci\xf3n","Precio Unitario","Total"]],body:o.data.map(_=>[parseInt(_.dc_canmerc),_.dc_descrip,l(parseFloat(_.dc_premerc)),l(_.dc_premerc*_.dc_canmerc)]),startY:115});const b=c.lastAutoTable.finalY;c.setFontSize(12),c.text("Subtotal:",118,b+10),c.setFontSize(10),c.text(`${l(i)} `,160,b+10),c.setFontSize(12),c.text("ITBIS:",118,b+16),c.setFontSize(10),c.text(`${l(this.totalItbis)} `,160,b+16),c.setFontSize(12),c.text("TOTAL A PAGAR: ",118,b+22),c.setFontSize(14),c.text(`${l(a)} `,160,b+22),c.setFontSize(12),c.text("Estos Precios Estan Sujetos a Cambio Sin Previo Aviso",105,b+40,{align:"center"}),c.setFontSize(14),c.text("WWW.GRUPOHIERRO.COM",105,b+47,{align:"center"}),c.setFontSize(12),c.text("*** Gracias por Preferirnos ***",105,b+55,{align:"center"});const mt=c.output("blob"),ht=URL.createObjectURL(mt);window.open(ht,"_blank")})}onUpperCase(e,o){if(o){const i=o.toUpperCase();this.formularioCotizacion.patchValue({[e]:i},{emitEvent:!1})}}static{this.\u0275fac=function(o){return new(o||s)(t.rXU(m.ok),t.rXU(V),t.rXU(D.d),t.rXU(B),t.rXU(M.a),t.rXU(A.M),t.rXU(U.f),t.rXU(Y.E))}}static{this.\u0275cmp=t.VBU({type:s,selectors:[["Cotizacion"]],viewQuery:function(o,i){if(1&o&&(t.GBs(X,5),t.GBs(q,5),t.GBs(J,5),t.GBs(L,5),t.GBs(K,5)),2&o){let n;t.mGM(n=t.lsd())&&(i.inputCodmerc=n.first),t.mGM(n=t.lsd())&&(i.descripcionInput=n.first),t.mGM(n=t.lsd())&&(i.Tabladetalle=n.first),t.mGM(n=t.lsd())&&(i.vendedorInput=n.first),t.mGM(n=t.lsd())&&(i.buscarcodmercElement=n.first)}},decls:214,vars:52,consts:[[1,"container-fluid","py-4"],[1,"row"],[1,"col-12"],[1,"card","shadow-sm","border-0"],[1,"card-header","bg-primary","text-white","py-3"],[1,"d-flex","justify-content-between","align-items-center"],[1,"mb-0","fw-semibold"],[1,"bi","bi-file-text","me-2"],[1,"btn","btn-light","btn-sm",3,"click"],[1,"bi","bi-plus-circle","me-1"],[1,"card-body","bg-light"],[1,"row","g-3","mb-4"],[1,"col-md-3"],[1,"form-label","small","text-muted","fw-semibold"],["type","text","placeholder","Buscar por n\xfamero...",1,"form-control","form-control-sm",3,"ngModel","ngModelChange","input"],[1,"col-md-5"],["type","text","placeholder","Buscar por nombre de cliente...",1,"form-control","form-control-sm","text-uppercase",3,"ngModel","ngModelChange","input"],["type","text","placeholder","dd/mm/aaaa",1,"form-control","form-control-sm",3,"ngModel","ngModelChange","input"],[1,"col-md-1","d-flex","align-items-end"],["title","Limpiar filtros",1,"btn","btn-outline-secondary","btn-sm","w-100",3,"click"],[1,"bi","bi-arrow-counterclockwise"],[1,"table-responsive",2,"max-height","650px","overflow-y","auto"],[1,"table","table-hover","table-sm","align-middle","bg-white"],[1,"table-dark","sticky-top"],[2,"width","10%"],[2,"width","40%"],[1,"text-center",2,"width","12%"],[1,"text-end",2,"width","15%"],[1,"text-center",2,"width","23%"],["class","border-bottom",4,"ngFor","ngForOf"],["aria-label","Paginaci\xf3n",1,"mt-3"],[1,"pagination","pagination-sm","justify-content-center","mb-0"],[1,"page-item"],["aria-label","Primera",1,"page-link",3,"click"],["aria-hidden","true"],["aria-label","Anterior",1,"page-link",3,"click"],["class","page-item",3,"active",4,"ngFor","ngForOf"],["aria-label","Siguiente",1,"page-link",3,"click"],["aria-label","\xdaltima",1,"page-link",3,"click"],["id","modalcotizacion","tabindex","-1","aria-labelledby","tituloModalCotizacion","aria-hidden","true","data-bs-backdrop","static","data-bs-keyboard","false",1,"modal","fade"],[1,"modal-dialog","modal-dialog-centered","modal-xl"],[1,"modal-content","shadow-lg","border-0"],[1,"modal-header","bg-primary","text-white"],["id","tituloModalCotizacion",1,"modal-title","fw-semibold"],["type","button","aria-label","Cerrar",1,"btn-close","btn-close-white",3,"click"],[1,"modal-body","p-4","bg-light"],[3,"formGroup","ngSubmit"],[1,"row","g-0"],[1,"col-lg-8"],[1,"card","border-0","shadow-sm","h-100"],[1,"card-header","bg-white","border-bottom"],[1,"mb-0","text-secondary","fw-semibold"],[1,"bi","bi-person-circle","me-2"],[1,"card-body"],[1,"row","g-1"],["type","text","id","input1","formControlName","ct_rnc","placeholder","Ingrese RNC o c\xe9dula",1,"form-control",3,"keydown.enter"],["input1",""],[1,"col-md-9"],[1,"position-relative"],["type","text","autocomplete","off","id","input2","formControlName","ct_nomclie","placeholder","Buscar cliente...",1,"form-control","text-uppercase",3,"formControl","ngModelChange","keydown.enter","keydown"],["input2",""],[1,"dropdown-menu","shadow-sm","w-100",2,"margin-top","2px","z-index","1050","max-height","250px","overflow-y","auto",3,"ngClass"],["class","dropdown-item d-flex align-items-center py-2","style","cursor: pointer",3,"active","click",4,"ngFor","ngForOf"],["type","text","formControlName","ct_dirclie","placeholder","Direcci\xf3n del cliente",1,"form-control","text-uppercase",3,"ngModelChange","keydown"],["input3",""],["type","tel","formControlName","ct_telclie","placeholder","(000) 000-0000",1,"form-control",3,"keydown"],["input4",""],[1,"col-lg-4"],[1,"bi","bi-file-earmark-text","me-2"],[1,"col-6"],["type","text","formControlName","ct_codcoti","readonly","",1,"form-control"],["formControlName","ct_feccoti","type","text","readonly","",1,"form-control"],["type","password","formControlName","ct_codvend","placeholder","C\xf3digo del vendedor",1,"form-control","text-uppercase",3,"ngClass","ngModelChange","keydown","keydown.enter"],["input5",""],["class","text-danger small mt-1",4,"ngIf"],["type","text","formControlName","ct_nomvend","readonly","",1,"form-control"],[1,"card","border-0","shadow-sm","mt-3"],[1,"row","g-3"],[1,"col-md-2"],["type","text","autocomplete","off","name","codmerc","placeholder","C\xf3digo",1,"form-control","text-uppercase",3,"formControl","ngModel","ngModelChange","keydown"],["codigoInput","","input6",""],[1,"dropdown-menu","shadow-sm","w-100",2,"margin-top","2px","z-index","1050","max-height","200px","overflow-y","auto",3,"ngClass"],["type","text","autocomplete","off","placeholder","Buscar producto...",1,"form-control","text-uppercase",3,"formControl","ngModel","ngModelChange","keydown"],["descripcionInput","","input7",""],["type","number","placeholder","0","id","input8","min","1",1,"form-control",3,"ngModel","formControl","ngModelChange","keydown"],["input8",""],["type","number","placeholder","0.00","id","input9","min","0","step","0.01",1,"form-control",3,"ngModel","formControl","ngModelChange","keydown","keydown.enter"],["input9",""],["type","button","title","Agregar producto",1,"btn","btn-success","w-100",3,"click"],[1,"bi","bi-plus-lg"],[1,"table-responsive","tabla-fija"],[1,"table","table-hover","table-sm","mb-0","align-middle","tabla-detalle-sm"],["Tabladetalla",""],[1,"table-light","sticky-top"],[2,"width","7%"],[2,"width","30%"],[1,"text-center",2,"width","10%"],[1,"text-end",2,"width","10%"],[1,"text-center",2,"width","9%"],[4,"ngIf"],[1,"totales-fijos"],[1,"row","g-2"],[1,"col-md-8"],[1,"col-md-4"],[1,"d-flex","justify-content-between","mb-2"],[1,"text-muted"],[1,"fw-semibold"],[1,"d-flex","justify-content-between","pt-2","border-top"],[1,"fw-bold","fs-5"],[1,"fw-bold","fs-5","text-primary"],[1,"d-flex","justify-content-end","gap-2","mt-3"],["type","button",1,"btn","btn-outline-secondary",3,"click"],[1,"bi","bi-x-circle","me-1"],["type","submit","class","btn btn-primary",3,"disabled",4,"ngIf"],[1,"border-bottom"],[1,"fw-semibold","text-primary"],[1,"text-center"],[1,"text-end","fw-semibold"],[1,"d-flex","flex-wrap","justify-content-center","gap-1"],["title","Editar",1,"btn","btn-outline-primary","btn-sm",3,"click"],[1,"bi","bi-pencil"],["title","Ver detalles",1,"btn","btn-outline-info","btn-sm",3,"click"],[1,"bi","bi-eye"],["title","Generar PDF",1,"btn","btn-outline-danger","btn-sm",3,"click"],[1,"bi","bi-file-earmark-pdf"],["title","Imprimir",1,"btn","btn-outline-secondary","btn-sm"],[1,"bi","bi-printer"],["title","Eliminar",1,"btn","btn-outline-danger","btn-sm",3,"click"],[1,"bi","bi-trash"],[1,"page-link",3,"click"],[1,"dropdown-item","d-flex","align-items-center","py-2",2,"cursor","pointer",3,"click"],[1,"bi","bi-person-circle","me-2","text-primary"],[1,"text-danger","small","mt-1"],[1,"bi","bi-exclamation-circle","me-1"],[1,"bi","bi-box-seam","me-2","text-success"],[1,"text-end"],["class","d-flex flex-wrap justify-content-center gap-1",4,"ngIf"],["type","button",1,"btn","btn-outline-primary","btn-sm",3,"click"],["type","button",1,"btn","btn-outline-danger","btn-sm",3,"click"],["colspan","6",1,"text-center","text-muted","py-4"],[1,"bi","bi-inbox","fs-1","d-block","mb-2"],["type","submit",1,"btn","btn-primary",3,"disabled"],[1,"bi","bi-save","me-1"]],template:function(o,i){if(1&o){const n=t.RV6();t.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"h5",6),t.nrm(7,"i",7),t.EFF(8,"Gesti\xf3n de Cotizaciones "),t.k0s(),t.j41(9,"button",8),t.bIt("click",function(){return i.nuevaCotizacion()}),t.nrm(10,"i",9),t.EFF(11,"Nueva Cotizaci\xf3n "),t.k0s()()(),t.j41(12,"div",10)(13,"div",11)(14,"div",12)(15,"label",13),t.EFF(16,"No. Cotizaci\xf3n"),t.k0s(),t.j41(17,"input",14),t.bIt("ngModelChange",function(r){return i.txtcodigo=r})("input",function(r){return i.codigoEntra(r)}),t.k0s()(),t.j41(18,"div",15)(19,"label",13),t.EFF(20,"Nombre Cliente"),t.k0s(),t.j41(21,"input",16),t.bIt("ngModelChange",function(r){return i.txtdescripcion=r})("input",function(r){return i.descripcionEntra(r)}),t.k0s()(),t.j41(22,"div",12)(23,"label",13),t.EFF(24,"Fecha"),t.k0s(),t.j41(25,"input",17),t.bIt("ngModelChange",function(r){return i.txtfecha=r})("input",function(r){return i.fechaEntra(r)}),t.k0s()(),t.j41(26,"div",18)(27,"button",19),t.bIt("click",function(){return i.limpiaBusqueda()}),t.nrm(28,"i",20),t.k0s()()(),t.j41(29,"div",21)(30,"table",22)(31,"thead",23)(32,"tr")(33,"th",24),t.EFF(34,"N\xfamero"),t.k0s(),t.j41(35,"th",25),t.EFF(36,"Cliente"),t.k0s(),t.j41(37,"th",26),t.EFF(38,"Fecha"),t.k0s(),t.j41(39,"th",27),t.EFF(40,"Valor"),t.k0s(),t.j41(41,"th",28),t.EFF(42,"Acciones"),t.k0s()()(),t.j41(43,"tbody"),t.DNE(44,W,21,4,"tr",29),t.k0s()()(),t.j41(45,"nav",30)(46,"ul",31)(47,"li",32)(48,"a",33),t.bIt("click",function(){return i.changePage(1)}),t.j41(49,"span",34),t.EFF(50,"\xab\xab"),t.k0s()()(),t.j41(51,"li",32)(52,"a",35),t.bIt("click",function(){return i.changePage(i.currentPage-1)}),t.j41(53,"span",34),t.EFF(54,"\xab"),t.k0s()()(),t.DNE(55,H,3,3,"li",36),t.j41(56,"li",32)(57,"a",37),t.bIt("click",function(){return i.changePage(i.currentPage+1)}),t.j41(58,"span",34),t.EFF(59,"\xbb"),t.k0s()()(),t.j41(60,"li",32)(61,"a",38),t.bIt("click",function(){return i.changePage(i.totalPages)}),t.j41(62,"span",34),t.EFF(63,"\xbb\xbb"),t.k0s()()()()()()()()()(),t.j41(64,"div",39)(65,"div",40)(66,"div",41)(67,"div",42)(68,"h5",43),t.nrm(69,"i",7),t.EFF(70),t.k0s(),t.j41(71,"button",44),t.bIt("click",function(){return i.submitForm()}),t.k0s()(),t.j41(72,"div",45)(73,"form",46),t.bIt("ngSubmit",function(){return i.guardarCotizacion()}),t.j41(74,"div",47)(75,"div",48)(76,"div",49)(77,"div",50)(78,"h6",51),t.nrm(79,"i",52),t.EFF(80,"Informaci\xf3n del Cliente "),t.k0s()(),t.j41(81,"div",53)(82,"div",54)(83,"div",12)(84,"label",13),t.EFF(85,"RNC / C\xe9dula"),t.k0s(),t.j41(86,"input",55,56),t.bIt("keydown.enter",function(r){t.eBV(n);const l=t.sdS(93);return t.Njj(i.buscarRnc(r,l))}),t.k0s()(),t.j41(88,"div",57)(89,"label",13),t.EFF(90,"Nombre del Cliente"),t.k0s(),t.j41(91,"div",58)(92,"input",59,60),t.bIt("ngModelChange",function(r){return i.onUpperCase("ct_nomclie",r)})("keydown.enter",function(r){t.eBV(n);const l=t.sdS(100);return t.Njj(i.moveFocusnomclie(r,l))})("keydown",function(r){return i.handleKeydown(r)}),t.k0s(),t.j41(94,"div",61),t.DNE(95,Q,4,3,"a",62),t.k0s()()(),t.j41(96,"div",57)(97,"label",13),t.EFF(98,"Direcci\xf3n"),t.k0s(),t.j41(99,"input",63,64),t.bIt("ngModelChange",function(r){return i.onUpperCase("ct_dirclie",r)})("keydown",function(r){t.eBV(n);const l=t.sdS(105);return t.Njj(i.moveFocus(r,l))}),t.k0s()(),t.j41(101,"div",12)(102,"label",13),t.EFF(103,"Tel\xe9fono"),t.k0s(),t.j41(104,"input",65,66),t.bIt("keydown",function(r){t.eBV(n);const l=t.sdS(126);return t.Njj(i.moveFocus(r,l))}),t.k0s()()()()()(),t.j41(106,"div",67)(107,"div",49)(108,"div",50)(109,"h6",51),t.nrm(110,"i",68),t.EFF(111,"Datos de Cotizaci\xf3n "),t.k0s()(),t.j41(112,"div",53)(113,"div",54)(114,"div",69)(115,"label",13),t.EFF(116,"No. Cotizaci\xf3n"),t.k0s(),t.nrm(117,"input",70),t.k0s(),t.j41(118,"div",69)(119,"label",13),t.EFF(120,"Fecha"),t.k0s(),t.nrm(121,"input",71),t.k0s(),t.j41(122,"div",69)(123,"label",13),t.EFF(124,"C\xf3digo Vendedor"),t.k0s(),t.j41(125,"input",72,73),t.bIt("ngModelChange",function(r){return i.onUpperCase("ct_codvend",r)})("keydown",function(r){t.eBV(n);const l=t.sdS(141);return t.Njj(i.moveFocus(r,l))})("keydown.enter",function(r){t.eBV(n);const l=t.sdS(141);return t.Njj(i.buscarUsuario(r,l))}),t.k0s(),t.DNE(127,Z,3,0,"div",74),t.k0s(),t.j41(128,"div",69)(129,"label",13),t.EFF(130,"Nombre Vendedor"),t.k0s(),t.nrm(131,"input",75),t.k0s()()()()()(),t.j41(132,"div",76)(133,"div",53)(134,"div",77)(135,"div",78)(136,"label",13),t.EFF(137,"C\xf3digo"),t.k0s(),t.j41(138,"div",58)(139,"input",79,80),t.bIt("ngModelChange",function(r){return i.codmerc=null==r?null:r.toUpperCase()})("keydown",function(r){return i.handleKeydownInventario(r)})("keydown",function(r){t.eBV(n);const l=t.sdS(150);return t.Njj(i.moveFocuscodmerc(r,l))})("ngModelChange",function(r){return i.codmerc=r}),t.k0s(),t.j41(142,"div",81),t.DNE(143,tt,4,3,"a",62),t.k0s()()(),t.j41(144,"div",15)(145,"label",13),t.EFF(146,"Descripci\xf3n"),t.k0s(),t.j41(147,"div",58)(148,"input",82,83),t.bIt("ngModelChange",function(r){return i.descripcionmerc=null==r?null:r.toUpperCase()})("keydown",function(r){t.eBV(n);const l=t.sdS(157);return t.Njj(i.moveFocusdesc(r,l))})("keydown",function(r){return i.handleKeydownInventariosdesc(r)})("ngModelChange",function(r){return i.descripcionmerc=r}),t.k0s(),t.j41(151,"div",81),t.DNE(152,et,4,3,"a",62),t.k0s()()(),t.j41(153,"div",78)(154,"label",13),t.EFF(155,"Cantidad"),t.k0s(),t.j41(156,"input",84,85),t.bIt("ngModelChange",function(r){return i.cantidadmerc=r})("keydown",function(r){t.eBV(n);const l=t.sdS(162);return t.Njj(i.moveFocusCantidad(r,l))}),t.k0s()(),t.j41(158,"div",78)(159,"label",13),t.EFF(160,"Precio"),t.k0s(),t.j41(161,"input",86,87),t.bIt("ngModelChange",function(r){return i.preciomerc=r})("keydown",function(r){t.eBV(n);const l=t.sdS(141);return t.Njj(i.moveFocus(r,l))})("keydown.enter",function(r){return i.agregaItem(r)}),t.k0s()(),t.j41(163,"div",18)(164,"button",88),t.bIt("click",function(r){return i.agregaItem(r)}),t.nrm(165,"i",89),t.k0s()()()()(),t.j41(166,"div",76)(167,"div",90)(168,"table",91,92)(170,"thead",93)(171,"tr")(172,"th",94),t.EFF(173,"C\xf3digo"),t.k0s(),t.j41(174,"th",95),t.EFF(175,"Descripci\xf3n"),t.k0s(),t.j41(176,"th",96),t.EFF(177,"Cantidad"),t.k0s(),t.j41(178,"th",97),t.EFF(179,"Precio Ud."),t.k0s(),t.j41(180,"th",97),t.EFF(181,"Total"),t.k0s(),t.j41(182,"th",98),t.EFF(183,"Acciones"),t.k0s()()(),t.j41(184,"tbody"),t.DNE(185,ot,15,10,"tr",29),t.DNE(186,nt,4,0,"tr",99),t.k0s()()(),t.j41(187,"div",100)(188,"div",101),t.nrm(189,"div",102),t.j41(190,"div",103)(191,"div",104)(192,"span",105),t.EFF(193,"Sub-Total:"),t.k0s(),t.j41(194,"span",106),t.EFF(195),t.nI1(196,"currency"),t.k0s()(),t.j41(197,"div",104)(198,"span",105),t.EFF(199,"ITBIS (18%):"),t.k0s(),t.j41(200,"span",106),t.EFF(201),t.nI1(202,"currency"),t.k0s()(),t.j41(203,"div",107)(204,"span",108),t.EFF(205,"Total General:"),t.k0s(),t.j41(206,"span",109),t.EFF(207),t.nI1(208,"currency"),t.k0s()()()()()(),t.j41(209,"div",110)(210,"button",111),t.bIt("click",function(){return i.submitForm()}),t.nrm(211,"i",112),t.EFF(212,"Cancelar "),t.k0s(),t.DNE(213,rt,3,1,"button",113),t.k0s()()()()()()}if(2&o){let n,a;t.R7$(17),t.Y8G("ngModel",i.txtcodigo),t.R7$(4),t.Y8G("ngModel",i.txtdescripcion),t.R7$(4),t.Y8G("ngModel",i.txtfecha),t.R7$(19),t.Y8G("ngForOf",i.cotizacionList),t.R7$(3),t.AVh("disabled",1===i.currentPage),t.R7$(4),t.AVh("disabled",1===i.currentPage),t.R7$(4),t.Y8G("ngForOf",i.pages),t.R7$(1),t.AVh("disabled",i.currentPage===i.totalPages),t.R7$(4),t.AVh("disabled",i.currentPage===i.totalPages),t.R7$(10),t.SpI("",i.tituloModalCotizacion," "),t.R7$(3),t.Y8G("formGroup",i.formularioCotizacion),t.R7$(19),t.Y8G("formControl",i.buscarNombre),t.R7$(2),t.Y8G("ngClass",t.eq3(44,w,i.resultadoNombre.length>0)),t.R7$(1),t.Y8G("ngForOf",i.resultadoNombre),t.R7$(30),t.Y8G("ngClass",t.eq3(46,at,(null==(n=i.formularioCotizacion.get("ct_codvend"))?null:n.touched)&&(null==(n=i.formularioCotizacion.get("ct_codvend"))?null:n.invalid))),t.R7$(2),t.Y8G("ngIf",(null==(a=i.formularioCotizacion.get("ct_codvend"))?null:a.touched)&&(null==(a=i.formularioCotizacion.get("ct_codvend"))?null:a.invalid)),t.R7$(12),t.Y8G("formControl",i.buscarcodmerc)("ngModel",i.codmerc),t.R7$(3),t.Y8G("ngClass",t.eq3(48,w,i.resultadoCodmerc.length>0)),t.R7$(1),t.Y8G("ngForOf",i.resultadoCodmerc),t.R7$(5),t.Y8G("formControl",i.buscardescripcionmerc)("ngModel",i.descripcionmerc),t.R7$(3),t.Y8G("ngClass",t.eq3(50,w,i.resultadodescripcionmerc.length>0)),t.R7$(1),t.Y8G("ngForOf",i.resultadodescripcionmerc),t.R7$(4),t.Y8G("ngModel",i.cantidadmerc)("formControl",i.cantidadform),t.R7$(5),t.Y8G("ngModel",i.preciomerc)("formControl",i.precioform),t.R7$(24),t.Y8G("ngForOf",i.items),t.R7$(1),t.Y8G("ngIf",0===i.items.length),t.R7$(9),t.JRh(t.bMT(196,38,i.subTotal)),t.R7$(6),t.JRh(t.bMT(202,40,i.totalItbis)),t.R7$(6),t.JRh(t.bMT(208,42,i.totalGral)),t.R7$(6),t.Y8G("ngIf",!i.modoconsultaCotizacion)}},dependencies:[x.YU,x.Sq,x.bT,m.qT,m.me,m.Q0,m.BC,m.cb,m.VZ,m.l_,m.j4,m.JD,m.vS,x.oe],styles:[".tabla-fija[_ngcontent-%COMP%]{height:350px;overflow-y:auto;overflow-x:hidden;border:1px solid #ddd}.tabla-detalle-sm[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{position:sticky;top:0;z-index:5;background-color:#f8f9fa}.modal-altura[_ngcontent-%COMP%]{max-height:60vh}.modal-altura[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]{max-height:60vh;overflow-y:auto}.container-fluid[_ngcontent-%COMP%]{background-color:#f8f9fa}.card[_ngcontent-%COMP%]{border-radius:8px;border:1px solid #dee2e6}.card-header[_ngcontent-%COMP%]{border-radius:8px 8px 0 0!important;padding:1rem 1.25rem}.table-responsive[_ngcontent-%COMP%]{border-radius:8px;box-shadow:0 0 10px #0000000d}.table-responsive[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{position:sticky;top:0;z-index:10;background-color:#212529;color:#fff;font-weight:600;font-size:.875rem;text-transform:uppercase;letter-spacing:.5px;padding:.75rem;border:none}.table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#f8f9fa}.table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.75rem;vertical-align:middle;font-size:.9rem;border:1px solid #dee2e6}.table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{border:1px solid #dee2e6}.btn[_ngcontent-%COMP%]{border-radius:6px;font-weight:500;padding:.5rem 1rem;transition:background-color .2s ease}.btn-primary[_ngcontent-%COMP%]{background:linear-gradient(135deg,#0d6efd 0%,#0a58ca 100%)}.btn-outline-primary[_ngcontent-%COMP%]:hover{background:linear-gradient(135deg,#0d6efd 0%,#0a58ca 100%);color:#fff}.btn-group-sm[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{padding:.25rem .5rem;font-size:.875rem}.form-control[_ngcontent-%COMP%]{border-radius:6px;border:1px solid #dee2e6;padding:.5rem .75rem;transition:all .3s ease;font-size:.9rem}.form-control[_ngcontent-%COMP%]:focus{border-color:#0d6efd;box-shadow:0 0 0 .2rem #0d6efd26;outline:none}.form-control[_ngcontent-%COMP%]:disabled, .form-control[readonly][_ngcontent-%COMP%]{background-color:#e9ecef;cursor:not-allowed}.form-label[_ngcontent-%COMP%]{margin-bottom:.375rem;font-weight:500}.dropdown-menu[_ngcontent-%COMP%]{border-radius:8px;border:1px solid #dee2e6;box-shadow:0 4px 12px #00000026;padding:.5rem 0}.dropdown-item[_ngcontent-%COMP%]{padding:.5rem 1rem;transition:all .2s ease;font-size:.9rem}.dropdown-item[_ngcontent-%COMP%]:hover, .dropdown-item.active[_ngcontent-%COMP%]{background-color:#0d6efd;color:#fff}.dropdown-item[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1.1rem}.modal-content[_ngcontent-%COMP%]{border-radius:12px;border:none}.modal-header[_ngcontent-%COMP%]{border-radius:12px 12px 0 0;padding:1.25rem 1.5rem;border-bottom:1px solid rgba(255,255,255,.1)}.modal-body[_ngcontent-%COMP%]{padding:1.5rem}.pagination[_ngcontent-%COMP%]{gap:.25rem}.page-link[_ngcontent-%COMP%]{border-radius:6px;border:1px solid #dee2e6;color:#0d6efd;padding:.5rem .75rem;margin:0 2px;transition:all .3s ease}.page-link[_ngcontent-%COMP%]:hover{background-color:#0d6efd;color:#fff;border-color:#0d6efd}.page-item.active[_ngcontent-%COMP%]   .page-link[_ngcontent-%COMP%]{background-color:#0d6efd;border-color:#0d6efd;font-weight:600}.page-item.disabled[_ngcontent-%COMP%]   .page-link[_ngcontent-%COMP%]{opacity:.5;cursor:not-allowed}i[_ngcontent-%COMP%]{cursor:pointer}tfoot[_ngcontent-%COMP%]{position:sticky;bottom:0;background-color:#f8f9fa;z-index:5;border-top:2px solid #dee2e6}@media (max-width: 768px){.modal-dialog[_ngcontent-%COMP%]{margin:.5rem}.card-body[_ngcontent-%COMP%]{padding:.75rem}.table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:.4rem .3rem;font-size:.8rem}.btn-group-sm[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{padding:.15rem .3rem;font-size:.75rem}.btn-group[_ngcontent-%COMP%]{gap:2px;flex-wrap:wrap}.btn[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:.85rem}.table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{height:auto;min-height:35px}.btn-group-sm[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:2px}.card-header[_ngcontent-%COMP%]{padding:.75rem}.card-header[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%], .card-header[_ngcontent-%COMP%]   h6[_ngcontent-%COMP%]{font-size:.9rem}.form-label[_ngcontent-%COMP%]{font-size:.8rem;margin-bottom:.25rem}.form-control[_ngcontent-%COMP%]{padding:.375rem .5rem;font-size:.85rem}.table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:last-child{min-width:140px}}@media (max-width: 576px){.table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:.3rem .2rem;font-size:.75rem}.btn-group-sm[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{padding:.1rem .25rem;font-size:.7rem}.btn[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:.75rem}.table-responsive[_ngcontent-%COMP%]{max-height:350px!important}.pagination[_ngcontent-%COMP%]{font-size:.8rem}.page-link[_ngcontent-%COMP%]{padding:.3rem .5rem}.table-responsive[_ngcontent-%COMP%]{overflow-x:auto;-webkit-overflow-scrolling:touch}.table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:last-child{min-width:120px}}.table-responsive[_ngcontent-%COMP%]::-webkit-scrollbar{width:8px;height:8px}.table-responsive[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f1f1f1;border-radius:10px}.table-responsive[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#888;border-radius:10px}.table-responsive[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#555}.uppercase[_ngcontent-%COMP%], input.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.btn-sm[_ngcontent-%COMP%]{min-width:32px;height:32px;display:inline-flex;align-items:center;justify-content:center}.gap-1[_ngcontent-%COMP%]{gap:.25rem}.d-flex.flex-wrap[_ngcontent-%COMP%]{max-width:100%}@media (max-width: 768px){.table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:first-child, .table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:first-child{min-width:70px}.table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:nth-child(2), .table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-child(2){min-width:120px}.table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:nth-child(3), .table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-child(3){min-width:80px}.table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:nth-child(4), .table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-child(4){min-width:80px}.d-flex.flex-wrap[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-bottom:2px}}@media (max-width: 576px){.btn-sm[_ngcontent-%COMP%]{min-width:28px;height:28px;font-size:.7rem}.btn-sm[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:.75rem}}"]})}}return s})()}];let lt=(()=>{class s{static{this.\u0275fac=function(o){return new(o||s)}}static{this.\u0275mod=t.$C({type:s})}static{this.\u0275inj=t.G2t({imports:[O.iI.forChild(st),O.iI]})}}return s})(),dt=(()=>{class s{static{this.\u0275fac=function(o){return new(o||s)}}static{this.\u0275mod=t.$C({type:s})}static{this.\u0275inj=t.G2t({imports:[x.MD,lt,m.X1,m.YN]})}}return s})()}}]);