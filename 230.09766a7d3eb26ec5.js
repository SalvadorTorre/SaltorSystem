"use strict";(self.webpackChunkSaltorSystem=self.webpackChunkSaltorSystem||[]).push([[230],{9230:(A,p,l)=>{l.r(p),l.d(p,{ModuloUsuario:()=>O});var b=l(177),d=l(9417),U=l(8871);class c{constructor(u){this.idpermiso=u?.idpermiso??0,this.codusuario=u?.codusuario??void 0,this.idmodulo=u?.idmodulo??void 0,this.acceso=u?.acceso??"N",this.lectura=u?.lectura??"N"}}var _=l(8032),h=l.n(_),v=l(7468),e=l(8699),F=l(6687),C=l(9191),M=l(5961),j=l(3149),k=l(3584),E=l(2265);function T(a,u){if(1&a){const o=e.RV6();e.j41(0,"tr")(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td"),e.EFF(6),e.k0s(),e.j41(7,"td"),e.EFF(8),e.k0s(),e.j41(9,"td")(10,"button",83),e.bIt("click",function(){const n=e.eBV(o).$implicit,s=e.XpG();return e.Njj(s.consultarUsuario(n))}),e.nrm(11,"i",84),e.k0s(),e.j41(12,"button",85),e.bIt("click",function(){const n=e.eBV(o).$implicit,s=e.XpG();return e.Njj(s.abrirEditarUsuario(n))}),e.nrm(13,"i",86),e.k0s(),e.j41(14,"button",87),e.bIt("click",function(){const n=e.eBV(o).$implicit,s=e.XpG();return e.Njj(s.eliminarUsuario(n))}),e.nrm(15,"i",88),e.k0s(),e.j41(16,"button",89),e.bIt("click",function(){const n=e.eBV(o).$implicit,s=e.XpG();return e.Njj(s.abrirPermisosUsuario(n))}),e.nrm(17,"i",90),e.k0s()()()}if(2&a){const o=u.$implicit;e.R7$(2),e.JRh(o.codUsuario),e.R7$(2),e.JRh(o.idUsuario),e.R7$(2),e.JRh(o.nombreUsuario),e.R7$(2),e.JRh(o.nivel)}}function N(a,u){if(1&a){const o=e.RV6();e.j41(0,"tr")(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td"),e.EFF(6),e.k0s(),e.j41(7,"td"),e.EFF(8),e.k0s(),e.j41(9,"td")(10,"button",91),e.bIt("click",function(){const n=e.eBV(o).$implicit,s=e.XpG();return e.Njj(s.eliminarPermiso(n))}),e.nrm(11,"i",88),e.k0s()()()}if(2&a){const o=u.$implicit,r=e.XpG();e.R7$(2),e.JRh(o.idpermiso),e.R7$(2),e.JRh(r.descModulo(o.idmodulo)),e.R7$(2),e.JRh(o.acceso),e.R7$(2),e.JRh(o.lectura)}}function S(a,u){if(1&a){const o=e.RV6();e.j41(0,"tr")(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td"),e.EFF(6),e.k0s(),e.j41(7,"td"),e.EFF(8),e.k0s(),e.j41(9,"td")(10,"button",92),e.bIt("click",function(){const i=e.eBV(o),n=i.$implicit,s=i.index,t=e.XpG();return e.Njj(t.abrirEditarPermiso(n,s))}),e.nrm(11,"i",86),e.k0s(),e.j41(12,"button",91),e.bIt("click",function(){const n=e.eBV(o).$implicit,s=e.XpG();return e.Njj(s.eliminarPermiso(n))}),e.nrm(13,"i",88),e.k0s()()()}if(2&a){const o=u.$implicit,r=e.XpG();e.R7$(2),e.JRh(o.idpermiso),e.R7$(2),e.JRh(r.descModulo(o.idmodulo)),e.R7$(2),e.JRh(o.acceso),e.R7$(2),e.JRh(o.lectura)}}function R(a,u){if(1&a&&(e.j41(0,"option",42),e.EFF(1),e.k0s()),2&a){const o=u.$implicit;e.Y8G("ngValue",o.idmodulo),e.R7$(1),e.JRh(o.descmodulo)}}function y(a,u){if(1&a&&(e.j41(0,"option",42),e.EFF(1),e.k0s()),2&a){const o=u.$implicit;e.Y8G("ngValue",o.cod_sucursal),e.R7$(1),e.Lme("",o.nom_sucursal," (",o.cod_empre,")")}}function P(a,u){if(1&a&&(e.j41(0,"option",42),e.EFF(1),e.k0s()),2&a){const o=u.$implicit;e.Y8G("ngValue",o.cod_sucursal),e.R7$(1),e.Lme("",o.nom_sucursal," (",o.cod_empre,")")}}function G(a,u){if(1&a&&(e.j41(0,"option",42),e.EFF(1),e.k0s()),2&a){const o=u.$implicit;e.Y8G("ngValue",o.id),e.R7$(1),e.JRh(o.descripcion||o.id)}}function I(a,u){if(1&a){const o=e.RV6();e.j41(0,"tr")(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td")(4,"select",94),e.bIt("ngModelChange",function(i){const s=e.eBV(o).$implicit;return e.Njj(s.acceso=i)}),e.j41(5,"option",47),e.EFF(6,"S\xed"),e.k0s(),e.j41(7,"option",48),e.EFF(8,"No"),e.k0s()()(),e.j41(9,"td")(10,"select",94),e.bIt("ngModelChange",function(i){const s=e.eBV(o).$implicit;return e.Njj(s.lectura=i)}),e.j41(11,"option",47),e.EFF(12,"S\xed"),e.k0s(),e.j41(13,"option",48),e.EFF(14,"No"),e.k0s()()()()}if(2&a){const o=u.$implicit,r=u.index,i=e.XpG(2);e.R7$(2),e.JRh(i.descModulo(o.idmodulo)),e.R7$(2),e.Mz_("name","detalle-",r,"-acceso"),e.Y8G("ngModel",o.acceso),e.R7$(6),e.Mz_("name","detalle-",r,"-lectura"),e.Y8G("ngModel",o.lectura)}}function w(a,u){if(1&a&&(e.j41(0,"div",93)(1,"h6",25),e.EFF(2,"M\xf3dulos del tipo seleccionado"),e.k0s(),e.j41(3,"div",15)(4,"table",16)(5,"thead")(6,"tr")(7,"th"),e.EFF(8,"M\xf3dulo"),e.k0s(),e.j41(9,"th"),e.EFF(10,"acceso"),e.k0s(),e.j41(11,"th"),e.EFF(12,"lectura"),e.k0s()()(),e.j41(13,"tbody"),e.DNE(14,I,15,5,"tr",17),e.k0s()()()()),2&a){const o=e.XpG();e.R7$(14),e.Y8G("ngForOf",o.detallesTipoSeleccionado)}}const Y=[{path:"",component:(()=>{class a{constructor(o,r,i,n,s,t){this.usuarioSrv=o,this.permisoSrv=r,this.moduloSrv=i,this.sucSrv=n,this.tipoSrv=s,this.empresaSrv=t,this.usuarios=[],this.filtroUsuario="",this.selectedUsuario=null,this.permisos=[],this.modulos=[],this.sucursales=[],this.tipousuarios=[],this.actual=new c,this.editIndex=-1,this.editableUsuario={},this.nuevoUsuario={},this.detallesTipoSeleccionado=[],this.Toast=h().mixin({toast:!0,position:"bottom-start",showConfirmButton:!1,timer:5e3,timerProgressBar:!1})}ngOnInit(){this.cargarUsuarios(),this.cargarModulos(),this.cargarSucursales(),this.cargarTipousuarios()}fireToast(o){const i=typeof window<"u"&&window.innerWidth<=576?"bottom-end":"bottom-start";this.Toast.fire({title:o.title,icon:o.icon,position:i,timer:"number"==typeof o.timer?o.timer:"success"===o.icon?4e3:5e3,timerProgressBar:"boolean"==typeof o.timerProgressBar?o.timerProgressBar:"success"===o.icon})}get usuariosFiltrados(){const o=this.filtroUsuario.trim().toLowerCase();return o?this.usuarios.filter(r=>String(r.idUsuario||"").toLowerCase().includes(o)||String(r.codUsuario||"").toLowerCase().includes(o)||String(r.nombreUsuario||"").toLowerCase().includes(o)):this.usuarios}unwrapList(o){return o?Array.isArray(o)?o:Array.isArray(o?.data)?o.data:Array.isArray(o?.items)?o.items:Array.isArray(o?.data?.items)?o.data.items:[]:[]}cargarUsuarios(){this.usuarioSrv.buscarTodosUsuario(1,200).subscribe({next:o=>{this.usuarios=this.unwrapList(o)},error:()=>{this.usuarios=[]}})}cargarModulos(){this.moduloSrv.obtenerTodosModulo().subscribe({next:o=>{this.modulos=this.unwrapList(o)},error:()=>{this.modulos=[]}})}cargarSucursales(){this.sucSrv.buscarTodasSucursal().subscribe({next:o=>{this.sucursales=this.unwrapList(o)},error:()=>{this.sucursales=[]}})}cargarTipousuarios(){this.tipoSrv.obtenerTodosTipousuario().subscribe({next:o=>{this.tipousuarios=this.unwrapList(o)},error:()=>{this.tipousuarios=[]}})}descModulo(o){return o&&this.modulos.find(i=>i?.idmodulo===o)?.descmodulo||"-"}abrirPermisosUsuario(o){this.selectedUsuario=o,this.actual=new c({codusuario:Number(o.codUsuario)||void 0}),this.editIndex=-1,this.permisoSrv.obtenerTodosPermiso().subscribe({next:r=>{const i=this.unwrapList(r),n=Number(o.codUsuario);this.permisos=i.filter(s=>Number(s?.codusuario)===n),$("#modalPermisosUsuario").modal("show")},error:()=>{this.permisos=[],$("#modalPermisosUsuario").modal("show")}})}consultarUsuario(o){this.selectedUsuario=o,this.actual=new c({codusuario:Number(o.codUsuario)||void 0}),this.editIndex=-1,this.permisoSrv.obtenerTodosPermiso().subscribe({next:r=>{const i=this.unwrapList(r),n=Number(o.codUsuario);this.permisos=i.filter(s=>Number(s?.codusuario)===n),$("#modalConsultaUsuario").modal("show")},error:()=>{this.permisos=[],$("#modalConsultaUsuario").modal("show")}})}abrirEditarUsuario(o){this.selectedUsuario=o,this.editableUsuario={codUsuario:o.codUsuario,idUsuario:o.idUsuario,nombreUsuario:o.nombreUsuario,claveUsuario:o.claveUsuario,nivel:o.nivel,correo:o.correo,empresa:o.empresa,sucursal:o.sucursal},$("#modalEditarUsuario").modal("show")}guardarEdicionUsuario(o){if(!this.selectedUsuario)return void this.fireToast({title:"Usuario no seleccionado",icon:"warning"});if(!o.valid)return void this.fireToast({title:"Formulario inv\xe1lido",icon:"warning"});const r=Number(this.selectedUsuario.codUsuario);this.usuarioSrv.editarUsuario(r,this.editableUsuario).subscribe({next:()=>{this.cargarUsuarios(),$("#modalEditarUsuario").modal("hide"),this.fireToast({title:"Usuario actualizado",icon:"success"})},error:()=>{this.fireToast({title:"Error al actualizar usuario",icon:"error"})}})}abrirNuevoUsuario(){this.nuevoUsuario={codUsuario:void 0,idUsuario:"",claveUsuario:"",nombreUsuario:"",nivel:1,correo:"",claveCorreo:"",idtipoUsuario:void 0,sucursalid:void 0,idpermiso:void 0,cod_empre:""},this.detallesTipoSeleccionado=[],$("#modalNuevoUsuario").modal("show")}onTipoUsuarioChange(o){this.detallesTipoSeleccionado=[],o&&this.tipoSrv.buscarTipousuario(Number(o)).subscribe({next:r=>{const i=Array.isArray(r?.data)?r.data[0]:r?.data??r;this.detallesTipoSeleccionado=Array.isArray(i?.dtipousuarios)?i.dtipousuarios:[]},error:()=>{this.detallesTipoSeleccionado=[]}})}guardarNuevoUsuario(o){if(!o.valid)return void this.fireToast({title:"Formulario inv\xe1lido",icon:"warning"});const r=Number(this.nuevoUsuario?.codUsuario),i=String(this.nuevoUsuario?.idUsuario||"").trim().toLowerCase();this.usuarios.some(s=>Number(s?.codUsuario)===r||String(s?.idUsuario||"").trim().toLowerCase()===i)?this.fireToast({title:"Usuario duplicado",icon:"warning"}):this.usuarioSrv.guardarUsuario(this.nuevoUsuario).subscribe({next:s=>{(g=>{if(!g||isNaN(g)){const V=String(this.nuevoUsuario?.idUsuario||"");this.usuarioSrv.buscarUsuarioPorClave(V).subscribe({next:m=>{const x=Array.isArray(m?.data)?m.data[0]:m?.data??m,f=Number(x?.codUsuario);f?this.persistirPermisosDesdeDetalles(f):this.fireToast({title:"Usuario creado (sin permisos por tipo)",icon:"info"}),this.cargarUsuarios(),$("#modalNuevoUsuario").modal("hide"),this.fireToast({title:"Usuario creado",icon:"success"})},error:()=>{this.cargarUsuarios(),$("#modalNuevoUsuario").modal("hide"),this.fireToast({title:"Usuario creado (no se pudieron cargar permisos)",icon:"warning"})}})}else this.persistirPermisosDesdeDetalles(g),this.cargarUsuarios(),$("#modalNuevoUsuario").modal("hide"),this.fireToast({title:"Usuario creado",icon:"success"})})(Number(s?.data?.codUsuario??s?.codUsuario??(Array.isArray(s?.data)?s.data[0]?.codUsuario:void 0)))},error:()=>{this.fireToast({title:"Error al crear usuario",icon:"error"})}})}persistirPermisosDesdeDetalles(o){if(!o||!Array.isArray(this.detallesTipoSeleccionado)||0===this.detallesTipoSeleccionado.length)return;const r=this.detallesTipoSeleccionado.map(i=>{const n={codusuario:o,idmodulo:Number(i?.idmodulo),acceso:String(i?.acceso||"N").toUpperCase(),lectura:String(i?.lectura||"N").toUpperCase()};return this.permisoSrv.guardarPermiso(n)});(0,v.p)(r).subscribe({next:()=>{this.fireToast({title:"Permisos aplicados por tipo de usuario",icon:"success"})},error:()=>{this.fireToast({title:"Error aplicando permisos por tipo",icon:"error"})}})}onSucursalChange(o){if(!o)return;const r=this.sucursales.find(i=>Number(i?.cod_sucursal)===Number(o));r&&(this.nuevoUsuario.sucursalid=o,this.nuevoUsuario.sucursal=o,this.nuevoUsuario.cod_empre=r.cod_empre??this.nuevoUsuario.cod_empre,r.cod_empre?this.empresaSrv.buscarEmpres(String(r.cod_empre)).subscribe({next:i=>{const n=Array.isArray(i?.data)?i.data[0]:i?.data??i;this.nuevoUsuario.empresa=String(n?.nom_empre||"").trim()},error:()=>{this.nuevoUsuario.empresa=""}}):this.nuevoUsuario.empresa="")}eliminarUsuario(o){if(!o||!o.codUsuario)return void this.fireToast({title:"Usuario inv\xe1lido",icon:"error"});const r=Number(o.codUsuario);h().fire({title:"Eliminar usuario",text:`\xbfEliminar usuario ${o.nombreUsuario} (${o.idUsuario})?`,icon:"question",showCancelButton:!0,confirmButtonText:"Eliminar",cancelButtonText:"Cancelar"}).then(i=>{i.isConfirmed&&this.usuarioSrv.eliminarUsuario(r).subscribe({next:()=>{this.cargarUsuarios(),this.fireToast({title:"Usuario eliminado",icon:"success"})},error:()=>{this.cargarUsuarios(),this.fireToast({title:"Error al eliminar",icon:"error"})}})})}cerrarModalPermisosUsuario(){$("#modalPermisosUsuario").modal("hide"),this.selectedUsuario=null,this.permisos=[],this.actual=new c,this.editIndex=-1}abrirNuevoPermiso(){this.selectedUsuario&&(this.editIndex=-1,this.actual=new c({codusuario:Number(this.selectedUsuario.codUsuario)}))}abrirEditarPermiso(o,r){this.editIndex=r,this.actual=new c({idpermiso:o.idpermiso,codusuario:o.codusuario,idmodulo:o.idmodulo,acceso:o.acceso,lectura:o.lectura})}guardarPermiso(o){if(!o.valid)return void this.fireToast({title:"Formulario inv\xe1lido",icon:"warning"});if(!this.selectedUsuario)return void this.fireToast({title:"Usuario no seleccionado",icon:"warning"});const r={codusuario:Number(this.selectedUsuario.codUsuario),idmodulo:this.actual.idmodulo,acceso:this.actual.acceso,lectura:this.actual.lectura};if(console.log("Guardar permiso",r),r.idmodulo){if(this.editIndex<0){const i=Number(this.selectedUsuario.codUsuario),n=Number(this.actual.idmodulo);if(this.permisos.some(t=>Number(t?.codusuario)===i&&Number(t?.idmodulo)===n))return void this.fireToast({title:"Permiso duplicado",icon:"warning"})}this.editIndex>=0&&this.actual.idpermiso?this.permisoSrv.editarPermiso(this.actual.idpermiso,r).subscribe({next:()=>{this.refrescarListaTrasCambio(),this.fireToast({title:"Permiso actualizado",icon:"success"})},error:()=>{this.refrescarListaTrasCambio(),this.fireToast({title:"Error al actualizar",icon:"error"})}}):this.permisoSrv.guardarPermiso(r).subscribe({next:()=>{this.refrescarListaTrasCambio(),this.fireToast({title:"Permiso creado",icon:"success"})},error:()=>{this.refrescarListaTrasCambio(),this.fireToast({title:"Error al crear",icon:"error"})}})}else this.fireToast({title:"M\xf3dulo requerido",icon:"warning"})}eliminarPermiso(o){o?.idpermiso?h().fire({title:"Eliminar permiso",text:"\xbfDesea eliminar este permiso?",icon:"question",showCancelButton:!0,confirmButtonText:"Eliminar",cancelButtonText:"Cancelar"}).then(r=>{r.isConfirmed&&this.permisoSrv.eliminarPermiso(o.idpermiso).subscribe({next:()=>{this.refrescarListaTrasCambio(),this.fireToast({title:"Permiso eliminado",icon:"success"})},error:()=>{this.refrescarListaTrasCambio(),this.fireToast({title:"Error al eliminar",icon:"error"})}})}):this.fireToast({title:"Permiso inv\xe1lido",icon:"error"})}refrescarListaTrasCambio(){this.selectedUsuario&&(this.permisoSrv.obtenerTodosPermiso().subscribe({next:o=>{const r=this.unwrapList(o),i=Number(this.selectedUsuario.codUsuario);this.permisos=r.filter(n=>Number(n?.codusuario)===i)},error:()=>{this.permisos=[]}}),this.editIndex=-1,this.actual=new c({codusuario:Number(this.selectedUsuario.codUsuario)}))}static{this.\u0275fac=function(r){return new(r||a)(e.rXU(F.f),e.rXU(C.m),e.rXU(M.V),e.rXU(j.F),e.rXU(k.b),e.rXU(E.g))}}static{this.\u0275cmp=e.VBU({type:a,selectors:[["Usuario"]],decls:263,vars:44,consts:[[1,"container-fluid"],[1,"card","shadow-sm"],[1,"card-header","bg-primary","text-white","d-flex","align-items-center"],[1,"bi","bi-people","me-2"],[1,"mb-0"],[1,"card-body"],[1,"row","g-3","mb-3","align-items-center"],[1,"col-12","col-md-6"],[1,"input-group"],[1,"input-group-text"],[1,"bi","bi-search"],["type","text","placeholder","Buscar usuario...",1,"form-control",3,"ngModel","ngModelChange"],[1,"col-12","col-md-6","text-md-end"],["data-bs-toggle","modal","data-bs-target","#modalNuevoUsuario",1,"btn","btn-success",3,"click"],[1,"bi","bi-person-plus","me-1"],[1,"table-responsive"],[1,"table","table-sm","table-hover"],[4,"ngFor","ngForOf"],["id","modalConsultaUsuario","tabindex","-1","aria-labelledby","modalConsultaUsuarioLabel","aria-hidden","true",1,"modal","fade"],[1,"modal-dialog"],[1,"modal-content"],[1,"modal-header"],["id","modalConsultaUsuarioLabel",1,"modal-title"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close"],[1,"modal-body"],[1,"mb-2"],[1,"d-flex","justify-content-between","align-items-center","mb-2"],["data-bs-toggle","modal","data-bs-target","#permisoUsuarioFormModal",1,"btn","btn-primary","btn-sm",3,"click"],[1,"bi","bi-plus-circle","me-1"],[1,"modal-footer"],["type","button","data-bs-dismiss","modal",1,"btn","btn-outline-secondary"],["id","modalPermisosUsuario","tabindex","-1","aria-labelledby","modalPermisosUsuarioLabel","aria-hidden","true",1,"modal","fade"],[1,"modal-dialog","modal-lg"],["id","modalPermisosUsuarioLabel",1,"modal-title"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close",3,"click"],["id","permisoUsuarioFormModal","tabindex","-1","aria-labelledby","permisoUsuarioFormModalLabel","aria-hidden","true",1,"modal","fade"],["id","permisoUsuarioFormModalLabel",1,"modal-title"],[3,"ngSubmit"],["permisoForm","ngForm"],[1,"mb-3"],[1,"form-label"],["name","idmodulo","required","",1,"form-select",3,"ngModel","ngModelChange"],[3,"ngValue"],[3,"ngValue",4,"ngFor","ngForOf"],[1,"row","g-3"],[1,"col-6"],["name","acceso","required","",1,"form-select",3,"ngModel","ngModelChange"],["value","S"],["value","N"],["name","lectura","required","",1,"form-select",3,"ngModel","ngModelChange"],["type","submit",1,"btn","btn-primary",3,"disabled"],[1,"bi","bi-save","me-1"],["id","modalEditarUsuario","tabindex","-1","aria-labelledby","modalEditarUsuarioLabel","aria-hidden","true",1,"modal","fade"],["id","modalEditarUsuarioLabel",1,"modal-title"],["editarUsuarioForm","ngForm"],["type","text","name","idUsuario","required","",1,"form-control",3,"ngModel","ngModelChange"],["type","text","name","nombreUsuario","required","",1,"form-control",3,"ngModel","ngModelChange"],["type","password","name","claveUsuario",1,"form-control",3,"ngModel","ngModelChange"],["type","number","name","nivel","required","",1,"form-control",3,"ngModel","ngModelChange"],["name","sucursal","required","",1,"form-select",3,"ngModel","ngModelChange"],[1,"row","g-3","mt-0"],["type","email","name","correo",1,"form-control",3,"ngModel","ngModelChange"],["type","text","name","empresa",1,"form-control",3,"ngModel","ngModelChange"],["id","modalNuevoUsuario","tabindex","-1","aria-labelledby","modalNuevoUsuarioLabel","aria-hidden","true",1,"modal","fade"],[1,"modal-header","modal-header-degradado"],["id","modalNuevoUsuarioLabel",1,"modal-title"],["nuevoUsuarioForm","ngForm"],[1,"row"],[1,"col-4"],[1,"col-8"],[1,"row","g-2"],[1,"col-2"],["type","password","name","claveUsuario","required","",1,"form-control",3,"ngModel","ngModelChange"],[1,"col-1"],[1,"col-5"],["name","sucursalid","required","",1,"form-select",3,"ngModel","ngModelChange"],["type","text","name","empresaNombre","readonly","","placeholder","Seleccione una sucursal",1,"form-control",3,"ngModel","ngModelChange"],["type","password","name","claveCorreo",1,"form-control",3,"ngModel","ngModelChange"],["name","idtipoUsuario",1,"form-select",3,"ngModel","ngModelChange"],["type","number","name","idpermiso",1,"form-control",3,"ngModel","ngModelChange"],["class","mt-3",4,"ngIf"],["type","submit",1,"btn","btn-success",3,"disabled"],[1,"bi","bi-check2-circle","me-1"],["title","Consulta",1,"btn","btn-info","btn-sm","me-2",3,"click"],[1,"bi","bi-eye"],["title","Editar",1,"btn","btn-primary","btn-sm","me-2",3,"click"],[1,"bi","bi-pencil"],["title","Eliminar",1,"btn","btn-danger","btn-sm","me-2",3,"click"],[1,"bi","bi-trash"],["title","Permisos",1,"btn","btn-secondary","btn-sm",3,"click"],[1,"bi","bi-shield-lock"],["title","Eliminar",1,"btn","btn-danger","btn-sm",3,"click"],["data-bs-toggle","modal","data-bs-target","#permisoUsuarioFormModal","title","Editar",1,"btn","btn-primary","btn-sm","me-2",3,"click"],[1,"mt-3"],[1,"form-select",3,"ngModel","name","ngModelChange"]],template:function(r,i){if(1&r){const n=e.RV6();e.j41(0,"div",0)(1,"div",1)(2,"div",2),e.nrm(3,"i",3),e.j41(4,"h5",4),e.EFF(5,"Usuarios"),e.k0s()(),e.j41(6,"div",5)(7,"div",6)(8,"div",7)(9,"div",8)(10,"span",9),e.nrm(11,"i",10),e.k0s(),e.j41(12,"input",11),e.bIt("ngModelChange",function(t){return i.filtroUsuario=t}),e.k0s()()(),e.j41(13,"div",12)(14,"button",13),e.bIt("click",function(){return i.abrirNuevoUsuario()}),e.nrm(15,"i",14),e.EFF(16," Nuevo usuario "),e.k0s()()(),e.j41(17,"div",15)(18,"table",16)(19,"thead")(20,"tr")(21,"th"),e.EFF(22,"#"),e.k0s(),e.j41(23,"th"),e.EFF(24,"Usuario"),e.k0s(),e.j41(25,"th"),e.EFF(26,"Nombre"),e.k0s(),e.j41(27,"th"),e.EFF(28,"Nivel"),e.k0s(),e.j41(29,"th"),e.EFF(30,"Acciones"),e.k0s()()(),e.j41(31,"tbody"),e.DNE(32,T,18,4,"tr",17),e.k0s()()()()()(),e.j41(33,"div",18)(34,"div",19)(35,"div",20)(36,"div",21)(37,"h5",22),e.EFF(38,"Detalle del Usuario"),e.k0s(),e.nrm(39,"button",23),e.k0s(),e.j41(40,"div",24)(41,"div",25)(42,"strong"),e.EFF(43,"C\xf3digo:"),e.k0s(),e.EFF(44),e.k0s(),e.j41(45,"div",25)(46,"strong"),e.EFF(47,"Usuario:"),e.k0s(),e.EFF(48),e.k0s(),e.j41(49,"div",25)(50,"strong"),e.EFF(51,"Nombre:"),e.k0s(),e.EFF(52),e.k0s(),e.j41(53,"div",25)(54,"strong"),e.EFF(55,"Nivel:"),e.k0s(),e.EFF(56),e.k0s(),e.nrm(57,"hr"),e.j41(58,"div",26)(59,"h6",4),e.EFF(60,"Permisos"),e.k0s(),e.j41(61,"button",27),e.bIt("click",function(){return i.abrirNuevoPermiso()}),e.nrm(62,"i",28),e.EFF(63," Agregar permiso "),e.k0s()(),e.j41(64,"div",15)(65,"table",16)(66,"thead")(67,"tr")(68,"th"),e.EFF(69,"#"),e.k0s(),e.j41(70,"th"),e.EFF(71,"M\xf3dulo"),e.k0s(),e.j41(72,"th"),e.EFF(73,"Acceso"),e.k0s(),e.j41(74,"th"),e.EFF(75,"Lectura"),e.k0s(),e.j41(76,"th"),e.EFF(77,"Acciones"),e.k0s()()(),e.j41(78,"tbody"),e.DNE(79,N,12,4,"tr",17),e.k0s()()()(),e.j41(80,"div",29)(81,"button",30),e.EFF(82,"Cerrar"),e.k0s()()()()(),e.j41(83,"div",31)(84,"div",32)(85,"div",20)(86,"div",21)(87,"h5",33),e.EFF(88),e.k0s(),e.j41(89,"button",34),e.bIt("click",function(){return i.cerrarModalPermisosUsuario()}),e.k0s()(),e.j41(90,"div",24)(91,"div",15)(92,"table",16)(93,"thead")(94,"tr")(95,"th"),e.EFF(96,"#"),e.k0s(),e.j41(97,"th"),e.EFF(98,"M\xf3dulo"),e.k0s(),e.j41(99,"th"),e.EFF(100,"Acceso"),e.k0s(),e.j41(101,"th"),e.EFF(102,"Lectura"),e.k0s(),e.j41(103,"th"),e.EFF(104,"Acciones"),e.k0s()()(),e.j41(105,"tbody"),e.DNE(106,S,14,4,"tr",17),e.k0s()()()()()()(),e.j41(107,"div",35)(108,"div",19)(109,"div",20)(110,"div",21)(111,"h5",36),e.EFF(112),e.k0s(),e.nrm(113,"button",23),e.k0s(),e.j41(114,"form",37,38),e.bIt("ngSubmit",function(){e.eBV(n);const t=e.sdS(115);return e.Njj(i.guardarPermiso(t))}),e.j41(116,"div",24)(117,"div",39)(118,"label",40),e.EFF(119,"M\xf3dulo"),e.k0s(),e.j41(120,"select",41),e.bIt("ngModelChange",function(t){return i.actual.idmodulo=t}),e.j41(121,"option",42),e.EFF(122,"Seleccione un m\xf3dulo"),e.k0s(),e.DNE(123,R,2,2,"option",43),e.k0s()(),e.j41(124,"div",44)(125,"div",45)(126,"label",40),e.EFF(127,"Acceso"),e.k0s(),e.j41(128,"select",46),e.bIt("ngModelChange",function(t){return i.actual.acceso=t}),e.j41(129,"option",47),e.EFF(130,"S\xed"),e.k0s(),e.j41(131,"option",48),e.EFF(132,"No"),e.k0s()()(),e.j41(133,"div",45)(134,"label",40),e.EFF(135,"Lectura"),e.k0s(),e.j41(136,"select",49),e.bIt("ngModelChange",function(t){return i.actual.lectura=t}),e.j41(137,"option",47),e.EFF(138,"S\xed"),e.k0s(),e.j41(139,"option",48),e.EFF(140,"No"),e.k0s()()()()(),e.j41(141,"div",29)(142,"button",30),e.EFF(143,"Cancelar"),e.k0s(),e.j41(144,"button",50),e.nrm(145,"i",51),e.EFF(146),e.k0s()()()()()(),e.j41(147,"div",52)(148,"div",19)(149,"div",20)(150,"div",21)(151,"h5",53),e.EFF(152,"Editar usuario"),e.k0s(),e.nrm(153,"button",23),e.k0s(),e.j41(154,"form",37,54),e.bIt("ngSubmit",function(){e.eBV(n);const t=e.sdS(155);return e.Njj(i.guardarEdicionUsuario(t))}),e.j41(156,"div",24)(157,"div",39)(158,"label",40),e.EFF(159,"Usuario"),e.k0s(),e.j41(160,"input",55),e.bIt("ngModelChange",function(t){return i.editableUsuario.idUsuario=t}),e.k0s()(),e.j41(161,"div",39)(162,"label",40),e.EFF(163,"Nombre"),e.k0s(),e.j41(164,"input",56),e.bIt("ngModelChange",function(t){return i.editableUsuario.nombreUsuario=t}),e.k0s()(),e.j41(165,"div",39)(166,"label",40),e.EFF(167,"Clave"),e.k0s(),e.j41(168,"input",57),e.bIt("ngModelChange",function(t){return i.editableUsuario.claveUsuario=t}),e.k0s()(),e.j41(169,"div",44)(170,"div",45)(171,"label",40),e.EFF(172,"Nivel"),e.k0s(),e.j41(173,"input",58),e.bIt("ngModelChange",function(t){return i.editableUsuario.nivel=t}),e.k0s()(),e.j41(174,"div",45)(175,"label",40),e.EFF(176,"Sucursal"),e.k0s(),e.j41(177,"select",59),e.bIt("ngModelChange",function(t){return i.editableUsuario.sucursal=t}),e.j41(178,"option",42),e.EFF(179,"Seleccione una sucursal"),e.k0s(),e.DNE(180,y,2,3,"option",43),e.k0s()()(),e.j41(181,"div",60)(182,"div",45)(183,"label",40),e.EFF(184,"Correo"),e.k0s(),e.j41(185,"input",61),e.bIt("ngModelChange",function(t){return i.editableUsuario.correo=t}),e.k0s()(),e.j41(186,"div",45)(187,"label",40),e.EFF(188,"Empresa"),e.k0s(),e.j41(189,"input",62),e.bIt("ngModelChange",function(t){return i.editableUsuario.empresa=t}),e.k0s()()()(),e.j41(190,"div",29)(191,"button",30),e.EFF(192,"Cancelar"),e.k0s(),e.j41(193,"button",50),e.nrm(194,"i",51),e.EFF(195," Guardar "),e.k0s()()()()()(),e.j41(196,"div",63)(197,"div",32)(198,"div",20)(199,"div",64)(200,"h5",65),e.EFF(201,"Nuevo usuario"),e.k0s(),e.nrm(202,"button",23),e.k0s(),e.j41(203,"form",37,66),e.bIt("ngSubmit",function(){e.eBV(n);const t=e.sdS(204);return e.Njj(i.guardarNuevoUsuario(t))}),e.j41(205,"div",24)(206,"div",67)(207,"div",68)(208,"label",40),e.EFF(209,"Usuario"),e.k0s(),e.j41(210,"input",55),e.bIt("ngModelChange",function(t){return i.nuevoUsuario.idUsuario=t}),e.k0s()(),e.j41(211,"div",69)(212,"label",40),e.EFF(213,"Nombre"),e.k0s(),e.j41(214,"input",56),e.bIt("ngModelChange",function(t){return i.nuevoUsuario.nombreUsuario=t}),e.k0s()()(),e.j41(215,"div",70)(216,"div",71)(217,"label",40),e.EFF(218,"Clave"),e.k0s(),e.j41(219,"input",72),e.bIt("ngModelChange",function(t){return i.nuevoUsuario.claveUsuario=t}),e.k0s()(),e.j41(220,"div",73)(221,"label",40),e.EFF(222,"Nivel"),e.k0s(),e.j41(223,"input",58),e.bIt("ngModelChange",function(t){return i.nuevoUsuario.nivel=t}),e.k0s()(),e.j41(224,"div",74)(225,"label",40),e.EFF(226,"Sucursal (sucursalid)"),e.k0s(),e.j41(227,"select",75),e.bIt("ngModelChange",function(t){return i.nuevoUsuario.sucursalid=t})("ngModelChange",function(t){return i.onSucursalChange(t)}),e.j41(228,"option",42),e.EFF(229,"Seleccione una sucursal"),e.k0s(),e.DNE(230,P,2,3,"option",43),e.k0s()(),e.j41(231,"div",68)(232,"label",40),e.EFF(233,"Empresa"),e.k0s(),e.j41(234,"input",76),e.bIt("ngModelChange",function(t){return i.nuevoUsuario.empresa=t}),e.k0s()()(),e.j41(235,"div",60)(236,"div",45)(237,"label",40),e.EFF(238,"Correo"),e.k0s(),e.j41(239,"input",61),e.bIt("ngModelChange",function(t){return i.nuevoUsuario.correo=t}),e.k0s()(),e.j41(240,"div",45)(241,"label",40),e.EFF(242,"Clave de correo (claveCorreo)"),e.k0s(),e.j41(243,"input",77),e.bIt("ngModelChange",function(t){return i.nuevoUsuario.claveCorreo=t}),e.k0s()()(),e.j41(244,"div",60)(245,"div",45)(246,"label",40),e.EFF(247,"Tipo de usuario (idtipoUsuario)"),e.k0s(),e.j41(248,"select",78),e.bIt("ngModelChange",function(t){return i.nuevoUsuario.idtipoUsuario=t})("ngModelChange",function(t){return i.onTipoUsuarioChange(t)}),e.j41(249,"option",42),e.EFF(250,"Seleccione un tipo"),e.k0s(),e.DNE(251,G,2,2,"option",43),e.k0s()(),e.j41(252,"div",45)(253,"label",40),e.EFF(254,"ID Permiso (idpermiso)"),e.k0s(),e.j41(255,"input",79),e.bIt("ngModelChange",function(t){return i.nuevoUsuario.idpermiso=t}),e.k0s()()(),e.DNE(256,w,15,1,"div",80),e.k0s(),e.j41(257,"div",29)(258,"button",30),e.EFF(259,"Cancelar"),e.k0s(),e.j41(260,"button",81),e.nrm(261,"i",82),e.EFF(262," Crear "),e.k0s()()()()()()}if(2&r){const n=e.sdS(115),s=e.sdS(155),t=e.sdS(204);e.R7$(12),e.Y8G("ngModel",i.filtroUsuario),e.R7$(20),e.Y8G("ngForOf",i.usuariosFiltrados),e.R7$(12),e.SpI(" ",null==i.selectedUsuario?null:i.selectedUsuario.codUsuario,""),e.R7$(4),e.SpI(" ",null==i.selectedUsuario?null:i.selectedUsuario.idUsuario,""),e.R7$(4),e.SpI(" ",null==i.selectedUsuario?null:i.selectedUsuario.nombreUsuario,""),e.R7$(4),e.SpI(" ",null==i.selectedUsuario?null:i.selectedUsuario.nivel,""),e.R7$(23),e.Y8G("ngForOf",i.permisos),e.R7$(9),e.Lme(" Permisos de ",null==i.selectedUsuario?null:i.selectedUsuario.nombreUsuario," (",null==i.selectedUsuario?null:i.selectedUsuario.idUsuario,") "),e.R7$(18),e.Y8G("ngForOf",i.permisos),e.R7$(6),e.JRh(i.editIndex>=0?"Editar permiso":"Nuevo permiso"),e.R7$(8),e.Y8G("ngModel",i.actual.idmodulo),e.R7$(1),e.Y8G("ngValue",void 0),e.R7$(2),e.Y8G("ngForOf",i.modulos),e.R7$(5),e.Y8G("ngModel",i.actual.acceso),e.R7$(8),e.Y8G("ngModel",i.actual.lectura),e.R7$(8),e.Y8G("disabled",!n.valid),e.R7$(2),e.SpI(" ",i.editIndex>=0?"Guardar cambios":"Agregar"," "),e.R7$(14),e.Y8G("ngModel",i.editableUsuario.idUsuario),e.R7$(4),e.Y8G("ngModel",i.editableUsuario.nombreUsuario),e.R7$(4),e.Y8G("ngModel",i.editableUsuario.claveUsuario),e.R7$(5),e.Y8G("ngModel",i.editableUsuario.nivel),e.R7$(4),e.Y8G("ngModel",i.editableUsuario.sucursal),e.R7$(1),e.Y8G("ngValue",void 0),e.R7$(2),e.Y8G("ngForOf",i.sucursales),e.R7$(5),e.Y8G("ngModel",i.editableUsuario.correo),e.R7$(4),e.Y8G("ngModel",i.editableUsuario.empresa),e.R7$(4),e.Y8G("disabled",!s.valid),e.R7$(17),e.Y8G("ngModel",i.nuevoUsuario.idUsuario),e.R7$(4),e.Y8G("ngModel",i.nuevoUsuario.nombreUsuario),e.R7$(5),e.Y8G("ngModel",i.nuevoUsuario.claveUsuario),e.R7$(4),e.Y8G("ngModel",i.nuevoUsuario.nivel),e.R7$(4),e.Y8G("ngModel",i.nuevoUsuario.sucursalid),e.R7$(1),e.Y8G("ngValue",void 0),e.R7$(2),e.Y8G("ngForOf",i.sucursales),e.R7$(4),e.Y8G("ngModel",i.nuevoUsuario.empresa),e.R7$(5),e.Y8G("ngModel",i.nuevoUsuario.correo),e.R7$(4),e.Y8G("ngModel",i.nuevoUsuario.claveCorreo),e.R7$(5),e.Y8G("ngModel",i.nuevoUsuario.idtipoUsuario),e.R7$(1),e.Y8G("ngValue",void 0),e.R7$(2),e.Y8G("ngForOf",i.tipousuarios),e.R7$(4),e.Y8G("ngModel",i.nuevoUsuario.idpermiso),e.R7$(1),e.Y8G("ngIf",null==i.detallesTipoSeleccionado?null:i.detallesTipoSeleccionado.length),e.R7$(4),e.Y8G("disabled",!t.valid)}},dependencies:[b.Sq,b.bT,d.qT,d.xH,d.y7,d.me,d.Q0,d.wz,d.BC,d.cb,d.YS,d.vS,d.cV],styles:[".table-responsive[_ngcontent-%COMP%]{max-height:60vh}.modal[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]{margin-bottom:0}.modal-header-degradado[_ngcontent-%COMP%]{background:linear-gradient(45deg,#0066ff,#ff0000);color:#fff;border-top-left-radius:10px;border-top-right-radius:10px}.modal-modern[_ngcontent-%COMP%]{border-radius:14px;overflow:hidden;box-shadow:0 8px 20px #00000040;border:none}.modal-header-degradado[_ngcontent-%COMP%]{background:linear-gradient(90deg,#0066ff,#ff0000);color:#fff;padding:15px 20px;border-bottom:none}.modal-header-degradado[_ngcontent-%COMP%]   .modal-title[_ngcontent-%COMP%]{font-weight:600;font-size:1.15rem}.btn-close-white[_ngcontent-%COMP%]{filter:invert(1)}.modal-modern[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]{background:#f8f9fa;padding:20px}.modal-modern[_ngcontent-%COMP%]   .modal-footer[_ngcontent-%COMP%]{background:#f1f1f1;border-top:none;padding:15px 20px}.modal-modern[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%], .modal-modern[_ngcontent-%COMP%]   .form-select[_ngcontent-%COMP%]{border-radius:8px;box-shadow:none;border:1px solid #d0d0d0}.modal-modern[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]:focus, .modal-modern[_ngcontent-%COMP%]   .form-select[_ngcontent-%COMP%]:focus{border-color:#06f;box-shadow:0 0 0 .15rem #0066ff40}.modal-modern[_ngcontent-%COMP%]   .btn-success[_ngcontent-%COMP%]{border-radius:8px;font-weight:600}"]})}}return a})()}];let L=(()=>{class a{static{this.\u0275fac=function(r){return new(r||a)}}static{this.\u0275mod=e.$C({type:a})}static{this.\u0275inj=e.G2t({imports:[U.iI.forChild(Y),U.iI]})}}return a})(),O=(()=>{class a{static{this.\u0275fac=function(r){return new(r||a)}}static{this.\u0275mod=e.$C({type:a})}static{this.\u0275inj=e.G2t({imports:[b.MD,L,d.X1,d.YN]})}}return a})()}}]);