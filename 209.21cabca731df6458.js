"use strict";(self.webpackChunkSaltorSystem=self.webpackChunkSaltorSystem||[]).push([[209],{6209:(gt,S,d)=>{d.r(S),d.d(S,{ModuloControlFact:()=>ft});var u=d(9417),F=d(177),N=d(8871),k=d(4412),x=d(152),C=d(3294),I=d(5558),j=d(8141),w=d(5964),V=d(8032),m=d.n(V),P=d(5378),A=d(4941),B=d.n(A),t=d(8699),Y=d(1757),z=d(3290),U=d(9287),O=d(9743),L=d(6687),X=d(8747),J=d(333),K=d(1919),W=d(151);const Z=["codigoInput"],H=["descripcionInput"],Q=["Tabladetalle"],q=["cantidadInput"],tt=["buscarcodmercInput"];function et(c,h){if(1&c&&(t.j41(0,"option",116),t.EFF(1),t.k0s()),2&c){const e=h.$implicit;t.Y8G("value",e.codNcf),t.R7$(1),t.SpI(" ",e.desNcf," ")}}function ot(c,h){if(1&c){const e=t.RV6();t.j41(0,"div",117)(1,"a",118),t.bIt("click",function(){const r=t.eBV(e).$implicit,s=t.XpG();return t.Njj(s.cargarDatosCliente(r))}),t.nrm(2,"i",119),t.EFF(3),t.k0s()()}if(2&c){const e=h.$implicit,i=h.index,o=t.XpG();t.AVh("active",i===o.selectedIndex),t.R7$(3),t.SpI("\xa0\xa0",e.cl_nomClie," ")}}function it(c,h){if(1&c&&(t.j41(0,"option",116),t.EFF(1),t.k0s()),2&c){const e=h.$implicit;t.Y8G("value",e.fp_codfpago),t.R7$(1),t.SpI(" ",e.fp_descfpago," ")}}const at=function(c){return{"table-primary":c}};function rt(c,h){if(1&c){const e=t.RV6();t.j41(0,"tr",120)(1,"td",121),t.bIt("click",function(){const r=t.eBV(e).$implicit,s=t.XpG();return t.Njj(s.consultarFacturacion(r))}),t.EFF(2),t.k0s(),t.j41(3,"td"),t.EFF(4),t.k0s(),t.j41(5,"td",122),t.EFF(6),t.k0s(),t.j41(7,"td",123),t.EFF(8),t.k0s(),t.j41(9,"td")(10,"i",124),t.bIt("click",function(){const r=t.eBV(e).$implicit,s=t.XpG();return t.Njj(s.consultarFacturacion(r))}),t.k0s()()()}if(2&c){const e=h.$implicit,i=t.XpG();t.Y8G("ngClass",t.eq3(5,at,e.fa_codFact===i.codFacturaselecte)),t.R7$(2),t.SpI(" ",e.fa_codFact," "),t.R7$(2),t.JRh(e.fa_nomClie),t.R7$(2),t.JRh(e.fa_fecFact),t.R7$(2),t.JRh(e.fa_valFact)}}function st(c,h){if(1&c){const e=t.RV6();t.j41(0,"div",117)(1,"a",118),t.bIt("click",function(){const r=t.eBV(e).$implicit,s=t.XpG();return t.Njj(s.cargarDatosInventario(r))}),t.nrm(2,"i",119),t.EFF(3),t.k0s()()}if(2&c){const e=h.$implicit,i=h.index,o=t.XpG();t.AVh("active",i===o.selectedIndexcodmerc),t.R7$(3),t.SpI("\xa0\xa0",e.in_codmerc," ")}}function ct(c,h){if(1&c){const e=t.RV6();t.j41(0,"div",117)(1,"a",118),t.bIt("click",function(){const r=t.eBV(e).$implicit,s=t.XpG();return t.Njj(s.cargarDatosInventario(r))}),t.nrm(2,"i",119),t.EFF(3),t.k0s()()}if(2&c){const e=h.$implicit,i=h.index,o=t.XpG();t.AVh("active",i===o.selectedIndexdescripcionmerc),t.R7$(3),t.SpI("\xa0\xa0",e.in_desmerc," ")}}function nt(c,h){if(1&c){const e=t.RV6();t.j41(0,"i",130),t.bIt("click",function(){t.eBV(e);const o=t.XpG().$implicit,r=t.XpG();return t.Njj(r.editarItem(o))}),t.k0s()}}function lt(c,h){if(1&c){const e=t.RV6();t.j41(0,"i",131),t.bIt("click",function(){t.eBV(e);const o=t.XpG().$implicit,r=t.XpG();return t.Njj(r.borarItem(o))}),t.k0s()}}function dt(c,h){if(1&c){const e=t.RV6();t.j41(0,"tr",121),t.bIt("click",function(){const r=t.eBV(e).index,s=t.XpG();return t.Njj(s.selectRow(r))}),t.j41(1,"td",101),t.EFF(2),t.k0s(),t.j41(3,"td",102),t.EFF(4),t.k0s(),t.j41(5,"td",125),t.EFF(6),t.k0s(),t.j41(7,"td",126),t.EFF(8),t.k0s(),t.j41(9,"td",127),t.EFF(10),t.nI1(11,"currency"),t.k0s(),t.j41(12,"td"),t.DNE(13,nt,1,0,"i",128),t.DNE(14,lt,1,0,"i",129),t.k0s()()}if(2&c){const e=h.$implicit,i=h.index,o=t.XpG();t.AVh("table-active",i===o.selectedRow),t.R7$(2),t.JRh(null==e.producto?null:e.producto.in_codmerc),t.R7$(2),t.JRh(null==e.producto?null:e.producto.in_desmerc),t.R7$(2),t.SpI(" ",e.cantidad," "),t.R7$(2),t.SpI(" ",e.precio," "),t.R7$(2),t.SpI(" ",t.bMT(11,9,e.total)," "),t.R7$(3),t.Y8G("ngIf",o.habilitarIcono),t.R7$(1),t.Y8G("ngIf",o.habilitarIcono)}}const T=function(c){return{show:c}},R=function(c){return{color:c}},ut=[{path:"",component:(()=>{class c{get totalPages(){return Math.ceil(this.facturacionList.length/this.pageSize)}get paginatedData(){const e=(this.currentPage-1)*this.pageSize;return this.facturacionList.slice(e,e+this.pageSize)}constructor(e,i,o,r,s,a,l,n,_,b){this.fb=e,this.servicioFacturacion=i,this.servicioCliente=o,this.http=r,this.ServicioInventario=s,this.ServicioUsuario=a,this.ServicioRnc=l,this.ServicioSector=n,this.servicioFpago=_,this.servicioNcf=b,this.botonEditar=!0,this.botonGuardar=!0,this.botonaddItems=!0,this.totalItems=0,this.pageSize=6,this.currentPage=1,this.maxPagesToShow=5,this.txtdescripcion="",this.txtcodigo="",this.codFacturaselecte=" ",this.codMercselecte=" ",this.descripcion="",this.codigo="",this.fecha="",this.descripcionBuscar=new k.t(""),this.codigoBuscar=new k.t(""),this.fechaBuscar=new k.t(""),this.habilitarFormulario=!1,this.modoedicionFacturacion=!1,this.modoconsultaFacturacion=!1,this.facturacionList=[],this.detFacturaList=[],this.selectedFacturacion=null,this.items=[],this.ncflist=[],this.selectedItem=null,this.totalGral=0,this.totalItbis=0,this.totalcosto=0,this.costoGral=0,this.subTotal=0,this.subtotaltxt="",this.itbitxt="",this.totalgraltxt="",this.txtFactura="",this.txtFecha="",this.txtNombre="",this.descuentotxt="",this.tiponcf="Consumidor Final",this.codmerc="",this.descripcionmerc="",this.cantidadmerc=0,this.preciomerc=0,this.precioform=new u.MJ,this.cantidadform=new u.MJ,this.isEditing=!1,this.itemToEdit=null,this.codnotfound=!1,this.desnotfound=!1,this.mensagePantalla=!1,this.codmerVacio=!1,this.desmerVacio=!1,this.habilitarCampos=!1,this.habilitarCantidad=!1,this.sucursales=[],this.sucursalSeleccionada=null,this.habilitarIcono=!0,this.rncValue="",this.cancelarBusquedaDescripcion=!1,this.cancelarBusquedaCodigo=!1,this.numfacturaSubject=new k.t(""),this.nomclienteSubject=new k.t(""),this.selectedRow=0,this.isDisabled=!0,this.buscarNombre=new u.MJ,this.resultadoNombre=[],this.resultadoSector=[],this.resultadoFpago=[],this.buscarSector=new u.MJ,this.buscarFpago=new u.MJ,this.selectedIndex=1,this.selectedIndexsector=1,this.buscarcodmerc=new u.MJ,this.buscardescripcionmerc=new u.MJ,this.nativeElement=new u.MJ,this.resultadoCodmerc=[],this.selectedIndexcodmerc=1,this.selectedIndexfpago=1,this.resultadodescripcionmerc=[],this.selectedIndexdescripcionmerc=1,this.form=this.fb.group({fa_codVend:["",u.k0.required]}),this.crearFormularioFacturacion(),this.nomclienteSubject.pipe((0,x.B)(500),(0,C.F)(),(0,I.n)(f=>(this.txtdescripcion=f,this.servicioFacturacion.buscarFacturacion(this.currentPage,this.facturacionList.length,this.codigo,this.txtdescripcion)))).subscribe(f=>{this.facturacionList=f.data,this.totalItems=f.pagination.total,this.currentPage=f.pagination.page}),this.numfacturaSubject.pipe((0,x.B)(500),(0,C.F)(),(0,I.n)(f=>(this.txtFactura=f,this.servicioFacturacion.buscarFacturacion(this.currentPage,this.facturacionList.length,this.codigo,this.txtdescripcion,this.txtFactura)))).subscribe(f=>{this.facturacionList=f.data,this.totalItems=f.pagination.total,this.currentPage=f.pagination.page})}seleccionarFacturacion(e){this.selectedFacturacion=e}ngOnInit(){this.buscarTodasFacturacion(),this.obtenerNcf(),this.obtenerfpago(),this.buscardescripcionmerc.valueChanges.pipe((0,x.B)(50),(0,C.F)(),(0,j.M)(()=>{this.resultadodescripcionmerc=[]}),(0,w.p)(e=>""!==e&&!this.cancelarBusquedaDescripcion&&!this.isEditing),(0,I.n)(e=>this.http.GetRequest(`/productos-buscador-desc/${e}`))).subscribe(e=>{console.log(e.data),e?Array.isArray(e.data)&&e.data.length?(this.resultadodescripcionmerc=e.data,this.desnotfound=!1):this.desnotfound=!0:(this.resultadodescripcionmerc=[],this.desnotfound=!1)}),this.buscarNombre.valueChanges.pipe(function D(c){return(0,w.p)((h,e)=>c<=e)}(1),(0,x.B)(500),(0,C.F)(),(0,w.p)(e=>!!e&&""!==e.trim()),(0,j.M)(()=>{this.facturacionList=[],console.log("sdasdsa ")}),(0,I.n)(e=>this.http.GetRequest(`/facturacion-numero?page=0&limit=0/&nomcliente=${e}`))).subscribe(e=>{console.log(e),this.facturacionList=Array.isArray(e)?e:[]}),this.buscarSector.valueChanges.pipe((0,x.B)(500),(0,C.F)(),(0,j.M)(()=>{this.resultadoSector=[]}),(0,w.p)(e=>""!==e),(0,I.n)(e=>this.http.GetRequest(`/sector-nombre/${e}`))).subscribe(e=>{console.log(e.data),e?Array.isArray(e.data)&&(this.resultadoSector=e.data):this.resultadoSector=[]})}obtenerfpago(){this.servicioFpago.obtenerTodosFpago().subscribe(e=>{this.resultadoFpago=e.data})}obtenerNcf(){this.servicioNcf.buscarTodosNcf().subscribe(e=>{this.ncflist=e.data})}crearFormularioFacturacion(){const i=this.formatofecha(new Date);this.formularioFacturacion=this.fb.group({fa_codFact:[{value:"",disabled:!0}],fa_fecFact:[{value:i,disabled:!0}],fa_valFact:[""],fa_subFact:[""],fa_itbiFact:[""],fa_codClie:[""],fa_cosFact:[""],fa_nomClie:[{value:"",disabled:!0}],fa_rncFact:[{value:"",disabled:!0}],fa_telClie:[{value:"",disabled:!0}],fa_telClie2:[{value:"",disabled:!0}],fa_dirClie:[{value:"",disabled:!0}],fa_correo:[{value:"",disabled:!0}],fa_codVend:[{value:"",disabled:!0}],fa_nomVend:[{value:"",disabled:!0}],fa_status:[""],fa_sector:[{value:"",disabled:!0}],fa_codZona:[null],fa_desZona:[""],fa_fpago:[{value:"",disabled:!0}],fa_codfpago:["1"],fa_envio:[{value:"",disabled:!0}],fa_ncfFact:[{value:"",disabled:!0}],fa_tipoNcf:[{value:"",disabled:!0}],fa_contacto:[{value:"",disabled:!0}],fa_despacho:[{value:"",disabled:!0}],fa_reimpresa:[{value:"",disabled:!0}],fa_entrega:[{value:"",disabled:!0}],fa_impresa:[{value:"",disabled:!0}],fa_facturada:[{value:"",disabled:!0}]})}limpia(){this.crearFormularioFacturacion(),this.txtdescripcion="",this.txtFactura="",this.txtFecha="",this.botonEditar=!0,this.botonGuardar=!0,this.botonaddItems=!0,this.codmerc="",this.descripcionmerc="",this.preciomerc=0,this.cantidadmerc=0,this.isEditing=!1,this.items=[],this.totalGral=0,this.totalItbis=0,this.subTotal=0,this.totalcosto=0,this.costoGral=0,this.factxt=0,this.habilitarCampos=!1,this.habilitarCantidad=!1,this.ngOnInit(),this.actualizarTotales(),$("#input1").focus(),$("#input1").select()}editardetFacturacion(e){this.facturacionid=e.df_codFact}editarFacturacion(e){this.facturacionid=e.fa_codFact,this.modoedicionFacturacion=!0,this.formularioFacturacion.patchValue(e),this.tituloModalFacturacion="Editando Facturacion",$("#modalfacturacion").modal("show"),this.habilitarFormulario=!0,document.querySelectorAll(".seccion-productos input").forEach(o=>{o.disabled=!0}),this.items=[],this.servicioFacturacion.buscarFacturaDetalle(e.fa_codFact).subscribe(o=>{let r=0,a=0;o.data.forEach(n=>{const b=n.df_canMerc,f=n.df_preMerc,v=b*f;this.items.push({producto:{in_codmerc:n.df_codMerc,in_desmerc:n.df_desMerc,in_grumerc:"",in_tipoproduct:"",in_canmerc:0,in_caninve:0,in_fecinve:null,in_eximini:0,in_cosmerc:0,in_premerc:0,in_precmin:0,in_ucosto:0,in_porgana:0,in_peso:0,in_longitud:0,in_unidad:0,in_medida:0,in_longitu:0,in_fecmodif:null,in_amacen:0,in_imagen:"",in_status:"",in_itbis:!1,in_minvent:0},cantidad:b,precio:f,total:v,fecfactActual:new Date,costo:this.costotxt}),r+=v,this.totalItbis+=.18*v}),a=r+this.totalItbis,this.subTotal=r,this.totalItbis=this.totalItbis,this.totalGral=a})}buscarTodasFactura(e){this.servicioFacturacion.buscarTodasFacturacion().subscribe(i=>{console.log(i),this.facturacionList=i.data,console.log(this.facturacionList.length)})}consultarFacturacion(e){this.modoconsultaFacturacion=!0,this.formularioFacturacion.reset(),this.crearFormularioFacturacion(),this.formularioFacturacion.patchValue(e),this.tituloModalFacturacion="Consulta Factura",this.habilitarFormulario=!0,this.formularioFacturacion.disable(),this.codFacturaselecte=e.fa_codFact,console.log("ff",e),this.habilitarIcono=!1,this.botonEditar=!1,this.botonGuardar=!0,this.botonaddItems=!0,document.querySelectorAll(".seccion-productos input").forEach(o=>{o.disabled=!0}),this.totalItbis=0,this.items=[],this.servicioFacturacion.buscarFacturaDetalle(e.fa_codFact).subscribe(o=>{let r=0,a=0;o.data.forEach(_=>{const f=_.df_canMerc,v=_.df_preMerc,y=f*v,g=_.df_cosMerc;this.items.push({producto:{in_codmerc:_.df_codMerc,in_desmerc:_.df_desMerc,in_grumerc:"",in_tipoproduct:"",in_canmerc:0,in_caninve:0,in_fecinve:null,in_eximini:0,in_cosmerc:0,in_premerc:0,in_precmin:0,in_ucosto:0,in_porgana:0,in_peso:0,in_longitud:0,in_unidad:0,in_medida:0,in_longitu:0,in_fecmodif:null,in_amacen:0,in_imagen:"",in_status:"",in_itbis:!1,in_minvent:0},cantidad:f,precio:v,total:y,costo:g,fecfactActual:new Date}),r+=g,this.totalItbis+=.18*y}),a=r+this.totalItbis,this.subTotal=r,this.totalItbis=this.totalItbis,this.totalGral=a,this.factxt=100*(e.fa_valFact-e.fa_cosFact)/e.fa_cosFact,this.actualizarTotales(),console.log(e.fa_valFact),console.log(e.fa_cosFact),console.log(this.factxt)})}eliminarFacturacion(e){m().fire({title:"\xbfEst\xe1 seguro de eliminar este Facturacion?",text:"\xa1No podr\xe1 revertir esto!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Si, eliminar!"}).then(i=>{i.isConfirmed&&this.servicioFacturacion.eliminarFacturacion(e).subscribe(o=>{m().fire({title:"Excelente!",text:"Factura eliminada correctamente.",icon:"success",timer:2e3,showConfirmButton:!1}),this.buscarTodasFacturacion()})})}editarFactura(){console.log("Modo edici\xf3n activado"),this.botonEditar=!0,this.botonGuardar=!1,this.botonaddItems=!1,this.habilitarIcono=!0,this.formularioFacturacion.enable(),this.formularioFacturacion.get("fa_codFact")?.disable(),this.formularioFacturacion.get("fa_fecFact")?.disable(),this.formularioFacturacion.get("fa_ncfFact")?.disable(),this.formularioFacturacion.get("fa_codVend")?.disable(),this.formularioFacturacion.get("fa_nomVend")?.disable(),this.formularioFacturacion.get("fa_entrega")?.disable(),this.formularioFacturacion.get("fa_impresa")?.disable(),this.formularioFacturacion.get("fa_facturada")?.disable()}formatofecha(e){const i=e.getFullYear(),o=(e.getMonth()+1).toString().padStart(2,"0");return`${e.getDate().toString().padStart(2,"0")}/${o}/${i}`}crearformulariodetFactura(){this.formulariodetFactura=this.fb.group({df_codFact:[""],df_fecFact:[""],df_codMerc:[""],df_desMerc:[""],df_canMerc:[""],df_preMerc:[""],df_valMerc:[""],df_unidad:[""],df_cosMerc:[""],df_codClie:[""],df_status:[""]})}buscarTodasFacturacion(){this.servicioFacturacion.buscarTodasFacturacion().subscribe(e=>{this.facturacionList=e.data})}buscaNombre(e){this.nomclienteSubject.next(e.target.value.toUpperCase())}buscaFactura(e){this.servicioFacturacion.buscarFacturacion(0,0,e.target.value).subscribe(o=>{this.facturacionList=o.data})}buscaFecha(e){this.servicioFacturacion.buscarFacturacion(0,0,"","",e.target.value).subscribe(r=>{this.facturacionList=r.data})}convertToUpperCase(e){const i=e.target,o=i.selectionStart,r=i.selectionEnd;i.value=i.value.toUpperCase(),null!==o&&null!==r&&i.setSelectionRange(o,r)}moveFocus(e,i){"Enter"===e.key&&i&&(e.preventDefault(),i.focus())}moveFocuscodmerc(e,i){if(console.log("move focus"),"Enter"===e.key||"Tab"===e.key){if(e.preventDefault(),""===e.target.value.trim()?(this.codmerVacio=!0,console.log("vacio")):this.codmerVacio=!1,this.codnotfound)return console.log(this.codnotfound),this.mensagePantalla=!0,m().fire({icon:"error",title:"A V I S O",text:"Codigo invalido.",focusConfirm:!0,allowEnterKey:!0}).then(()=>{this.mensagePantalla=!1}),this.codmerVacio=!1,this.codnotfound=!1,this.codmerc="",void(this.descripcionmerc="");!0===this.codmerVacio?(i.focus(),this.codmerVacio=!1,console.log("vedadero")):($("#input8").focus(),$("#input8").select()),this.codmerVacio=!1}}handleKeydownInventario(e){console.log("handle");const i=e.key,o=this.resultadoCodmerc.length-1;1===this.resultadoCodmerc.length&&(this.selectedIndexcodmerc=0,console.log("prueba")),"ArrowDown"===i?(this.selectedIndexcodmerc=this.selectedIndexcodmerc<o?this.selectedIndexcodmerc+1:0,e.preventDefault()):"ArrowUp"===i?(this.selectedIndexcodmerc=this.selectedIndexcodmerc>0?this.selectedIndexcodmerc-1:o,e.preventDefault()):"Enter"===i&&(this.selectedIndexcodmerc>=0&&this.selectedIndexcodmerc<=o&&this.cargarDatosInventario(this.resultadoCodmerc[this.selectedIndexcodmerc]),e.preventDefault())}cargarDatosInventario(e){console.log(e),this.resultadoCodmerc=[],this.resultadodescripcionmerc=[],this.codmerc=e.in_codmerc,this.preciomerc=e.in_premerc,this.descripcionmerc=e.in_desmerc,this.existenciatxt=e.in_canmerc,this.costotxt=e.in_cosmerc,this.medidatxt=e.in_medida,this.fecacttxt=e.in_fecmodif,this.atxt=Number(e.in_cosmerc)+5*Number(e.in_cosmerc)/100,this.btxt=Number(e.in_cosmerc)+7*Number(e.in_cosmerc)/100,this.ctxt=Number(e.in_cosmerc)+10*Number(e.in_cosmerc)/100,this.dtxt=Number(e.in_cosmerc)+12*Number(e.in_cosmerc)/100,this.etxt=Number(e.in_cosmerc)+14*Number(e.in_cosmerc)/100,this.ftxt=Number(e.in_cosmerc)+16*Number(e.in_cosmerc)/100,this.gtxt=Number(e.in_cosmerc)+18*Number(e.in_cosmerc)/100,this.productoselect=e,this.cancelarBusquedaDescripcion=!0,this.cancelarBusquedaCodigo=!0,this.formularioFacturacion.patchValue({df_codMerc:e.in_codmerc,df_desMerc:e.in_desmerc,df_canMerc:e.in_canmerc,df_preMerc:e.in_premerc,df_cosMerc:e.in_cosmerc,df_unidad:e.in_unidad}),$("#input8").focus(),$("#input8").select()}buscarUsuario(e,i){e.preventDefault();const o=this.formularioFacturacion.get("fa_codVend")?.value;if(!o)return this.mensagePantalla=!0,void m().fire({icon:"error",title:"A V I S O",text:"Codigo de usuario invalido."}).then(()=>{this.mensagePantalla=!1});this.ServicioUsuario.buscarUsuarioPorClave(o).subscribe(r=>{if(!r.data.length)return this.mensagePantalla=!0,void m().fire({icon:"error",title:"A V I S O",text:"Codigo de usuario invalido."}).then(()=>{this.mensagePantalla=!1});this.formularioFacturacion.patchValue({fa_nomVend:r.data[0].idUsuario}),i?.focus()})}buscarRnc(e,i){e.preventDefault();const o=this.formularioFacturacion.get("fa_rncFact")?.value;return o?9!==o.length&&11!==o.length?(this.mostrarMensajeError("RNC inv\xe1lido."),void console.log(o.length)):void this.ServicioRnc.buscarRncPorId(o).subscribe(r=>{if(r?.data?.length){const s=r.data[0]?.rason;this.formularioFacturacion.patchValue({fa_nomClie:s}),this.formularioFacturacion.patchValue({fa_tipoNcf:2}),this.formularioFacturacion.get("fa_tipoNcf")?.enable(),this.ncflist=this.ncflist.filter(a=>1!==a.codNcf),$("#input3").focus(),$("#input3").select()}else this.mostrarMensajeError("RNC inv\xe1lido."),console.log("RNC no encontrado.")}):(this.obtenerNcf(),this.formularioFacturacion.patchValue({fa_tipoNcf:1}),this.formularioFacturacion.get("fa_tipoNcf")?.disable(),console.log("RNC vac\xedo."),console.log(this.formularioFacturacion.value),void i?.focus())}mostrarMensajeError(e){this.mensagePantalla=!0,m().fire({icon:"error",title:"A V I S O",text:e}).then(()=>{this.mensagePantalla=!1})}handleKeydown(e){const i=e.key,o=this.resultadoNombre.length-1;1===this.resultadoNombre.length&&(this.selectedIndex=0,console.log("prueba")),"ArrowDown"===i?(this.selectedIndex<o?this.selectedIndex++:this.selectedIndex=0,e.preventDefault()):"ArrowUp"===i?(console.log("paso 677"),this.selectedIndex>0?this.selectedIndex--:this.selectedIndex=o,e.preventDefault()):"Enter"===i&&(this.selectedIndex>=0&&this.selectedIndex<=o&&this.cargarDatosCliente(this.resultadoNombre[this.selectedIndex]),e.preventDefault())}handleKeydownSector(e){const i=e.key,o=this.resultadoSector.length-1;1===this.resultadoSector.length&&(this.selectedIndexsector=0,console.log("prueba")),"ArrowDown"===i?(this.selectedIndexsector<o?this.selectedIndex++:this.selectedIndexsector=0,e.preventDefault()):"ArrowUp"===i?(console.log("paso 677"),this.selectedIndexsector>0?this.selectedIndex--:this.selectedIndexsector=o,e.preventDefault()):"Enter"===i&&(this.selectedIndexsector>=0&&this.selectedIndexsector<=o&&this.cargarDatosSector(this.resultadoSector[this.selectedIndexsector]),e.preventDefault())}handleKeydownFpago(e){const i=e.key,o=this.resultadoFpago.length-1;1===this.resultadoFpago.length&&(this.selectedIndexfpago=0,console.log("prueba")),"ArrowDown"===i?(this.selectedIndexfpago<o?this.selectedIndexfpago++:this.selectedIndexfpago=0,e.preventDefault()):"ArrowUp"===i?(this.selectedIndexfpago>0?this.selectedIndexfpago--:this.selectedIndexfpago=o,e.preventDefault()):"Enter"===i&&(this.selectedIndex>=0&&this.selectedIndexfpago<=o&&this.cargarDatosFpago(this.resultadoFpago[this.selectedIndexfpago]),e.preventDefault())}handleKeydownInventariosdesc(e){const i=e.key,o=this.resultadodescripcionmerc.length;1===this.resultadodescripcionmerc.length&&(this.selectedIndexdescripcionmerc=0,console.log("prueba")),"ArrowDown"===i?(this.selectedIndexdescripcionmerc=this.selectedIndexdescripcionmerc<o?this.selectedIndexdescripcionmerc+1:0,e.preventDefault()):"ArrowUp"===i?(this.selectedIndexdescripcionmerc=this.selectedIndexdescripcionmerc>0?this.selectedIndexdescripcionmerc-1:o,e.preventDefault()):"Enter"===i&&(this.selectedIndexdescripcionmerc>=0&&this.selectedIndexdescripcionmerc<=o&&this.cargarDatosInventario(this.resultadodescripcionmerc[this.selectedIndexdescripcionmerc]),e.preventDefault())}moveFocusdesc(e,i){if("Enter"===e.key||"Tab"===e.key){if(e.preventDefault(),""===e.target.value.trim()&&(this.desmerVacio=!0),this.desnotfound)return this.mensagePantalla=!0,m().fire({icon:"error",title:"A V I S O",text:"Codigo invalido."}).then(()=>{this.mensagePantalla=!1}),void(this.desnotfound=!0);if(!0===this.desmerVacio)return this.mensagePantalla=!0,m().fire({icon:"error",title:"A V I S O",text:"Codigo invalido."}).then(()=>{this.mensagePantalla=!1}),void(this.desnotfound=!0);$("#input8").focus(),$("#input8").select(),this.desmerVacio=!1}}moveFocusCantidad(e,i){if("Enter"===e.key||"Tab"===e.key){if(e.preventDefault(),!this.productoselect||this.cantidadmerc<=0)return this.mensagePantalla=!0,void m().fire({icon:"error",title:"A V I S O",text:"Por favor complete todos los campos requeridos antes de agregar el \xedtem."}).then(()=>{this.mensagePantalla=!1});$("#input9").focus(),$("#input9").select()}}moveFocusPrecio(e,i){if("Enter"===e.key||"Tab"===e.key){if(e.preventDefault(),!this.productoselect||this.preciomerc<=0||this.preciomerc<=this.productoselect.in_cosmerc)return this.mensagePantalla=!0,void m().fire({icon:"error",title:"A V I S O",text:"Por favor complete todos los campos requeridos antes de agregar el \xedtem."}).then(()=>{this.mensagePantalla=!1});$("#input13").focus(),$("#input13").select()}}moveFocusnomclie(e,i){e.preventDefault(),console.log(i),e.target instanceof HTMLInputElement&&(e.target.value?i.focus():(this.mensagePantalla=!0,m().fire({icon:"error",title:"A V I S O",text:"Por favor complete el campo Nombre del Cliente Para Poder continual."}).then(()=>{this.mensagePantalla=!1})))}cargarDatosCliente(e){this.resultadoNombre=[],this.buscarNombre.reset(),""!==e.cl_nomClie&&(console.log(this.resultadoNombre),this.formularioFacturacion.patchValue({fa_codClie:e.cl_codClie,fa_nomClie:e.cl_nomClie,fa_rncFact:e.cl_rnc,fa_telClie:e.cl_telClie,fa_dirClie:e.cl_dirClie,fa_codZona:e.cl_codZona,fa_sector:e.cl_codSect}),console.log(e),console.log("Formulario actualizado:",this.formularioFacturacion.value))}cargarDatosSector(e){this.resultadoNombre=[],this.buscarSector.reset(),""!==e.se_desSect&&(console.log(this.resultadoSector),this.formularioFacturacion.patchValue({fa_codSect:e.se_codSect,fa_sector:e.se_desSect,fa_codZona:e.se_codZona}),console.log(e))}cargarDatosFpago(e){this.resultadoFpago=[],this.buscarFpago.reset(),""!==e.fp_descfpago&&(console.log(this.resultadoFpago),this.formularioFacturacion.patchValue({fa_fpago:e.fp_descfpago,fa_codfpago:e.fp_codfpago}))}moveFocusFpago(e,i){e.preventDefault(),e.target instanceof HTMLSelectElement&&(e.target.value?i.focus():(this.mensagePantalla=!0,m().fire({icon:"error",title:"A V I S O",text:"Por favor complete el campo Tipo de Pago."}).then(()=>{this.mensagePantalla=!1})))}agregaItem(e){if(e.preventDefault(),!this.productoselect||this.cantidadmerc<=0||this.preciomerc<=0||this.preciomerc<=this.productoselect.in_cosmerc)return this.mensagePantalla=!0,void m().fire({icon:"error",title:"A V I S O",text:"Por favor complete todos los campos requeridos antes de agregar el \xedtem."}).then(()=>{this.mensagePantalla=!1});const i=new Date;if(this.isEditing)this.itemToEdit.producto=this.productoselect,this.itemToEdit.codmerc=this.codmerc,this.itemToEdit.descripcionmerc=this.descripcionmerc,this.itemToEdit.precio=this.preciomerc,this.itemToEdit.cantidad=this.cantidadmerc,this.itemToEdit.total=this.cantidadmerc*this.preciomerc,this.itemToEdit.totalcosto+=this.costotxt*this.cantidadmerc,this.itemToEdit.fecfactActual=i,this.actualizarTotales(),this.isEditing=!1,this.itemToEdit=null;else{const o=this.cantidadmerc*this.preciomerc;this.totalGral+=o;const r=.18*o;this.totalItbis+=r,this.subTotal+=o-r;const s=this.costotxt*this.cantidadmerc;this.totalcosto+=this.costotxt*this.cantidadmerc,this.factxt=100*(this.totalGral-this.totalcosto)/this.totalcosto,this.protxt=100*(this.preciomerc-this.costotxt)/this.costotxt,this.items.push({producto:this.productoselect,cantidad:this.cantidadmerc,precio:this.preciomerc,total:o,costo:s,fecfactActual:i}),this.actualizarTotales(),this.cancelarBusquedaDescripcion=!1,this.cancelarBusquedaCodigo=!1}this.limpiarCampos()}actualizarCalculo(){this.protxt=100*(this.preciomerc-this.costotxt)/this.costotxt}limpiarCampos(){this.codmerc="",this.descripcionmerc="",this.preciomerc=0,this.cantidadmerc=0,this.isEditing=!1,this.existenciatxt=0,this.costotxt=0,this.medidatxt=0,this.fecacttxt=" ",this.atxt=0,this.btxt=0,this.ctxt=0,this.dtxt=0,this.etxt=0,this.ftxt=0,this.gtxt=0,this.protxt=0}limpiarTabla(){this.items=[],this.totalGral=0,this.totalItbis=0,this.subTotal=0}borarItem(e){const i=this.items.indexOf(e);i>-1&&(this.items.splice(i,1),this.items=[...this.items],this.recalcularTotales())}recalcularTotales(){this.totalGral=0,this.totalItbis=0,this.subTotal=0;for(const e of this.items){const i=.18*e.total/1.18,o=e.total-i;this.totalItbis+=i,this.subTotal+=o,this.totalGral+=e.total}}editarItem(e){this.habilitarCampos=!1,this.habilitarCantidad=!0,this.index_item=this.items.indexOf(e),this.isEditing=!0,this.itemToEdit=e,this.productoselect=e.producto,this.codmerc=e.producto.in_codmerc,this.descripcionmerc=e.producto.in_desmerc,this.preciomerc=e.precio,this.cantidadmerc=e.cantidad,this.existenciatxt=e.producto.in_canmerc,this.costotxt=e.producto.in_cosmerc,setTimeout(()=>{this.cantidadInput?.nativeElement.focus(),this.cantidadInput?.nativeElement.select()})}agregarItem(){this.habilitarCampos=!0,this.habilitarCantidad=!0,setTimeout(()=>{this.codigoInput?.nativeElement.focus(),this.codigoInput?.nativeElement.select()})}actualizarTotales(){this.totalGral=this.items.reduce((i,o)=>i+o.total,0),this.totalItbis=this.items.reduce((i,o)=>i+.18*o.total,0),this.subTotal=this.items.reduce((i,o)=>i+(o.total-.18*o.total),0),this.totalcosto=this.items.reduce((i,o)=>i+this.costotxt*o.cantidad,0);const e=i=>i.toLocaleString("es-DO",{style:"currency",currency:"DOP"});this.subtotaltxt=e(this.subTotal),this.itbitxt=e(this.totalItbis),this.totalgraltxt=e(this.totalGral)}guardarFacturacion(){const e=this.formularioFacturacion.get("fa_codFact")?.value;this.formularioFacturacion.patchValue({fa_valFact:this.totalGral,fa_itbiFact:this.totalItbis,fa_cosFact:this.totalcosto,fa_subFact:this.subTotal}),this.formularioFacturacion.get("fa_valFact")?.patchValue(this.totalGral),this.formularioFacturacion.get("fa_itbiFact")?.patchValue(this.totalItbis),this.formularioFacturacion.get("fa_cosFact")?.patchValue(this.totalcosto),this.formularioFacturacion.get("fa_subFact")?.patchValue(this.subTotal),this.formularioFacturacion.get("fa_tipoNcf").enable(),this.formularioFacturacion.get("fa_codFact").enable(),this.formularioFacturacion.get("fa_fecFact").enable(),this.formularioFacturacion.get("fa_nomVend").enable(),this.formularioFacturacion.get("fa_ncfFact").enable();const i={factura:this.formularioFacturacion.value,detalle:this.items};this.formularioFacturacion.valid?e?this.servicioFacturacion.editarFacturacion(i).subscribe(o=>{m().fire({title:"Actualizado!",text:"Factura modificada correctamente.",icon:"success",timer:1e3,showConfirmButton:!1}),this.refrescarFormulario()}):this.servicioFacturacion.guardarFacturacion(i).subscribe(o=>{m().fire({title:"Excelente!",text:"Factura creada correctamente.",icon:"success",timer:1e3,showConfirmButton:!1}),this.refrescarFormulario()}):alert("Esta Factura no fue guardada")}refrescarFormulario(){this.buscarTodasFacturacion(),this.formularioFacturacion.reset(),this.crearFormularioFacturacion(),this.formularioFacturacion.enable(),this.limpia()}navigateTable(e){const i=e.key;"ArrowDown"===i?this.selectedRow<this.items.length-1&&(this.selectedRow++,this.selectRow(this.selectedRow)):"ArrowUp"===i&&this.selectedRow>0&&(this.selectedRow--,this.selectRow(this.selectedRow))}selectRow(e){this.selectedRow=e,this.selectedItem=this.items[e],console.log(this.selectedItem),this.calcularPorcentaje()}calcularPorcentaje(){this.protxt=100*(this.selectedItem.total-this.selectedItem.costo)/this.selectedItem.costo}ngAfterViewInit(){this.Tabladetalle.nativeElement.focus()}formatNumber(e){let i=Number(e);return isNaN(i)?" ":i.toLocaleString("en-US",{minimumFractionDigits:2})}generatePDF(e){console.log(e),this.servicioFacturacion.buscarFacturaDetalle(e.fa_codFact).subscribe(i=>{let o=0,s=0;i.data.forEach(p=>{const M=p.dc_canmerc,G=p.dc_premerc,E=M*G;this.items.push({producto:{in_codmerc:p.dc_codmerc,in_desmerc:p.dc_descrip,in_grumerc:"",in_tipoproduct:"",in_canmerc:0,in_caninve:0,in_fecinve:null,in_eximini:0,in_cosmerc:0,in_premerc:0,in_precmin:0,in_ucosto:0,in_porgana:0,in_peso:0,in_longitud:0,in_unidad:0,in_medida:0,in_longitu:0,in_fecmodif:null,in_amacen:0,in_imagen:"",in_status:"",in_itbis:!1,in_minvent:0},cantidad:M,precio:G,total:E,fecfactActual:new Date,costo:0}),o+=E,this.totalItbis+=.18*E}),s=o+this.totalItbis,this.subTotal=o,this.totalItbis=this.totalItbis,this.totalGral=s;const l=p=>p.toLocaleString("es-DO",{style:"currency",currency:"DOP"}),n=new P.default,y=(n.internal.pageSize.getWidth()-20)/2;n.addImage("assets/logo2.png","PNG",y,10,20,20),n.setFontSize(16),n.text("CENTRAL HIERRO, SRL",105,40,{align:"center"}),n.setFontSize(10),n.text("#172 Esq. Albert Thomas",105,47,{align:"center"}),n.text("809-384-2000, 809-384-200",105,52,{align:"center"}),n.text("1-30-29922-6",105,57,{align:"center"}),n.setFontSize(14),n.text("FACTURA",105,70,{align:"center"}),n.setFontSize(10),n.text(`No. ${e.fa_codFact}`,14,80),n.text(`Fecha: ${e.fa_fecFact}`,14,85),n.text(`Vendedido por: ${e.fa_nomVend}`,14,90),n.setFontSize(12),n.text("CLIENTE",14,100),n.setFontSize(10),n.text(e.fa_nomClie,14,106),B()(n,{head:[["Codigo","Descripci\xf3n","Cantidad","Precio","Itbis","Total"]],body:i.data.map(p=>[p.df_codMerc,p.df_desMerc,parseInt(p.df_canMerc),l(parseFloat(p.df_preMerc)),l(p.df_preMerc*p.df_canMerc*18/100),l(p.df_preMerc*p.df_canMerc)]),startY:115});const g=n.lastAutoTable.finalY;n.setFontSize(12),n.text("Subtotal:",118,g+10),n.setFontSize(10),n.text(`${l(o)} `,160,g+10),n.setFontSize(12),n.text("ITBIS:",118,g+16),n.setFontSize(10),n.text(`${l(this.totalItbis)} `,160,g+16),n.setFontSize(12),n.text("TOTAL A PAGAR: ",118,g+22),n.setFontSize(14),n.text(`${l(s)} `,160,g+22),n.setFontSize(12),n.setFontSize(14),n.text("WWW.GRUPOHIERRO.COM",105,g+47,{align:"center"}),n.setFontSize(12),n.text("*** Gracias por Preferirnos ***",105,g+55,{align:"center"});const mt=n.output("blob"),pt=URL.createObjectURL(mt);window.open(pt,"_blank")})}goToFirstPage(){this.currentPage=1}goToLastPage(){this.currentPage=this.totalPages}nextPage(){this.currentPage<this.totalPages&&this.currentPage++}prevPage(){this.currentPage>1&&this.currentPage--}onTableKeydown(e){const i=this.paginatedData.length-1;switch(e.key){case"ArrowDown":this.selectedRow<i&&(this.selectedRow++,this.scrollToRow(this.selectedRow),this.consultarFacturacion(this.paginatedData[this.selectedRow])),e.preventDefault();break;case"ArrowUp":this.selectedRow>0&&(this.selectedRow--,this.scrollToRow(this.selectedRow),this.consultarFacturacion(this.paginatedData[this.selectedRow])),e.preventDefault();break;case"Enter":this.consultarFacturacion(this.paginatedData[this.selectedRow]),e.preventDefault()}}scrollToRow(e){const o=document.querySelector(".table-responsive tbody")?.querySelectorAll("tr");o&&o[e]&&o[e].scrollIntoView({block:"nearest",behavior:"smooth"})}static{this.\u0275fac=function(i){return new(i||c)(t.rXU(u.ok),t.rXU(Y._),t.rXU(z.d),t.rXU(U.a),t.rXU(O.M),t.rXU(L.f),t.rXU(X.E),t.rXU(J.V),t.rXU(K.U),t.rXU(W.Y))}}static{this.\u0275cmp=t.VBU({type:c,selectors:[["controlfact"]],viewQuery:function(i,o){if(1&i&&(t.GBs(Z,5),t.GBs(H,5),t.GBs(Q,5),t.GBs(q,5),t.GBs(tt,5)),2&i){let r;t.mGM(r=t.lsd())&&(o.codigoInput=r.first),t.mGM(r=t.lsd())&&(o.descripcionInput=r.first),t.mGM(r=t.lsd())&&(o.Tabladetalle=r.first),t.mGM(r=t.lsd())&&(o.cantidadInput=r.first),t.mGM(r=t.lsd())&&(o.buscarcodmercElement=r.first)}},decls:267,vars:58,consts:[[1,"row"],[1,"col-12","mb-3"],[2,"background","linear-gradient(90deg, #1f3c88, #4e9af1)","color","#fff","border-radius","10px","padding","16px 20px","box-shadow","0 8px 16px rgba(31,60,136,0.15)"],[2,"margin","0","font-weight","700","letter-spacing","0.2px"],[2,"opacity","0.9","font-size","14px"],[1,"col-6"],[1,"card","shadow-sm","rounded-3","border-0"],[1,"card-header",2,"min-height","48px","background","linear-gradient(90deg, #1f3c88, #4e9af1)","color","#fff","border-top-left-radius","12px","border-top-right-radius","12px"],[1,"card-title","m-0",2,"color","white","text-align","left","font-weight","700"],[1,"card-body",2,"background-color","#f8fafc"],[1,"custom-form-background",3,"formGroup"],[1,"row","mt-0"],[1,"col-5"],[1,"col-1"],["for","",1,"label"],[1,"col-3"],["type","text","formControlName","fa_codFact",1,"form-control","form-control-sm","textbox"],["formControlName","fa_fecFact","type","text",1,"form-control","form-control-sm"],[1,"row","mt-1"],[1,"col-2"],["type","text","id","inputrnc","formControlName","fa_rncFact",1,"form-control","form-control-sm",3,"keydown.enter"],["inputrnc",""],[1,"col-4"],["name","tipoNcf","formControlName","fa_tipoNcf",1,"form-select","form-control-sm",3,"keydown"],[3,"value",4,"ngFor","ngForOf"],["type","text","formControlName","fa_ncfFact","placeholder","NCF",1,"form-control","form-control-sm"],[1,"row","mt-.5"],[1,"col-10"],[1,"input-group","show"],["data-id","agent","type","text","autocomplete","off","id","inputnombre","formControlName","fa_nomClie",1,"form-control","form-control-sm","dropdown-toggle","searchInput",3,"input","keydown.enter","keydown"],["inputnombre",""],[1,"dropdown-menu",2,"margin-right","30px","margin-top","45px","z-index","300","width","350px","position","absolute","will-change","transform",3,"ngClass"],["class","searchReturnItem name-find",3,"active",4,"ngFor","ngForOf"],["type","text","id","inputdireccion","formControlName","fa_dirClie",1,"form-control","form-control-sm",3,"keydown"],["inputdireccion",""],["type","text","id","inputtelefono","formControlName","fa_telClie","placeholder","Tel. 1",1,"form-control","form-control-sm",3,"keydown"],["inputtelefono",""],["type","text","formControlName","fa_telClie2","placeholder","Tel. 2",1,"form-control","form-control-sm",3,"keydown"],["inputtelefono2",""],["type","text","formControlName","fa_sector","placeholder","Sector",1,"form-control","form-control-sm",3,"keydown"],["inputsector",""],["type","text","formControlName","fa_correo","placeholder","Correo",1,"form-control","form-control-sm",3,"keydown"],["inputcorreo",""],["type","text","formControlName","fa_contacto","placeholder","Contacto",1,"form-control","form-control-sm",3,"keydown"],["inputcontacto",""],["name","formapago","formControlName","fa_fpago",1,"form-control","listbox",3,"keydown"],["inputfpago",""],["name","listaenvio","formControlName","fa_envio",1,"form-control","listbox"],["inputenvio",""],["value","Envio"],["value","Retiro"],["type","password","formControlName","fa_codVend","placeholder","Vendedor",1,"form-control","form-control-sm"],["inputvendedor",""],["type","text","formControlName","fa_nomVend",1,"form-control","form-control-sm"],["for","fa_despacho",1,"form-check-label"],[1,"form-check"],["type","checkbox","id","fa_facturada","formControlName","fa_facturada",1,"form-check-input","form-check-input-sm"],["type","checkbox","id","fa_despacho","formControlName","fa_despacho",1,"form-check-input","form-check-input-sm"],["type","checkbox","id","fa_entrega","formControlName","fa_entrega","placeholder","Entregado",1,"form-check-input","form-check-input-sm"],["input8",""],["type","text","placeholder","No. de Factura",1,"form-control","form-control-sm",3,"ngModel","ngModelChange","keydown.enter"],["type","text","placeholder","Nombre del Cliente",1,"form-control","form-control-sm",3,"ngModel","ngModelChange","input"],["type","date","placeholder","Fecha Factura",1,"form-control","form-control-sm",3,"ngModel","ngModelChange","keydown.enter"],[1,"table-container",2,"position","relative","height","300px"],["tabindex","0",1,"table-responsive",2,"height","250px","overflow-y","auto","border","1px solid #e0e3eb","border-radius","10px","box-shadow","0 6px 16px rgba(0,0,0,0.06)",3,"keydown"],["id","tablaFactura",1,"table","table-bordered","table-hover","table-striped","table-sm","align-middle"],[1,"sticky-header",2,"position","sticky","top","0","z-index","10","background","linear-gradient(90deg, #0f172a, #334155)","color","#fff"],[2,"width","10%"],[2,"width","40%"],[1,"text-center",2,"width","15%"],[1,"text-end",2,"width","16%"],[3,"ngClass",4,"ngFor","ngForOf"],[1,"pagination-controls",2,"position","absolute","bottom","0","left","0","right","0","background","linear-gradient(90deg, #fafafa, #f1f1f1)","padding","8px 12px","display","flex","justify-content","space-between","align-items","center","border-top","1px solid #ccc"],[1,"btn","btn-sm","btn-primary",3,"disabled","click"],[2,"font-weight","bold","font-size","14px"],[1,"col"],[1,"card"],[1,"card-body",2,"height","60px","background-color","#f7eeeebd"],[1,"d-flex","justify-content-center","align-items-center","gap-3","mt-0"],[1,"btn","btn-primary","btn-lx",2,"min-width","180px",3,"disabled","click"],[1,"bi","bi-arrow-clockwise"],[1,"btn","btn-success","btn-lx",2,"min-width","180px",3,"disabled","click"],[1,"bi","bi-check"],[1,"btn","btn-secondary","btn-lx",2,"min-width","180px",3,"click"],[1,"card-header",2,"min-height","48px","background","linear-gradient(90deg, #d7263d, #ff6b6b)","color","#fff","border-top-left-radius","12px","border-top-right-radius","12px"],[1,"card-body",2,"background-color","#ffffff"],[1,"row","align-items-end"],["for",""],["data-id","agent","type","text","autocomplete","off","name","codmerc","placeholder","C\xf3digo",1,"form-control","dropdown-toggle","searchInput","me-2",3,"disabled","ngModel","input","keydown","ngModelChange"],["codigoInput",""],["data-id","agent","type","text","autocomplete","off",1,"form-control","dropdown-toggle","searchInput","me-2",3,"disabled","ngModel","input","keydown","ngModelChange"],["descripcionInput",""],["type","number","placeholder","Cantidad",1,"form-control",3,"disabled","ngModel","ngModelChange","keydown"],["cantidadInput",""],["type","number","id","input9",1,"form-control",3,"disabled","ngModel","ngModelChange","input","keydown","keydown.enter"],["precioInput",""],[1,"btn","btn-success","btn-block","btn-lx","w-40",3,"disabled","click"],[1,"bi","bi-plus-circle"],["tabindex","0",1,"table-responsive",2,"height","350px","overflow-y","auto","border","1px solid #e0e3eb","border-radius","10px","box-shadow","0 6px 16px rgba(0,0,0,0.06)",3,"keydown"],["Tabledetalle",""],[1,"table","table-sm","table-bordered","table-hover","align-middle"],[2,"width","13%"],[2,"width","37%"],[2,"width","15%"],[3,"table-active","click",4,"ngFor","ngForOf"],[1,"col-7"],[1,"col-3","col-form-label","text-black","text-end",2,"font-size","12px","font-weight","bold"],["type","text","readonly","","id","inputPassword",1,"form-control","form-control-sm","text-end",2,"font-size","12px","font-weight","bold",3,"value","ngStyle"],[1,"col-2","col-form-label","text-black","text-end",2,"font-size","12px","font-weight","bold"],[1,"col-1","col-form-label","text-black","text-end",2,"font-size","12px","font-weight","bold"],[2,"padding","10px","border","1px solid #e0e3eb","border-radius","10px","background","linear-gradient(180deg, #fafafa, #f5f7fb)","box-shadow","0 6px 16px rgba(0,0,0,0.06)"],[1,"col-4","col-form-label","text-black",2,"font-size","18px","font-weight","bold"],[1,"col-8"],["type","text","disabled","","id","inputPassword",1,"form-control","form-control-sm","text-end",2,"font-size","18px","font-weight","bold",3,"value"],["type","text","disabled","","id","inputPassword",1,"form-control","form-control-sm","text-end",2,"font-size","18px","font-weight","bold",3,"ngModel","ngModelChange"],[1,"col-4","text-black"],[3,"value"],[1,"searchReturnItem","name-find"],[1,"px-3","cp",2,"color","#222222 !important","font-size","10pt","padding","20px 0px","text-decoration","none !important","cursor","pointer",3,"click"],[1,"far","fa-user-circle","mr-5"],[3,"ngClass"],[3,"click"],[1,"text-center"],[1,"text-end"],[1,"bi","bi-card-list","text-success",2,"padding","10px",3,"click"],[1,"text-center",2,"width","10%"],[1,"text-center",2,"width","11%"],[1,"text-end",2,"width","13%"],["class","bi bi-pencil text-primary","style","padding: 10px",3,"click",4,"ngIf"],["class","bi bi-trash text-danger","style","padding: 10px",3,"click",4,"ngIf"],[1,"bi","bi-pencil","text-primary",2,"padding","10px",3,"click"],[1,"bi","bi-trash","text-danger",2,"padding","10px",3,"click"]],template:function(i,o){if(1&i){const r=t.RV6();t.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3",3),t.EFF(4,"Control de Facturas"),t.k0s(),t.j41(5,"div",4),t.EFF(6,"Gesti\xf3n \xe1gil de clientes, pagos y detalle de productos"),t.k0s()()(),t.j41(7,"div",5)(8,"div",6)(9,"div",7)(10,"h4",8),t.EFF(11,"Datos de la Factura"),t.k0s()(),t.j41(12,"div",9)(13,"form",10)(14,"div",11),t.nrm(15,"div",12),t.j41(16,"div",13)(17,"label",14),t.EFF(18,"No."),t.k0s()(),t.j41(19,"div",15),t.nrm(20,"input",16),t.k0s(),t.j41(21,"div",15),t.nrm(22,"input",17),t.k0s()(),t.j41(23,"div",18)(24,"div",19)(25,"label",14),t.EFF(26,"RNC"),t.k0s()(),t.j41(27,"div",15)(28,"input",20,21),t.bIt("keydown.enter",function(a){t.eBV(r);const l=t.sdS(42);return t.Njj(o.buscarRnc(a,l))}),t.k0s()(),t.j41(30,"div",22)(31,"select",23),t.bIt("keydown",function(a){t.eBV(r);const l=t.sdS(51);return t.Njj(o.moveFocus(a,l))}),t.DNE(32,et,2,2,"option",24),t.k0s()(),t.j41(33,"div",15),t.nrm(34,"input",25),t.k0s()(),t.j41(35,"div",26)(36,"div",19)(37,"label",14),t.EFF(38,"Cliente"),t.k0s()(),t.j41(39,"div",27)(40,"div",28)(41,"input",29,30),t.bIt("input",function(a){return o.convertToUpperCase(a)})("keydown.enter",function(a){t.eBV(r);const l=t.sdS(51);return t.Njj(o.moveFocusnomclie(a,l))})("keydown",function(a){return o.handleKeydown(a)}),t.k0s(),t.j41(43,"div",31),t.DNE(44,ot,4,3,"div",32),t.k0s()()()(),t.j41(45,"div",26)(46,"div",19)(47,"label",14),t.EFF(48,"Direcci\xf3n"),t.k0s()(),t.j41(49,"div",27)(50,"input",33,34),t.bIt("keydown",function(a){t.eBV(r);const l=t.sdS(58);return t.Njj(o.moveFocus(a,l))}),t.k0s()()(),t.j41(52,"div",26)(53,"div",19)(54,"label",14),t.EFF(55,"Telefono"),t.k0s()(),t.j41(56,"div",15)(57,"input",35,36),t.bIt("keydown",function(a){t.eBV(r);const l=t.sdS(61);return t.Njj(o.moveFocus(a,l))}),t.k0s()(),t.j41(59,"div",15)(60,"input",37,38),t.bIt("keydown",function(a){t.eBV(r);const l=t.sdS(64);return t.Njj(o.moveFocus(a,l))}),t.k0s()(),t.j41(62,"div",22)(63,"input",39,40),t.bIt("keydown",function(a){t.eBV(r);const l=t.sdS(71);return t.Njj(o.moveFocus(a,l))}),t.k0s()()(),t.j41(65,"div",26)(66,"div",19)(67,"label",14),t.EFF(68,"Correo"),t.k0s()(),t.j41(69,"div",5)(70,"input",41,42),t.bIt("keydown",function(a){t.eBV(r);const l=t.sdS(74);return t.Njj(o.moveFocus(a,l))}),t.k0s()(),t.j41(72,"div",22)(73,"input",43,44),t.bIt("keydown",function(a){t.eBV(r);const l=t.sdS(81);return t.Njj(o.moveFocus(a,l))}),t.k0s()()(),t.j41(75,"div",18)(76,"div",19)(77,"label",14),t.EFF(78,"Tipo pago"),t.k0s()(),t.j41(79,"div",15)(80,"select",45,46),t.bIt("keydown",function(a){t.eBV(r);const l=t.sdS(85);return t.Njj(o.moveFocus(a,l))}),t.DNE(82,it,2,2,"option",24),t.k0s()(),t.j41(83,"div",15)(84,"select",47,48)(86,"option",49),t.EFF(87,"Envio"),t.k0s(),t.j41(88,"option",50),t.EFF(89,"Retirar por el Cliente"),t.k0s()()(),t.j41(90,"div",19),t.nrm(91,"input",51,52),t.k0s(),t.j41(93,"div",19),t.nrm(94,"input",53),t.k0s()(),t.j41(95,"div",26)(96,"div",19)(97,"label",54),t.EFF(98,"Facturada"),t.k0s()(),t.j41(99,"div",19)(100,"div",55),t.nrm(101,"input",56),t.k0s()(),t.j41(102,"div",19)(103,"label",54),t.EFF(104,"Despachado"),t.k0s()(),t.j41(105,"div",19)(106,"div",55),t.nrm(107,"input",57),t.k0s()(),t.j41(108,"div",19)(109,"label",14),t.EFF(110,"Entregada"),t.k0s()(),t.j41(111,"div",19),t.nrm(112,"input",58,59),t.k0s()()(),t.nrm(114,"br"),t.j41(115,"div",0)(116,"div",19)(117,"label",14),t.EFF(118,"Buscar Por"),t.k0s()(),t.j41(119,"div",15)(120,"input",60),t.bIt("ngModelChange",function(a){return o.txtFactura=a})("keydown.enter",function(a){return o.buscaFactura(a)}),t.k0s()(),t.j41(121,"div",22)(122,"input",61),t.bIt("ngModelChange",function(a){return o.txtdescripcion=a})("input",function(a){return o.buscaNombre(a)}),t.k0s()(),t.j41(123,"div",15)(124,"input",62),t.bIt("ngModelChange",function(a){return o.txtFecha=a})("keydown.enter",function(a){return o.buscaFecha(a)}),t.k0s()()(),t.j41(125,"div",18)(126,"div",63)(127,"div",64),t.bIt("keydown",function(a){return o.onTableKeydown(a)}),t.j41(128,"table",65)(129,"thead",66)(130,"tr")(131,"th",67),t.EFF(132,"N\xfamero"),t.k0s(),t.j41(133,"th",68),t.EFF(134,"Nombre"),t.k0s(),t.j41(135,"th",69),t.EFF(136,"Fecha"),t.k0s(),t.j41(137,"th",70),t.EFF(138,"Valor"),t.k0s(),t.j41(139,"th",67),t.EFF(140,"Cobro"),t.k0s()()(),t.j41(141,"tbody"),t.DNE(142,rt,11,7,"tr",71),t.k0s()()(),t.j41(143,"div",72)(144,"div")(145,"button",73),t.bIt("click",function(){return o.goToFirstPage()}),t.EFF(146," \u23ee\ufe0f Inicio "),t.k0s(),t.j41(147,"button",73),t.bIt("click",function(){return o.prevPage()}),t.EFF(148," \u23ea Anterior "),t.k0s()(),t.j41(149,"span",74),t.EFF(150),t.k0s(),t.j41(151,"div")(152,"button",73),t.bIt("click",function(){return o.nextPage()}),t.EFF(153," Siguiente \u23e9 "),t.k0s(),t.j41(154,"button",73),t.bIt("click",function(){return o.goToLastPage()}),t.EFF(155," Fin \u23ed\ufe0f "),t.k0s()()()()()(),t.j41(156,"div",11)(157,"div",75)(158,"div",76)(159,"div",77)(160,"div",78)(161,"button",79),t.bIt("click",function(){return o.editarFactura()}),t.nrm(162,"i",80),t.EFF(163," Editar "),t.k0s(),t.j41(164,"button",81),t.bIt("click",function(){return o.guardarFacturacion()}),t.nrm(165,"i",82),t.EFF(166," Guardar "),t.k0s(),t.j41(167,"button",83),t.bIt("click",function(){return o.limpia()}),t.nrm(168,"i",80),t.EFF(169," Deshacer "),t.k0s()()()()()()()(),t.j41(170,"div",5)(171,"div",6)(172,"div",84)(173,"h4",8),t.EFF(174," Detalles de la Factura "),t.k0s()(),t.j41(175,"div",85)(176,"div",86)(177,"div",19)(178,"label",87),t.EFF(179," C\xf3digo "),t.k0s(),t.j41(180,"div",28)(181,"input",88,89),t.bIt("input",function(a){return o.convertToUpperCase(a)})("keydown",function(a){return o.handleKeydownInventario(a)})("keydown",function(a){t.eBV(r);const l=t.sdS(190);return t.Njj(o.moveFocuscodmerc(a,l))})("ngModelChange",function(a){return o.codmerc=a}),t.k0s(),t.j41(183,"div",31),t.DNE(184,st,4,3,"div",32),t.k0s()()(),t.j41(185,"div",22)(186,"label",87),t.EFF(187," Descripci\xf3n "),t.k0s(),t.j41(188,"div",28)(189,"input",90,91),t.bIt("input",function(a){return o.convertToUpperCase(a)})("keydown",function(a){t.eBV(r);const l=t.sdS(197);return t.Njj(o.moveFocusdesc(a,l))})("keydown",function(a){return o.handleKeydownInventariosdesc(a)})("ngModelChange",function(a){return o.descripcionmerc=a}),t.k0s(),t.j41(191,"div",31),t.DNE(192,ct,4,3,"div",32),t.k0s()()(),t.j41(193,"div",19)(194,"label",87),t.EFF(195," Cant. "),t.k0s(),t.j41(196,"input",92,93),t.bIt("ngModelChange",function(a){return o.cantidadmerc=a})("keydown",function(a){t.eBV(r);const l=t.sdS(202);return t.Njj(o.moveFocusCantidad(a,l))}),t.k0s()(),t.j41(198,"div",19)(199,"label",87),t.EFF(200," Precio "),t.k0s(),t.j41(201,"input",94,95),t.bIt("ngModelChange",function(a){return o.preciomerc=a})("input",function(){return o.actualizarCalculo()})("keydown",function(a){t.eBV(r);const l=t.sdS(182);return t.Njj(o.moveFocus(a,l))})("keydown.enter",function(a){return o.agregaItem(a)}),t.k0s()(),t.j41(203,"div",19)(204,"button",96),t.bIt("click",function(){return o.agregarItem()}),t.nrm(205,"i",97),t.EFF(206," Add "),t.k0s()()(),t.j41(207,"div",0)(208,"div",75)(209,"div",98,99),t.bIt("keydown",function(a){return o.navigateTable(a)}),t.j41(211,"table",100)(212,"thead",66)(213,"tr")(214,"th",101),t.EFF(215,"C\xf3digo"),t.k0s(),t.j41(216,"th",102),t.EFF(217,"Descripci\xf3n"),t.k0s(),t.j41(218,"th",67),t.EFF(219,"Cant."),t.k0s(),t.j41(220,"th",101),t.EFF(221,"Precio"),t.k0s(),t.j41(222,"th",103),t.EFF(223,"Total"),t.k0s(),t.j41(224,"th"),t.EFF(225,"Opciones"),t.k0s()()(),t.j41(226,"tbody"),t.DNE(227,dt,15,11,"tr",104),t.k0s()()()()(),t.j41(228,"div",0)(229,"div",105)(230,"div",18)(231,"h6",106),t.EFF(232," % Producto "),t.k0s(),t.j41(233,"div",19),t.nrm(234,"input",107),t.k0s(),t.j41(235,"h6",108),t.EFF(236," Factura "),t.k0s(),t.j41(237,"div",19),t.nrm(238,"input",107),t.k0s(),t.j41(239,"h6",109),t.EFF(240," % "),t.k0s()()(),t.j41(241,"div",12)(242,"div",18)(243,"div",110)(244,"div",0)(245,"h6",111),t.EFF(246," Sub Total "),t.k0s(),t.j41(247,"div",112),t.nrm(248,"input",113),t.nI1(249,"number"),t.k0s()(),t.j41(250,"div",26)(251,"h6",111),t.EFF(252," Desc. "),t.k0s(),t.j41(253,"div",112)(254,"input",114),t.bIt("ngModelChange",function(a){return o.descuentotxt=a}),t.k0s()()(),t.j41(255,"div",26)(256,"h6",111),t.EFF(257," ITBI "),t.k0s(),t.j41(258,"div",112),t.nrm(259,"input",113),t.nI1(260,"number"),t.k0s()(),t.j41(261,"div",26)(262,"h4",115),t.EFF(263,"Total"),t.k0s(),t.j41(264,"div",112),t.nrm(265,"input",113),t.nI1(266,"number"),t.k0s()()()()()()()()()()}2&i&&(t.R7$(13),t.Y8G("formGroup",o.formularioFacturacion),t.R7$(19),t.Y8G("ngForOf",o.ncflist),t.R7$(11),t.Y8G("ngClass",t.eq3(48,T,o.resultadoNombre.length>0)),t.R7$(1),t.Y8G("ngForOf",o.resultadoNombre),t.R7$(38),t.Y8G("ngForOf",o.resultadoFpago),t.R7$(38),t.Y8G("ngModel",o.txtFactura),t.R7$(2),t.Y8G("ngModel",o.txtdescripcion),t.R7$(2),t.Y8G("ngModel",o.txtFecha),t.R7$(18),t.Y8G("ngForOf",o.paginatedData),t.R7$(3),t.Y8G("disabled",1===o.currentPage),t.R7$(2),t.Y8G("disabled",o.currentPage<=1),t.R7$(3),t.Lme(" P\xe1gina ",o.currentPage," de ",o.totalPages," "),t.R7$(2),t.Y8G("disabled",o.currentPage>=o.totalPages),t.R7$(2),t.Y8G("disabled",o.currentPage>=o.totalPages),t.R7$(7),t.Y8G("disabled",o.botonEditar),t.R7$(3),t.Y8G("disabled",o.botonGuardar),t.R7$(17),t.Y8G("disabled",!o.habilitarCampos)("ngModel",o.codmerc),t.R7$(2),t.Y8G("ngClass",t.eq3(50,T,o.resultadoCodmerc.length>0)),t.R7$(1),t.Y8G("ngForOf",o.resultadoCodmerc),t.R7$(5),t.Y8G("disabled",!o.habilitarCampos)("ngModel",o.descripcionmerc),t.R7$(2),t.Y8G("ngClass",t.eq3(52,T,o.resultadodescripcionmerc.length>0)),t.R7$(1),t.Y8G("ngForOf",o.resultadodescripcionmerc),t.R7$(4),t.Y8G("disabled",!o.habilitarCantidad)("ngModel",o.cantidadmerc),t.R7$(5),t.Y8G("disabled",!o.habilitarCantidad)("ngModel",o.preciomerc),t.R7$(3),t.Y8G("disabled",o.botonaddItems),t.R7$(23),t.Y8G("ngForOf",o.items),t.R7$(7),t.Y8G("value",o.formatNumber(o.protxt))("ngStyle",t.eq3(54,R,o.protxt<10?"red":"green")),t.R7$(4),t.Y8G("value",o.formatNumber(o.factxt))("ngStyle",t.eq3(56,R,o.factxt<10?"red":"green")),t.R7$(10),t.Y8G("value",t.i5U(249,39,o.subTotal,"1.2-2")),t.R7$(6),t.Y8G("ngModel",o.descuentotxt),t.R7$(5),t.Y8G("value",t.i5U(260,42,o.totalItbis,"1.2-2")),t.R7$(6),t.Y8G("value",t.i5U(266,45,o.totalGral,"1.2-2")))},dependencies:[F.YU,F.Sq,F.bT,F.B3,u.qT,u.xH,u.y7,u.me,u.Q0,u.Zm,u.wz,u.BC,u.cb,u.j4,u.JD,u.vS,F.QX,F.oe],styles:[".active-row[_ngcontent-%COMP%]{background-color:#5793d3!important}#miTabla[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#e6f7ff}"]})}}return c})()}];let ht=(()=>{class c{static{this.\u0275fac=function(i){return new(i||c)}}static{this.\u0275mod=t.$C({type:c})}static{this.\u0275inj=t.G2t({imports:[N.iI.forChild(ut),N.iI]})}}return c})(),ft=(()=>{class c{static{this.\u0275fac=function(i){return new(i||c)}}static{this.\u0275mod=t.$C({type:c})}static{this.\u0275inj=t.G2t({imports:[F.MD,ht,u.X1,u.YN]})}}return c})()}}]);