<div class="container-fluid py-3">
  <!-- Hero Comercial -->
  <div
    class="rounded-4 p-4 mb-2"
    style="background: linear-gradient(90deg, #0d6efd, #6610f2); color: #fff; box-shadow: 0 8px 24px rgba(13, 110, 253, 0.25)"
  >
    <div class="d-flex align-items-center justify-content-between">
      <div>
        <h4 class="mb-1 fw-bold">
          <i class="bi bi-file-earmark-text me-2"></i>Facturación
        </h4>
        <p class="mb-0 opacity-75">Gestión comercial de ventas y detalle de productos</p>
      </div>
      <div class="d-none d-md-block text-end">
        <span class="badge bg-light text-primary fs-6 px-3 py-2" style="border-radius: 12px">Comercial</span>
      </div>
    </div>
  </div>
  <div class="row g-3">
    <!-- Columna Izquierda: Datos de Factura -->
    <div class="col-lg-5">
      <div class="card shadow-sm border-0 h-10">
        <div class="card-header text-white" style="background: linear-gradient(90deg, #0d6efd, #20c997); box-shadow: 0 2px 8px rgba(13,110,253,.2)">
          <h5 class="mb-0 fw-semibold">
            <i class="bi bi-receipt me-2"></i>Datos de Factura
          </h5>
        </div>
        <div class="card-body bg-light">
          <form
            [formGroup]="formularioFacturacion"
            (ngSubmit)="guardarFacturacion()"
          >
            <!-- Número y Fecha -->
            <div class="row g-2 mb-2">
              <div class="col-6"> </div>
              <div class="col-md-3">
                <label class="form-label small text-muted fw-semibold"
                  >No. Factura</label
                >
                
                <input
                  type="text"
                  class="form-control"
                  formControlName="fa_codFact"
                  readonly
                />
              </div>
              <div class="col-md-3">
                <label class="form-label small text-muted fw-semibold"
                >Fecha</label>
                <input
                  formControlName="fa_fecFact"
                  type="text"
                  class="form-control"
                  readonly
                />
              </div>
            </div>
            <div class="row g-2 mb-2">
            <div class="col-6"> </div>
            
            </div>
            <!-- RNC y Tipo NCF -->
            <div class="row g-2 mb-2">
              <div class="col-md-4">
                <label class="form-label small text-muted fw-semibold"
                  >RNC</label
                >
                <input
                  type="text"
                  #input1
                  id="input1"
                  (keydown.enter)="buscarRnc($event,input2)"
                  formControlName="fa_rncFact"
                  class="form-control"
                />
              </div>
              <div class="col-md-5">
                <label class="form-label small text-muted fw-semibold"
                  >Tipo NCF</label
                >
                <select
                  name="tipoNcf"
                  formControlName="fa_tipoNcf"
                  (keydown.enter)="moveFocus($event, input3)"
                  class="form-select"
                >
                  <option [value]="ncf.codNcf" *ngFor="let ncf of ncflist">
                    {{ncf.desNcf}}
                  </option>
                </select>
              </div>
              <div class="col-md-3">
                <label class="form-label small text-muted fw-semibold"
                  >NCF</label
                >
                <input
                  type="text"
                  class="form-control"
                  formControlName="fa_ncfFact"
                  placeholder="NCF"
                />
              </div>
            </div>

            <!-- Cliente -->
            <div class="mb-2">
              <label class="form-label small text-muted fw-semibold"
                >Cliente</label
              >
              <div class="position-relative">
                <input
                  class="form-control text-uppercase"
                  type="text"
                  autocomplete="off"
                  (keydown.enter)="moveFocusnomclie($event, input3)"
                  (keydown)="handleKeydown($event)"
                  #input2
                  id="input2"
                  [formControl]="buscarNombre"
                  formControlName="fa_nomClie"
                />
                <div
                  [ngClass]="{ 'show': resultadoNombre.length > 0 }"
                  class="dropdown-menu shadow-sm w-100"
                  style="
                    margin-top: 2px;
                    z-index: 1050;
                    max-height: 250px;
                    overflow-y: auto;
                    border-radius: 12px;
                    border: none;
                  "
                >
                  <a
                    *ngFor="let result of resultadoNombre; let i = index"
                    (click)="cargarDatosCliente(result)"
                    [class.active]="i === selectedIndex"
                    class="dropdown-item d-flex align-items-center py-2"
                    style="cursor: pointer"
                  >
                    <i class="bi bi-person-circle me-2 text-primary"></i>
                    <span>{{ result.cl_nomClie }}</span>
                  </a>
                </div>
              </div>
            </div>

            <!-- Dirección -->
            <div class="mb-2">
              <label class="form-label small text-muted fw-semibold"
                >Dirección</label
              >
              <input
                type="text"
                id="input3"
                formControlName="fa_dirClie"
                (keydown.enter)="moveFocus($event, input4)"
                #input3
                class="form-control text-uppercase"
              />
            </div>

            <!-- Teléfono y Sector -->
            <div class="row g-2 mb-2">
              <div class="col-md-6">
                <label class="form-label small text-muted fw-semibold">Teléfono</label>
                <input
                  type="text"
                  id="input4"
                  formControlName="fa_telClie"
                  (keydown.enter)="moveFocus($event, input6)"
                  #input4
                  placeholder="Teléfono"
                  class="form-control"
                />
              </div>
              <div class="col-md-6">
                <label class="form-label small text-muted fw-semibold"
                  >Sector</label
                >
                <div class="position-relative">
                  <input
                    type="text"
                    formControlName="fa_sector"
                    (keydown.enter)="moveFocus($event, input7)"
                    (keydown)="handleKeydownSector($event)"
                    #input6
                    placeholder="Sector"
                    class="form-control text-uppercase"
                    [formControl]="buscarSector"
                  />
                  <div
                    [ngClass]="{ 'show': resultadoSector.length > 0 }"
                    class="dropdown-menu shadow-sm w-100"
                    style="
                      margin-top: 2px;
                      z-index: 1050;
                      max-height: 200px;
                      overflow-y: auto;
                      border-radius: 12px;
                      border: none;
                    "
                  >
                    <a
                      *ngFor="let result of resultadoSector; let i = index"
                      (click)="cargarDatosSector(result)"
                      [class.active]="i === selectedIndexsector"
                      class="dropdown-item d-flex align-items-center py-2"
                      style="cursor: pointer"
                    >
                      <i class="bi bi-geo-alt me-2 text-success"></i>
                      <span>{{ result.se_desSect }}</span>
                    </a>
                  </div>
                </div>
              </div>
            </div>

            <!-- Correo y Contacto -->
            <div class="row g-2 mb-2">
              <div class="col-md-7">
                <label class="form-label small text-muted fw-semibold"
                  >Correo</label
                >
                <input
                  type="email"
                  formControlName="fa_correo"
                  (keydown.enter)="moveFocus($event, input8)"
                  #input7
                  class="form-control"
                />
              </div>
              <div class="col-md-5">
                <label class="form-label small text-muted fw-semibold"
                  >Contacto</label
                >
                <input
                  type="text"
                  formControlName="fa_contacto"
                  placeholder="Contacto"
                  (keydown.enter)="moveFocus($event, input9)"
                  #input8
                  class="form-control text-uppercase"
                />
              </div>
            </div>

            <!-- Tipo Pago, Envío y Vendedor -->
            <div class="row g-2 mb-2">
              <div class="col-md-4">
                <label class="form-label small text-muted fw-semibold"
                  >Tipo Pago</label
                >
                <select
                  #input9
                  name="formapago"
                  formControlName="fa_fpago"
                  (keydown.enter)="moveFocusFpago($event, input11)"
                  class="form-select"
                >
                  <option
                    [value]="fpago.fp_codfpago"
                    *ngFor="let fpago of resultadoFpago"
                  >
                    {{fpago.fp_descfpago}}
                  </option>
                </select>
              </div>
              <div class="col-md-4">
                <label class="form-label small text-muted fw-semibold"
                  >Entrega</label
                >
                <select
                  #input11
                  name="listaenvio"
                  id="listaenvio"
                  (keydown.enter)="moveFocus($event, input12)"
                  class="form-select"
                >
                  <option value="envio">Envío</option>
                  <option value="retiral">Retiro Cliente</option>
                </select>
              </div>
              <div class="col-md-2">
                <label class="form-label small text-muted fw-semibold"
                  >Vend.</label
                >
                <input
                  type="password"
                  (keydown.enter)="buscarUsuario($event, input13)"
                  formControlName="fa_codVend"
                  #input12
                  placeholder="Cod."
                  class="form-control text-uppercase"
                />
              </div>
              <div class="col-md-2">
                <label class="form-label small text-muted fw-semibold"
                  >&nbsp;</label
                >
                <input
                  type="text"
                  formControlName="fa_nomVend"
                  class="form-control"
                  readonly
                />
              </div>
            </div>
          </form>

          <!-- Botón para buscar facturas -->
          <div class="mt-3">
            <button
              class="btn btn-outline-primary w-100"
              data-bs-toggle="modal"
              data-bs-target="#modalBuscarFactura"
            >
              <i class="bi bi-search me-2"></i>Buscar Factura Existente
            </button>
          </div>

          <!-- Botones de Acción -->
          <div class="d-flex justify-content-between gap-2 mt-3">
            <button
              class="btn btn-outline-secondary flex-fill"
              (click)="limpia()"
            >
              <i class="bi bi-arrow-counterclockwise me-1"></i>Deshacer
            </button>
            <button
              class="btn btn-success flex-fill"
              (click)="guardarFacturacion()"
            >
              <i class="bi bi-check-circle me-1"></i>Guardar
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Columna Derecha: Detalles de Factura -->
    <div class="col-lg-7">
      <div class="card shadow-sm border-0 h-100">
        <div class="card-header text-white" style="background: linear-gradient(90deg, #20c997, #0d6efd); box-shadow: 0 2px 8px rgba(32,201,151,.25)">
          <h5 class="mb-0 fw-semibold">
            <i class="bi bi-list-ul me-2"></i>Detalles de la Factura
          </h5>
        </div>
        <div class="card-body">
          <!-- Agregar Productos -->
              <div class="row g-2">
                <div class="col-md-2">
                  <label class="form-label small text-muted fw-semibold"
                    >Código</label
                  >
                  <div class="position-relative">
                    <input
                      class="form-control text-uppercase"
                      type="text"
                      [disabled]="!habilitarCampos"
                      #codigoInput
                      autocomplete="off"
                      (keydown)="handleKeydownInventario($event)"
                      (keydown.enter)="moveFocuscodmerc($event, input14, input15)"
                      #input13
                      [formControl]="buscarcodmerc"
                      [(ngModel)]="codmerc"
                      name="codmerc"
                      placeholder="Código"
                    />
                    <div
                      [ngClass]="{ 'show': resultadoCodmerc.length > 0 }"
                      class="dropdown-menu shadow-sm w-100"
                      style="
                        margin-top: 2px;
                        z-index: 1050;
                        max-height: 200px;
                        overflow-y: auto;
                        border-radius: 12px;
                        border: none;
                      "
                    >
                      <a
                        *ngFor="let result of resultadoCodmerc; let i = index"
                        (click)="cargarDatosInventario(result)"
                        [class.active]="i === selectedIndexcodmerc"
                        class="dropdown-item d-flex align-items-center py-2"
                        style="cursor: pointer"
                      >
                        <i class="bi bi-box-seam me-2 text-success"></i>
                        <span>{{ result.in_codmerc }}</span>
                      </a>
                    </div>
                  </div>
                </div>
                <div class="col-md-5">
                  <label class="form-label small text-muted fw-semibold"
                    >Descripción</label
                  >
                  <div class="position-relative">
                    <input
                      class="form-control text-uppercase"
                      type="text"
                      [disabled]="habilitarCampos"
                      #descripcionInput
                      autocomplete="off"
                      (keydown)="moveFocusdesc($event, input15)"
                      (keydown)="handleKeydownInventariosdesc($event)"
                      #input14
                      [formControl]="buscardescripcionmerc"
                      [(ngModel)]="descripcionmerc"
                    />
                    <div
                      [ngClass]="{ 'show': resultadodescripcionmerc.length > 0 }"
                      class="dropdown-menu shadow-sm w-100"
                      style="
                        margin-top: 2px;
                        z-index: 1050;
                        max-height: 200px;
                        overflow-y: auto;
                        border-radius: 12px;
                        border: none;
                      "
                    >
                      <a
                        *ngFor="let result of resultadodescripcionmerc; let i = index"
                        (click)="cargarDatosInventario(result)"
                        [class.active]="i === selectedIndexdescripcionmerc"
                        class="dropdown-item d-flex align-items-center py-2"
                        style="cursor: pointer"
                      >
                        <i class="bi bi-box-seam me-2 text-success"></i>
                        <span>{{ result.in_desmerc }}</span>
                      </a>
                    </div>
                  </div>
                </div>
                <div class="col-md-2">
                  <label class="form-label small text-muted fw-semibold"
                    >Cantidad</label
                  >
                  <input
                    type="number"
                    placeholder="0"
                    [(ngModel)]="cantidadmerc"
                    [formControl]="cantidadform"
                    #input15
                    id="input15"
                    (keydown)="moveFocusCantidad($event, input16)"
                    class="form-control"
                    min="1"
                  />
                </div>
                <div class="col-md-2">
                  <label class="form-label small text-muted fw-semibold"
                    >Precio</label
                  >
                  <input
                    type="number"
                    [(ngModel)]="preciomerc"
                    [formControl]="precioform"
                    #input16
                    (input)="actualizarCalculo()"
                    (keydown.enter)="moveFocusPrecio($event, input13)"
                    class="form-control"
                    min="0"
                    step="0.01"
                  />
                </div>
                <div class="col-md-1 d-flex align-items-end">
                  <button
                    type="button"
                    class="btn btn-success w-100"
                    (click)="agregaItem($event)"
                    title="Agregar producto"
                  >
                    <i class="bi bi-plus-lg"></i>
                  </button>
                </div>
              </div>

          <!-- Tabla de Productos -->
          <div
            class="table-responsive detalle-table-container mb-0">
            <table
              class="table table-hover table-sm align-middle mb-0"
              tabindex="0"
              (keydown)="navigateTable($event)"
              #Tabledetalle>
              <thead class="sticky-top" style="background: linear-gradient(90deg, #0d6efd, #20c997); color: #fff;">
                <tr>
                  <th style="width: 13%">Código</th>
                  <th style="width: 37%">Descripción</th>
                  <th class="text-center" style="width: 10%">Cant.</th>
                  <th class="text-end" style="width: 13%">Precio</th>
                  <th class="text-end" style="width: 15%">Total</th>
                  <th class="text-center" style="width: 12%">Acciones</th>
                </tr>
              </thead>
              <tbody>
                <tr 
                  *ngFor="let item of items; let i = index"
                  [class.table-active]="i === selectedRow"
                  (click)="selectRow(i)"
                  class="border-bottom"
                >
                  <td class="fw-semibold text-primary">
                    {{ item.producto?.in_codmerc }}
                  </td>
                  <td>{{ item.producto?.in_desmerc }}</td>
                  <td class="text-center">{{ item.cantidad }}</td>
                  <td class="text-end">{{ item.precio | currency }}</td>
                  <td class="text-end fw-semibold">
                    {{ item.total | currency }}
                  </td>
                  <td class="text-center">
                    <div
                      class="d-flex flex-wrap justify-content-center gap-1"
                      *ngIf="habilitarIcono"
                    >
                      <button
                        type="button"
                        class="btn btn-outline-primary btn-sm"
                        (click)="editarItem(item)"
                        title="Editar"
                      >
                        <i class="bi bi-pencil"></i>
                      </button>
                      <button
                        type="button"
                        class="btn btn-outline-danger btn-sm"
                        (click)="borarItem(item)"
                        title="Eliminar"
                      >
                        <i class="bi bi-trash"></i>
                      </button>
                    </div>
                  </td>
                </tr>
                <tr *ngIf="items.length === 0">
                  <td colspan="6" class="text-center text-muted py-4">
                    <i class="bi bi-inbox fs-1 d-block mb-2"></i>
                    No hay productos agregados
                  </td>
                </tr>
              </tbody>
            </table>
          </div>

          <!-- Información de Producto y Totales -->
          <div class="row g-3 mt-2">
            <div class="col-lg-8">
              <div class="row g-2">
                <div class="col-9">
                  <div class="card border-primary shadow-sm info-producto" style="border-radius: 12px">
                    <div class="card-header bg-white border-bottom">
                      <h6 class="mb-0 text-secondary fw-semibold small">
                        <i class="bi bi-info-circle me-2"></i>Información del
                        Producto
                      </h6>
                    </div>  
                    <div class="card-body bg-light">
                      <div class="row g-2 ">
                        <div class="col-3 text-center  mb-0">
                          <label class="form-label small mb-0 fw-semibold">Exist.</label>
                          <input
                            type="text"
                            class="form-control form-control-sm text-end fw-bold"
                            readonly
                            [value]="formatNumber(existenciatxt)"
                          />
                        </div>
                        <div class="col-3 text-center  mb-0">
                          <label class="form-label small mb-0 fw-semibold">Medida</label>
                          <input
                            type="text"
                            class="form-control form-control-sm text-end fw-bold"
                            readonly
                            [(ngModel)]="medidatxt"
                          />
                        </div>  
                        <div class="col-3 text-center  mb-0">
                          <label class="form-label small mb-0 fw-semibold">Act..</label>
                          <input
                            type="text"
                            class="form-control form-control-sm text-end fw-bold"
                            readonly
                            [(ngModel)]="fecacttxt"
                          />
                        </div>  
                        <div class="col-3 text-center  mb-0">
                          <label class="form-label small mb-0 fw-semibold">Costo</label>
                          <input
                            type="text"
                            class="form-control form-control-sm text-end fw-bold"
                            readonly
                            [value]="formatNumber(costotxt)"
                          />
                        </div>  
                      </div> 
                    </div>  
                  </div>   
                </div>
                <div class="col-3">  
              <div class="card border-primary shadow-sm info-producto" style="border-radius: 12px">
                <div class="card-header bg-white border-bottom">
                  <h6 class="mb-0 text-secondary fw-semibold small">
                    <i class="bi bi-info-circle me-2"></i>Margen Fact.
                  </h6>
                </div>  
                <div class="card-body bg-light">
                  <div class="row g-2 mb-0">
                    <div class="col-6 text-center">
                      <label class="form-label small mb-0 fw-semibold">% Prod.</label>
                      <input
                        type="text"
                        class="form-control form-control-sm text-end fw-bold"
                        readonly
                        [value]="formatNumber(protxt)"
                        [ngStyle]="{'color': protxt < 10 ? 'red' : 'green'}"
                      />
                    </div>
                    <div class="col-6 text-center">
                        <label class="form-label small mb-0 fw-semibold">% Fact.</label>
                        <input
                          type="text"
                          class="form-control form-control-sm text-end fw-bold"
                          readonly
                          [value]="formatNumber(factxt)"
                          [ngStyle]="{'color': factxt < 10 ? 'red' : 'green'}"
                        />
                    </div>
                  </div>
                </div>
              </div>


                </div>   
              </div>  
              <div class="row g-2">
                <div class=" col-12">
                  <div class="card border-primary shadow-sm info-producto" style="border-radius: 12px">
                    <div class="card-header bg-white border-bottom">
                      <h6 class="mb-0 text-secondary fw-semibold small">
                        <i class="bi bi-info-circle me-2"></i>Margenes de Venta del
                        Producto
                      </h6>
                    </div>  
                    <div class="row g-2 mb-2">
                      <!-- <div class="col-1  text-center ">
                        <label class="form-label small mb-0 fw-semibold">5%</label>
                        <input
                          type="text"
                          class="form-control form-control-sm text-end fw-bold"
                          readonly
                          [value]="formatNumber(atxt)"
                        />
                      </div> -->
                      <div class="col-2  text-center ">
                        <label class="form-label small mb-0 fw-semibold">7%</label>
                        <input
                          type="text"
                          class="form-control form-control-sm text-end fw-bold"
                          readonly
                          [value]="formatNumber(btxt)"
                        />
                      </div>
                      <div class="col-2  text-center ">
                        <label class="form-label small mb-0 fw-semibold">10%</label>
                        <input
                          type="text"
                          class="form-control form-control-sm text-end fw-bold"
                          readonly
                          [value]="formatNumber(ctxt)"
                        />
                      </div>
                      <div class="col-2  text-center ">
                        <label class="form-label small mb-0 fw-semibold">12%</label>
                        <input
                          type="text"
                          class="form-control form-control-sm text-end fw-bold"
                          readonly
                          [value]="formatNumber(dtxt)"
                        />
                      </div>
                      <div class="col-2  text-center ">
                        <label class="form-label small mb-0 fw-semibold">14%</label>
                        <input
                          type="text"
                          class="form-control form-control-sm text-end fw-bold"
                          readonly
                          [value]="formatNumber(etxt)"
                        />
                      </div>
                      <div class="col-2  text-center ">
                        <label class="form-label small mb-0 fw-semibold">16%</label>
                        <input
                          type="text"
                          class="form-control form-control-sm text-end fw-bold"
                          readonly
                          [value]="formatNumber(ftxt)"
                        />
                      </div>
                      <div class="col-2  text-center ">
                        <label class="form-label small mb-0 fw-semibold">18%</label>
                        <input
                          type="text"
                          class="form-control form-control-sm text-end fw-bold"
                          readonly
                          [value]="formatNumber(gtxt)"
                        />
                      </div>
                    </div>
                  </div>  
                </div>          
              </div> 

            </div>
            <!-- <div class="col-lg-5"> </div> -->

            <!-- Totales -->
            <div class="col-lg-4">
              <div class="card border-success shadow-sm" style="border-radius: 12px">
                <div class="card-header bg-white border-bottom">
                  <h6 class="mb-0 text-secondary fw-semibold small">
                    <i class="bi bi-calculator me-2"></i>Totales
                  </h6>
                </div>  
                <div class="card-body bg-light">
                  <div class="row g-2">
                    <div class="col-6 mb-2">
                      <label class="form-label small mb-0 fw-semibold">Sub-Total</label>
                    </div>
                    <div class="col-6 mb-2">
                      <input
                        type="text"
                        class="form-control text-end fw-bold"
                        readonly
                        [(ngModel)]="subtotaltxt"
                      />
                    </div>
                  </div>
                </div>  
                  <div class="row g-2">
                    <div class="col-6 mb-2">
                      <label class="form-label small mb-0 fw-semibold">Descuento</label>
                    </div>
                    <div class="col-6 mb-2">
                      <input
                        type="text"
                        class="form-control text-end fw-bold"
                        readonly
                        [(ngModel)]="descuentotxt"
                      />
                    </div>
                  </div>
                  <div class="row g-2">
                    <div class="col-6 mb-3">
                      <label class="form-label small mb-0 fw-semibold">ITBIS</label>
                    </div>
                    <div class="col-6 mb-3">
                      <input
                        type="text"
                        class="form-control text-end fw-bold"
                        readonly
                        [(ngModel)]="itbitxt"
                      />
                    </div>
                  </div>
                  <div class="row g-2">
                    <div class="col-6">
                      <label class="form-label small mb-0 fw-bold">Total General</label>
                    </div>
                    <div class="col-6">
                      <input
                        type="text"
                        class="form-control text-end fw-bold text-success"
                        readonly
                        [(ngModel)]="totalgraltxt"
                      />
                    </div>
                  </div>
              </div>
            </div>
          </div>
          <!-- Margenes De Ventas -->
          <div class="row g-3 mt-2">

          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Modal de Búsqueda de Facturas -->
<div
  class="modal fade"
  id="modalBuscarFactura"
  tabindex="-1"
  aria-labelledby="modalBuscarFacturaLabel"
  aria-hidden="true"
>
  <div class="modal-dialog modal-lg modal-dialog-centered">
    <div class="modal-content shadow-lg border-0">
      <div class="modal-header text-white" style="background: linear-gradient(90deg, #0d6efd, #6610f2)">
        <h5 class="modal-title fw-semibold" id="modalBuscarFacturaLabel">
          <i class="bi bi-search me-2"></i>Buscar Factura
        </h5>
        <button
          type="button"
          class="btn-close btn-close-white"
          data-bs-dismiss="modal"
          aria-label="Close"
        ></button>
      </div>
      <div class="modal-body">
        <!-- Filtros de búsqueda -->
        <div class="row g-3 mb-3">
          <div class="col-md-4">
            <label class="form-label small text-muted fw-semibold"
              >No. Factura</label
            >
            <input
              type="text"
              [(ngModel)]="txtFactura"
              placeholder="Buscar por número..."
              class="form-control"
              (input)="buscaFactura($event)"
            />
          </div>
          <div class="col-md-5">
            <label class="form-label small text-muted fw-semibold"
              >Nombre Cliente</label
            >
            <input
              type="text"
              [(ngModel)]="txtdescripcion"
              placeholder="Buscar por cliente..."
              class="form-control text-uppercase"
              (input)="buscaNombre($event)"
            />
          </div>
          <div class="col-md-3">
            <label class="form-label small text-muted fw-semibold">Fecha</label>
            <input type="date" [(ngModel)]="txtFecha" class="form-control" />
          </div>
        </div>

        <!-- Tabla de Facturas -->
        <div
          class="table-responsive"
          style="max-height: 400px; overflow-y: auto"
        >
          <table class="table table-hover align-middle mb-0">
            <thead class="table-dark sticky-top">
              <tr>
                <th style="width: 15%">Número</th>
                <th style="width: 40%">Cliente</th>
                <th class="text-center" style="width: 15%">Fecha</th>
                <th class="text-end" style="width: 20%">Valor</th>
                <th class="text-center" style="width: 10%">Acción</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let factura of facturacionList" class="border-bottom">
                <td class="fw-semibold text-primary">{{factura.fa_codFact}}</td>
                <td>{{factura.fa_nomClie}}</td>
                <td class="text-center">{{ formatFecha(factura.fa_fecFact) }}</td>
                <td class="text-end fw-semibold">{{factura.fa_valFact}}</td>
                <td class="text-center">
                  <button
                    class="btn btn-outline-success btn-sm"
                    (click)="consultarFacturacion(factura)"
                    data-bs-dismiss="modal"
                    title="Cargar factura"
                  >
                    <i class="bi bi-check-circle me-1"></i>Seleccionar
                  </button>
                </td>
              </tr>
              <tr *ngIf="facturacionList.length === 0">
                <td colspan="5" class="text-center text-muted py-4">
                  <i class="bi bi-inbox fs-1 d-block mb-2"></i>
                  No se encontraron facturas
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
          <i class="bi bi-x-circle me-1"></i>Cerrar
        </button>
      </div>
    </div>
  </div>
</div>
