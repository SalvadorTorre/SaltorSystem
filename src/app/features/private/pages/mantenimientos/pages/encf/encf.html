<div class="container-fluid py-4">
  <div class="card shadow-sm mb-4 border-0 rounded-4">
    <div class="card-header bg-primary text-white rounded-top-4">
      <h5 class="mb-0"><i class="bi bi-receipt-cutoff me-2"></i>Registro de ENCF</h5>
    </div>
    <div class="card-body">
      <form class="row g-3" #encfForm="ngForm" (ngSubmit)="guardarEncf()">
        <div class="col-md-6">
          <label class="form-label fw-semibold">Código Empresa *</label>
          <input type="text" class="form-control" name="codempr" [(ngModel)]="encf.codempr" required maxlength="6" placeholder="EMP001" />
        </div>

        <div class="col-md-6">
          <label class="form-label fw-semibold">Código Sucursal</label>
          <input type="text" class="form-control" name="codsucu" [(ngModel)]="encf.codsucu" maxlength="5" placeholder="SUC01" />
        </div>

        <div class="col-md-6">
          <label class="form-label fw-semibold">Tipo ENCF *</label>
          <select class="form-select" name="tipoencf" [(ngModel)]="encf.tipoencf" required>
            <option value="">Seleccione un tipo</option>
            <option value="B">B - Crédito Fiscal</option>
            <option value="C">C - Consumidor Final</option>
            <option value="G">G - Gubernamental</option>
          </select>
        </div>

        <div class="col-md-3">
          <label class="form-label fw-semibold">Secuencia Desde</label>
          <input type="number" class="form-control text-center" name="desdeencf" [(ngModel)]="encf.desdeencf" placeholder="1" />
        </div>

        <div class="col-md-3">
          <label class="form-label fw-semibold">Secuencia Hasta</label>
          <input type="number" class="form-control text-center" name="hastaencf" [(ngModel)]="encf.hastaencf" placeholder="1000" />
        </div>

        <div class="col-md-6">
          <label class="form-label fw-semibold">Cantidad ENCF</label>
          <input type="number" class="form-control" name="cantencf" [(ngModel)]="encf.cantencf" placeholder="1000" />
        </div>

        <div class="col-md-6">
          <label class="form-label fw-semibold">Contador ENCF</label>
          <input type="number" class="form-control" name="countencf" [(ngModel)]="encf.countencf" placeholder="1" />
        </div>

        <div class="col-md-6">
          <label class="form-label fw-semibold">Fecha *</label>
          <input type="date" class="form-control" name="fechaencf" [(ngModel)]="encf.fechaencf" required />
        </div>

        <div class="col-md-6">
          <label class="form-label fw-semibold">Alerta ENCF (%)</label>
          <input type="number" class="form-control" name="alertaencf" [(ngModel)]="encf.alertaencf" placeholder="20" />
          <div class="form-text">Porcentaje de uso para activar la alerta</div>
        </div>

        <div class="col-12 d-flex justify-content-end gap-2 mt-3">
          <button type="submit" class="btn btn-primary px-4" [disabled]="!encfForm.valid">
            <i class="bi bi-save me-1"></i> {{ editIndex >= 0 ? 'Guardar cambios' : 'Guardar ENCF' }}
          </button>
          <button type="button" class="btn btn-outline-secondary px-4" (click)="limpiarFormulario()">
            <i class="bi bi-arrow-counterclockwise me-1"></i> Limpiar
          </button>
        </div>
      </form>
    </div>
  </div>
  <!-- Tabla -->
  <div class="card shadow-sm border-0 rounded-4">
    <div class="card-header bg-primary text-white rounded-top-4">
      <h5 class="mb-0"><i class="bi bi-list-check me-2"></i>ENCF Registrados</h5>
    </div>
    <div class="card-body p-0">
      <div class="table-responsive">
        <table class="table table-hover align-middle mb-0">
          <thead class="table-primary">
            <tr>
              <th>EMPRESA</th>
              <th>SUC.</th>
              <th>TIPO</th>
              <th>SECUENCIA</th>
              <th>CANTIDAD</th>
              <th>CONTADOR</th>
              <th>FECHA</th>
              <th>ALERTA</th>
              <th class="text-center">ACCIONES</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let item of listaEncf">
              <td>{{ item.codempr }}</td>
              <td>{{ item.codsucu }}</td>
              <td>{{ item.tipoencf }}</td>
              <td>{{ item.desdeencf }} - {{ item.hastaencf }}</td>
              <td>{{ item.cantencf }}</td>
              <td>{{ item.countencf }}</td>
              <td>{{ item.fechaencf | date:'dd/MM/yyyy' }}</td>
              <td>{{ item.alertaencf }}%</td>
              <td class="text-center">
                <button class="btn btn-sm btn-outline-primary me-1" (click)="editar(item)">
                  <i class="bi bi-pencil"></i>
                </button>
                <button class="btn btn-sm btn-outline-danger" (click)="eliminar(item)">
                  <i class="bi bi-trash"></i>
                </button>
              </td>
            </tr>
            <tr *ngIf="listaEncf.length === 0">
              <td colspan="9" class="text-center text-muted py-3">No hay ENCF registrados</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>