"use strict";(self.webpackChunkSaltorSystem=self.webpackChunkSaltorSystem||[]).push([[971],{8971:(R,p,r)=>{r.r(p),r.d(p,{ModuloContabilidad:()=>y});var d=r(177),u=r(8871),t=r(8699);const b=function(){return["facturas-pendientes"]},f=function(){return["nota-credito"]},g=function(){return["cuentas-por-cobrar"]},m=function(){return["reporte-606"]};let h=(()=>{class a{static{this.\u0275fac=function(n){return new(n||a)}}static{this.\u0275cmp=t.VBU({type:a,selectors:[["Contabilidad"]],decls:48,vars:10,consts:[[1,"container-fluid","p-0"],[1,"row","g-0"],[1,"d-block","d-lg-none","position-fixed","start-0","top-0","p-2","z-index-1000"],["type","button","data-bs-toggle","offcanvas","data-bs-target","#sidebarContabilidad","aria-controls","sidebarContabilidad",1,"btn","btn-primary"],[1,"bi","bi-list"],[1,"col-lg-3","col-xl-2","d-none","d-lg-block","position-fixed","start-0","overflow-auto","border-end","bg-light",2,"z-index","900","top","80px","height","calc(100vh - 80px)"],[1,"sidebar"],[1,"sidebar-header","bg-primary","text-white","p-3","d-flex","align-items-center","sticky-top"],[1,"bi","bi-calculator","me-2"],[1,"mb-0"],[1,"nav","flex-column","sidebar-nav","nav-pills","p-2"],[1,"nav-item"],["routerLinkActive","active",1,"nav-link","d-flex","align-items-center","text-dark",3,"routerLink"],[1,"bi","bi-receipt-cutoff","me-2"],[1,"bi","bi-file-earmark-minus","me-2"],[1,"bi","bi-cash-coin","me-2"],[1,"bi","bi-file-earmark-spreadsheet","me-2"],["tabindex","-1","id","sidebarContabilidad","aria-labelledby","sidebarContabilidadLabel",1,"offcanvas","offcanvas-start"],[1,"offcanvas-header","bg-primary","text-white"],["id","sidebarContabilidadLabel",1,"offcanvas-title"],["type","button","data-bs-dismiss","offcanvas","aria-label","Close",1,"btn-close","btn-close-white"],[1,"offcanvas-body","p-0"],[1,"nav","flex-column","sidebar-nav"],["routerLinkActive","active","data-bs-dismiss","offcanvas",1,"nav-link","d-flex","align-items-center",3,"routerLink"],[1,"col-12","col-lg-9","col-xl-10","offset-lg-3","offset-xl-2","main-content"],[1,"p-3"]],template:function(n,i){1&n&&(t.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"button",3),t.nrm(4,"i",4),t.EFF(5," Men\xfa "),t.k0s()(),t.j41(6,"div",5)(7,"div",6)(8,"div",7),t.nrm(9,"i",8),t.j41(10,"h5",9),t.EFF(11,"Contabilidad"),t.k0s()(),t.j41(12,"ul",10)(13,"li",11)(14,"a",12),t.nrm(15,"i",13),t.j41(16,"span"),t.EFF(17,"Facturas Pendientes"),t.k0s()()(),t.j41(18,"li",11)(19,"a",12),t.nrm(20,"i",14),t.j41(21,"span"),t.EFF(22,"Nota de Cr\xe9dito"),t.k0s()()(),t.j41(23,"li",11)(24,"a",12),t.nrm(25,"i",15),t.j41(26,"span"),t.EFF(27,"Cuentas x Cobrar"),t.k0s()()(),t.j41(28,"li",11)(29,"a",12),t.nrm(30,"i",16),t.j41(31,"span"),t.EFF(32,"Rep. 606"),t.k0s()()()()()(),t.j41(33,"div",17)(34,"div",18)(35,"h5",19),t.EFF(36,"Contabilidad"),t.k0s(),t.nrm(37,"button",20),t.k0s(),t.j41(38,"div",21)(39,"ul",22)(40,"li",11)(41,"a",23),t.nrm(42,"i",13),t.j41(43,"span"),t.EFF(44,"Facturas Pendientes"),t.k0s()()()()()(),t.j41(45,"div",24)(46,"div",25),t.nrm(47,"router-outlet"),t.k0s()()()()),2&n&&(t.R7$(14),t.Y8G("routerLink",t.lJ4(5,b)),t.R7$(5),t.Y8G("routerLink",t.lJ4(6,f)),t.R7$(5),t.Y8G("routerLink",t.lJ4(7,g)),t.R7$(5),t.Y8G("routerLink",t.lJ4(8,m)),t.R7$(12),t.Y8G("routerLink",t.lJ4(9,b)))},dependencies:[u.n3,u.Wk,u.wQ],styles:[".nav-link[_ngcontent-%COMP%]{color:#faf7f7}.nav-link.active[_ngcontent-%COMP%]{text-decoration:none;color:#af3d2c;font-size:18px;font-weight:700;padding:2px 5px;border-radius:8px;margin:0 10px;background-color:#f0f0f0}.sidebar-nav[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]{color:#212529}.sidebar-nav[_ngcontent-%COMP%]   .nav-link.active[_ngcontent-%COMP%]{background-color:#f7f8fa;color:#611616}.sidebar[_ngcontent-%COMP%]{background-color:#f8f9fa;min-height:100%}.sidebar[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}.sidebar[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background-color:#0003;border-radius:3px}.sidebar[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:transparent}"]})}}return a})();var F=r(8032),o=r.n(F),k=r(1757);function v(a,c){1&a&&(t.j41(0,"tr")(1,"td",17)(2,"div",18)(3,"span",19),t.EFF(4,"Cargando..."),t.k0s()(),t.j41(5,"p",20),t.EFF(6,"Cargando facturas..."),t.k0s()()())}function x(a,c){1&a&&(t.j41(0,"tr")(1,"td",21),t.nrm(2,"i",22),t.EFF(3," No hay facturas pendientes de env\xedo "),t.k0s()())}const C=function(a,c,e){return{"bg-warning text-dark":a,"bg-danger":c,"bg-success":e}};function E(a,c){if(1&a){const e=t.RV6();t.j41(0,"tr")(1,"td",23),t.EFF(2),t.k0s(),t.j41(3,"td"),t.EFF(4),t.k0s(),t.j41(5,"td")(6,"span",24),t.EFF(7),t.k0s()(),t.j41(8,"td"),t.EFF(9),t.k0s(),t.j41(10,"td",25),t.EFF(11),t.nI1(12,"currency"),t.k0s(),t.j41(13,"td",12)(14,"span",26),t.EFF(15),t.k0s()(),t.j41(16,"td",13)(17,"div",27)(18,"button",28),t.bIt("click",function(){const l=t.eBV(e).$implicit,s=t.XpG();return t.Njj(s.enviar(l))}),t.nrm(19,"i",29),t.k0s(),t.j41(20,"button",30),t.bIt("click",function(){const l=t.eBV(e).$implicit,s=t.XpG();return t.Njj(s.verXml(l))}),t.nrm(21,"i",31),t.k0s()()()()}if(2&a){const e=c.$implicit;t.R7$(2),t.JRh(e.fa_codFact),t.R7$(2),t.JRh(e.fa_ncfFact||"N/A"),t.R7$(3),t.JRh(e.tipoEcf||"N/A"),t.R7$(2),t.JRh(e.signatureDateTime||e.signatureDateTime),t.R7$(2),t.JRh(t.ii3(12,7,e.fa_valFact,"DOP","symbol","1.2-2")),t.R7$(3),t.Y8G("ngClass",t.sMw(12,C,"PENDIENTE"===(e.status||e.Status),"ERROR"===(e.status||e.Status),"ENVIADO"===(e.status||e.Status))),t.R7$(1),t.JRh(e.status||e.Status||"PENDIENTE")}}function j(a,c){if(1&a){const e=t.RV6();t.j41(0,"div",32)(1,"nav",33)(2,"ul",34)(3,"li",35)(4,"button",36),t.bIt("click",function(){t.eBV(e);const i=t.XpG();return t.Njj(i.cambiarPagina(i.page-1))}),t.nrm(5,"i",37),t.k0s()(),t.j41(6,"li",38)(7,"span",39),t.EFF(8),t.k0s()(),t.j41(9,"li",35)(10,"button",36),t.bIt("click",function(){t.eBV(e);const i=t.XpG();return t.Njj(i.cambiarPagina(i.page+1))}),t.nrm(11,"i",40),t.k0s()()()()()}if(2&a){const e=t.XpG();t.R7$(3),t.AVh("disabled",1===e.page),t.R7$(5),t.Lme(" P\xe1gina ",e.page," de ",e.totalPages," "),t.R7$(1),t.AVh("disabled",e.page===e.totalPages)}}const P=[{path:"",component:h,children:[{path:"facturas-pendientes",component:(()=>{class a{constructor(e){this.servicioFacturacion=e,this.facturas=[],this.page=1,this.pageSize=10,this.total=0,this.loading=!1,this.allFacturas=[]}ngOnInit(){this.cargarFacturas()}cargarFacturas(){this.loading=!0,this.servicioFacturacion.buscarFacturasPendientesDgii().subscribe({next:e=>{console.log("Facturas Pendientes Response:",e),this.allFacturas=e.data||[],this.total=this.allFacturas.length,this.updatePaginatedFacturas(),this.loading=!1},error:e=>{console.error(e),this.loading=!1,o().fire("Error","No se pudieron cargar las facturas pendientes","error")}})}updatePaginatedFacturas(){const e=(this.page-1)*this.pageSize;this.facturas=this.allFacturas.slice(e,e+this.pageSize)}cambiarPagina(e){this.page=e,this.updatePaginatedFacturas()}enviar(e){o().fire("Info","Funcionalidad de env\xedo en desarrollo","info")}verXml(e){const n=e.xmls?.ecf||e.xmls?.rfce||e.xmls?.ECF||e.xmls?.RFCE||"No hay XML disponible",l=n.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;");o().fire({title:"Vista Previa del XML",html:`\n        <div style="text-align: left; max-height: 400px; overflow-y: auto; background: #f4f4f4; padding: 10px; border-radius: 5px;">\n          <pre><code class="language-xml" style="font-size: 12px; font-family: monospace;">${l}</code></pre>\n        </div>\n      `,width:"800px",showCloseButton:!0,focusConfirm:!1,confirmButtonText:'<i class="bi bi-clipboard"></i> Copiar',confirmButtonAriaLabel:"Copiar XML",showCancelButton:!0,cancelButtonText:"Cerrar",preConfirm:()=>(navigator.clipboard.writeText(n).then(()=>{o().showValidationMessage("\xa1Copiado al portapapeles!"),setTimeout(()=>o().resetValidationMessage(),1500)},s=>{console.error("Error al copiar: ",s),o().showValidationMessage("Error al copiar")}),!1)})}get totalPages(){return Math.ceil(this.total/this.pageSize)}get pages(){const e=[];for(let n=1;n<=this.totalPages;n++)e.push(n);return e}static{this.\u0275fac=function(n){return new(n||a)(t.rXU(k._))}}static{this.\u0275cmp=t.VBU({type:a,selectors:[["app-facturas-pendientes"]],decls:32,vars:4,consts:[[1,"container-fluid","p-4"],[1,"d-flex","justify-content-between","align-items-center","mb-4"],[1,"h4","mb-0","text-primary"],[1,"btn","btn-outline-primary",3,"click"],[1,"bi","bi-arrow-clockwise","me-2"],[1,"card","shadow-sm","border-0"],[1,"card-body","p-0"],[1,"table-responsive"],[1,"table","table-hover","align-middle","mb-0"],[1,"bg-light"],[1,"ps-4"],[1,"text-end"],[1,"text-center"],[1,"text-end","pe-4"],[4,"ngIf"],[4,"ngFor","ngForOf"],["class","card-footer bg-white py-3 border-top-0",4,"ngIf"],["colspan","7",1,"text-center","py-5"],["role","status",1,"spinner-border","text-primary"],[1,"visually-hidden"],[1,"text-muted","mt-2","mb-0"],["colspan","7",1,"text-center","py-5","text-muted"],[1,"bi","bi-inbox","fs-1","d-block","mb-2"],[1,"ps-4","fw-medium"],[1,"badge","bg-light","text-dark","border"],[1,"text-end","fw-bold"],[1,"badge",3,"ngClass"],[1,"btn-group","btn-group-sm"],["title","Enviar a DGII",1,"btn","btn-outline-success",3,"click"],[1,"bi","bi-send"],["title","Ver XML",1,"btn","btn-outline-secondary",3,"click"],[1,"bi","bi-file-earmark-code"],[1,"card-footer","bg-white","py-3","border-top-0"],["aria-label","Page navigation"],[1,"pagination","justify-content-center","mb-0"],[1,"page-item"],[1,"page-link","border-0",3,"click"],[1,"bi","bi-chevron-left"],[1,"page-item","disabled"],[1,"page-link","border-0","text-muted"],[1,"bi","bi-chevron-right"]],template:function(n,i){1&n&&(t.j41(0,"div",0)(1,"div",1)(2,"h2",2),t.EFF(3,"Facturas Pendientes de Env\xedo DGII"),t.k0s(),t.j41(4,"button",3),t.bIt("click",function(){return i.cargarFacturas()}),t.nrm(5,"i",4),t.EFF(6,"Actualizar "),t.k0s()(),t.j41(7,"div",5)(8,"div",6)(9,"div",7)(10,"table",8)(11,"thead",9)(12,"tr")(13,"th",10),t.EFF(14,"No. Factura"),t.k0s(),t.j41(15,"th"),t.EFF(16,"ENCF"),t.k0s(),t.j41(17,"th"),t.EFF(18,"Tipo e-CF"),t.k0s(),t.j41(19,"th"),t.EFF(20,"Fecha Firma"),t.k0s(),t.j41(21,"th",11),t.EFF(22,"Monto Total"),t.k0s(),t.j41(23,"th",12),t.EFF(24,"Status"),t.k0s(),t.j41(25,"th",13),t.EFF(26,"Acciones"),t.k0s()()(),t.j41(27,"tbody"),t.DNE(28,v,7,0,"tr",14),t.DNE(29,x,4,0,"tr",14),t.DNE(30,E,22,16,"tr",15),t.k0s()()()(),t.DNE(31,j,12,6,"div",16),t.k0s()()),2&n&&(t.R7$(28),t.Y8G("ngIf",i.loading),t.R7$(1),t.Y8G("ngIf",!i.loading&&0===i.facturas.length),t.R7$(1),t.Y8G("ngForOf",i.facturas),t.R7$(1),t.Y8G("ngIf",i.totalPages>1))},dependencies:[d.YU,d.Sq,d.bT,d.oe]})}}return a})()},{path:"",redirectTo:"facturas-pendientes",pathMatch:"full"}]}];let _=(()=>{class a{static{this.\u0275fac=function(n){return new(n||a)}}static{this.\u0275mod=t.$C({type:a})}static{this.\u0275inj=t.G2t({imports:[u.iI.forChild(P),u.iI]})}}return a})(),y=(()=>{class a{static{this.\u0275fac=function(n){return new(n||a)}}static{this.\u0275mod=t.$C({type:a})}static{this.\u0275inj=t.G2t({imports:[d.MD,_]})}}return a})()}}]);