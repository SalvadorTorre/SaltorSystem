"use strict";(self.webpackChunkSaltorSystem=self.webpackChunkSaltorSystem||[]).push([[715],{8715:(w,u,s)=>{s.r(u),s.d(u,{ModuloSalidafactura:()=>y});var n=s(177),l=s(9417),h=s(8032),m=s.n(h),t=s(8699),f=s(9287);let p=(()=>{class i{constructor(a){this.http=a}guardarSalidafactura(a){return this.http.PostRequest("/salidafactura",a)}editarSalidafacturac(a,e){return this.http.PutRequest(`/salidafactura/${a}`,e)}buscarTodasSalidafactura(a,e){let o="/salidas";return console.log(o),this.http.GetRequest(o)}eliminarSalidafactura(a){return this.http.DeleteRequest(`/eliminar-salidafactura/${a}`,"")}buscarSalidafacturaPorchofer(a,e,o){return this.http.GetRequest(`/entradamerc/${o}`)}buscarSalidafactura(a,e,o,r){let c=`/saidafactura?page=${a}&limit=${e}`;return o&&(c+=`&codigo=${o}`),r&&(c+=`&numFact=${r}`),this.http.GetRequest(c)}buscardetSalidafactura(a){return console.log(a),this.http.GetRequest(`/detsalidafa/${a}`)}buscardetSalidaid(a){return this.http.GetRequest(`/detsalidaid/${a}`)}bucarSalidafacturaid(a){return this.http.GetRequest(`/salida/${a}`)}static{this.\u0275fac=function(e){return new(e||i)(t.KVO(f.a))}}static{this.\u0275prov=t.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var b=s(8079),g=s(1757);const S=["nomchoferInput"],F=["facturaInput"];function v(i,d){if(1&i){const a=t.RV6();t.j41(0,"tr",39)(1,"td",40),t.EFF(2),t.k0s(),t.j41(3,"td",40),t.EFF(4),t.k0s(),t.j41(5,"td",40),t.EFF(6),t.k0s(),t.j41(7,"td",40),t.EFF(8),t.k0s(),t.j41(9,"td",40)(10,"button",41),t.bIt("click",function(){const r=t.eBV(a).$implicit,c=t.XpG();return t.Njj(c.consultarSalidaFactura(r))}),t.nrm(11,"i",42),t.k0s()()()}if(2&i){const a=d.$implicit;t.R7$(2),t.JRh(a.codSalida),t.R7$(2),t.JRh(a.nomChofer),t.R7$(2),t.JRh(a.fecSalida),t.R7$(2),t.JRh(a.status)}}function C(i,d){if(1&i){const a=t.RV6();t.j41(0,"tr",39)(1,"td",40),t.EFF(2),t.k0s(),t.j41(3,"td",40),t.EFF(4),t.k0s(),t.j41(5,"td",40),t.EFF(6),t.nI1(7,"date"),t.k0s(),t.j41(8,"td",43),t.EFF(9),t.k0s(),t.j41(10,"td",40)(11,"button",44),t.bIt("click",function(){const r=t.eBV(a).$implicit,c=t.XpG();return t.Njj(c.eliminarFactura(r.codFact))}),t.nrm(12,"i",45),t.k0s()()()}if(2&i){const a=d.$implicit;t.R7$(2),t.JRh(a.codFact),t.R7$(2),t.JRh(a.nomClie),t.R7$(2),t.JRh(t.i5U(7,4,a.fecFact,"dd/MM/yyyy")),t.R7$(3),t.JRh(a.valFact)}}let k=(()=>{class i{constructor(a,e,o,r,c){this.fb=a,this.servicioSalidafactura=e,this.servicioChofer=o,this.servicioFacturacion=r,this.http=c,this.codChofer="",this.factura="",this.pageSize=8,this.currentPage=1,this.maxPagesToShow=5,this.codigo="",this.fecha="",this.txtnumfact="",this.txtnumsalida="",this.txtcodSalida="",this.txtcodFact="",this.codnotfound=!1,this.habilitarFormulario=!1,this.modoedicionSalidafactura=!1,this.modoconsultaSalidafactura=!1,this.SalidafacturaList=[],this.detSalidafacturaList=[],this.selectedSalidafactura=null,this.Items=[],this.codFact="",this.codSalida="",this.codchoferVacio=!1,this.mensagePantalla=!1,this.habilitarCampos=!1,this.selectedRow=-1,this.selectedItem=null,this.mensaje="",this.chofer={nombre:""},this.form=this.fb.group({codChofer:["",l.k0.required]}),this.formularioSalidafactura=this.fb.group({fecSalida:[{value:"",disabled:!0}],codSalida:[{value:"",disabled:!0}]}),this.crearFormularioSalidafactura()}ngOnInit(){this.buscarTodasSalidafactura(this.currentPage)}buscarTodasSalidafactura(a){this.servicioSalidafactura.buscarTodasSalidafactura(a,this.pageSize).subscribe(e=>{this.SalidafacturaList=e.data})}crearFormularioSalidafactura(){this.formatofecha(new Date),this.formularioSalidafactura=this.fb.group({codSalida:[""],fecSalida:[""],valSalida:[""],horaSalida:[""],nomChofer:[""],codChofer:[""],canFactura:[""],valPagado:[""],valDevolucion:[""],cedChofer:[""],status:[""],envia:[""],preparado:[""],txtcodFact:[""]})}habilitarFormularioEmpresa(){this.habilitarFormulario=!1}formatofecha(a){const e=a.getFullYear(),o=(a.getMonth()+1).toString().padStart(2,"0");return`${a.getDate().toString().padStart(2,"0")}/${o}/${e}`}nuevaSalidafactura(){this.modoedicionSalidafactura=!1,this.tituloModalSalidafactura="Nueva Entrada Mercancias",$("#modalSalidafactura").modal("show"),this.habilitarFormulario=!0,this.formularioSalidafactura.get("me_codEntr").disable(),this.formularioSalidafactura.get("me_fecEntr").disable(),this.formularioSalidafactura.get("me_nomVend").disable(),setTimeout(()=>{$("#input1").focus()},500)}limpiaBusqueda(){this.txtnumfact="",this.txtnumsalida=""}consultarSalidaFactura(a){this.modoconsultaSalidafactura=!0,this.formularioSalidafactura.patchValue(a),this.formularioSalidafactura.disable(),this.tituloModalSalidafactura="Consultando Salida Factura",document.querySelectorAll(".seccion-productos input"),this.servicioSalidafactura.buscardetSalidaid(a.codSalida).subscribe(o=>{this.detSalidafacturaList=o.data})}buscarSalidaFactura(a){console.log(a),this.servicioSalidafactura.buscardetSalidafactura(a).subscribe(e=>{console.log("Resultado",e),this.SalidafacturaList=[],this.SalidafacturaList.push(e.data),this.servicioSalidafactura.buscardetSalidaid(e.data.codSalida).subscribe(o=>{this.detSalidafacturaList=o.data})})}buscarSalidaCodigo(a){console.log(a),this.servicioSalidafactura.bucarSalidafacturaid(a).subscribe(e=>{console.log("Resultado",e),this.SalidafacturaList=[],this.SalidafacturaList.push(e.data),this.consultarSalidaFactura(e.data)})}buscarporCodigo(){const a=this.formularioSalidafactura.get("codChofer")?.value;a&&""!==a.trim()?this.servicioChofer.buscarchoferporCodigo(parseInt(a,10)).subscribe(e=>{console.log(e.data),e.data?(this.chofer=e.data,this.formularioSalidafactura.patchValue(e.data[0]),this.mensaje="",this.facturaInput.nativeElement.focus()):(this.chofer={nombre:""},this.mensaje="No se encontr\xf3 un despachador con esa c\xe9dula")}):this.nomchoferInput.nativeElement.focus()}navigateTable(a){const e=a.key;"ArrowDown"===e?this.selectedRow<this.Items.length-1&&(this.selectedRow++,this.selectRow(this.selectedRow)):"ArrowUp"===e&&this.selectedRow>0&&(this.selectedRow--,this.selectRow(this.selectedRow))}selectRow(a){this.selectedRow=a,this.selectedItem=this.Items[a],console.log(this.selectedItem)}moveFocus(a,e){"Enter"===a.key&&e&&(a.preventDefault(),e.focus())}moveFocuscodchofer(a,e){("Enter"===a.key||"Tab"===a.key)&&(a.preventDefault(),this.codchoferVacio=""===a.target.value.trim(),this.codnotfound?(console.log(this.codnotfound),this.mensagePantalla=!0,m().fire({icon:"error",title:"A V I S O",text:"Codigo invalido.",focusConfirm:!0,allowEnterKey:!0}).then(()=>{this.mensagePantalla=!1}),this.codchoferVacio=!1):(!0===this.codchoferVacio?(e.focus(),this.codchoferVacio=!1,console.log("vedadero blas")):($("#facturaInput").focus(),$("#facturaInput").select()),this.codchoferVacio=!1))}buscarFactura(){const a=this.formularioSalidafactura.get("txtcodFact")?.value;console.log("Buscando Factura",a),a&&""!==a.trim()?this.servicioFacturacion.getByNumero(a).subscribe({next:e=>{if(e&&e.data){const o={codFact:e.data.codFact,nomClie:e.data.nomClie,fecFact:e.data.fecFact,valFact:e.data.valFact,valAbono:0},r=this.detSalidafacturaList.some(c=>c.codFact===o.codFact);console.log(r),r?alert("Esta factura ya fue agregada."):this.detSalidafacturaList.push(o),this.txtcodFact=""}else alert("No se encontr\xf3 factura con ese n\xfamero")},error:e=>{console.error(e),alert("Error al buscar la factura")}}):alert("Debe ingresar un n\xfamero de factura")}eliminarFactura(a){this.detSalidafacturaList=this.detSalidafacturaList.filter(e=>e.codFact!==a)}static{this.\u0275fac=function(e){return new(e||i)(t.rXU(l.ok),t.rXU(p),t.rXU(b.Y),t.rXU(g._),t.rXU(f.a))}}static{this.\u0275cmp=t.VBU({type:i,selectors:[["Salidafactua"]],viewQuery:function(e,o){if(1&e&&(t.GBs(S,5),t.GBs(F,5)),2&e){let r;t.mGM(r=t.lsd())&&(o.nomchoferInput=r.first),t.mGM(r=t.lsd())&&(o.facturaInput=r.first)}},decls:83,vars:5,consts:[[1,"row","g-4"],[1,"col-lg-5","col-md-12","mb-4"],[1,"card","shadow-sm","rounded-2","border-0"],[1,"card-header","py-3",2,"background","#343a40","border-radius","0.5rem 0.5rem 0 0"],[1,"card-title","m-0","text-white","text-center",2,"font-weight","600","letter-spacing","1px"],[1,"card-body","bg-light","rounded-bottom-2"],[1,"mb-3"],[1,"form-label","fw-bold"],[1,"row","g-2"],[1,"col"],["type","text","placeholder","No. de Control",1,"form-control","form-control-sm","rounded-pill","shadow-sm",3,"ngModel","ngModelChange","keyup.enter"],["type","text","formControlName","txtnomChofer","placeholder","Nombre Chofer",1,"form-control","form-control-sm","rounded-pill","shadow-sm"],["type","text","placeholder","No. Factura",1,"form-control","form-control-sm","rounded-pill","shadow-sm",3,"ngModel","ngModelChange","keyup.enter"],[1,"table-responsive",2,"height","400px","overflow-y","auto","border-radius","0.5rem","border","1px solid #343a40","background","#fff"],[1,"table","table-hover","align-middle","mb-0"],[2,"background","#495057","color","#fff"],[1,"text-center","text-white",2,"width","20%","text-transform","uppercase"],[1,"text-center","text-white",2,"width","30%","text-transform","uppercase"],[1,"text-center","text-white",2,"width","15%","text-transform","uppercase"],[1,"text-center","text-white",2,"width","16%","text-transform","uppercase"],[1,"text-center","text-white",2,"text-transform","uppercase"],["class","table-row",4,"ngFor","ngForOf"],[1,"col-lg-7","col-md-12","mb-4"],[1,"mb-3",3,"formGroup"],[1,"row","g-2","mb-2"],[1,"col-md-2"],["type","text","formControlName","status","readonly","",1,"form-control","form-control-sm","rounded-pill","shadow-sm"],[1,"form-label"],["type","text","formControlName","codSalida","readonly","",1,"form-control","form-control-sm","rounded-pill","shadow-sm"],["type","date","formControlName","fecSalida","readonly","",1,"form-control","form-control-sm","rounded-pill","shadow-sm"],["type","text","formControlName","codChofer","name","codChofer",1,"form-control","form-control-sm","rounded-pill","shadow-sm",3,"keyup.enter"],["codChoferInput",""],[1,"col-md-4"],["type","text","formControlName","nomChofer",1,"form-control","form-control-sm","rounded-pill","shadow-sm"],["nomchoferInput",""],["type","text","id","facturaInput","formControlName","txtcodFact","placeholder","No. de Factura",1,"form-control","form-control-sm","rounded-pill","shadow-sm",3,"keydown.enter"],[1,"table-responsive",2,"height","350px","overflow-y","auto","border-radius","0.5rem","border","1px solid #343a40","background","#fff"],[1,"text-center","text-white",2,"width","37%","text-transform","uppercase"],[1,"text-center","text-white",2,"width","13%","text-transform","uppercase"],[1,"table-row"],[1,"text-center"],["title","Ver Detalles",1,"btn","btn-outline-primary","btn-sm","rounded-circle","shadow-sm",3,"click"],[1,"bi","bi-card-list"],[1,"text-end"],["title","Eliminar",1,"btn","btn-outline-danger","btn-sm","rounded-circle","shadow-sm",3,"click"],[1,"bi","bi-trash"]],template:function(e,o){1&e&&(t.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h4",4),t.EFF(5,"CONTROLES SALIDA FACTURA"),t.k0s()(),t.j41(6,"div",5)(7,"div",6)(8,"label",7),t.EFF(9,"Buscar Por"),t.k0s(),t.j41(10,"div",8)(11,"div",9)(12,"input",10),t.bIt("ngModelChange",function(c){return o.txtcodSalida=c})("keyup.enter",function(){return o.buscarSalidaCodigo(o.txtcodSalida)}),t.k0s()(),t.j41(13,"div",9),t.nrm(14,"input",11),t.k0s(),t.j41(15,"div",9)(16,"input",12),t.bIt("ngModelChange",function(c){return o.txtcodFact=c})("keyup.enter",function(){return o.buscarSalidaFactura(o.txtcodFact)}),t.k0s()()()(),t.j41(17,"div",13)(18,"table",14)(19,"thead",15)(20,"tr")(21,"th",16),t.EFF(22,"NO. CONTROL"),t.k0s(),t.j41(23,"th",17),t.EFF(24,"CHOFER"),t.k0s(),t.j41(25,"th",18),t.EFF(26,"FECHA"),t.k0s(),t.j41(27,"th",19),t.EFF(28,"STATUS"),t.k0s(),t.j41(29,"th",20),t.EFF(30,"OPCIONES"),t.k0s()()(),t.j41(31,"tbody"),t.DNE(32,v,12,4,"tr",21),t.k0s()()()()()(),t.j41(33,"div",22)(34,"div",2)(35,"div",3)(36,"h4",4),t.EFF(37,"DETALLES CONTROL SALIDA FACTURA"),t.k0s()(),t.j41(38,"div",5)(39,"form",23)(40,"div",24),t.nrm(41,"div",25),t.j41(42,"div",25),t.nrm(43,"input",26),t.k0s(),t.nrm(44,"div",25),t.j41(45,"div",25)(46,"label",27),t.EFF(47,"No. Control"),t.k0s()(),t.j41(48,"div",25),t.nrm(49,"input",28),t.k0s(),t.j41(50,"div",25),t.nrm(51,"input",29),t.k0s()(),t.j41(52,"div",24)(53,"div",25)(54,"label",27),t.EFF(55,"Cod Chofer"),t.k0s(),t.j41(56,"input",30,31),t.bIt("keyup.enter",function(){return o.buscarporCodigo()}),t.k0s()(),t.j41(58,"div",32)(59,"label",27),t.EFF(60,"Chofer"),t.k0s(),t.nrm(61,"input",33,34),t.k0s(),t.j41(63,"div",25)(64,"label",27),t.EFF(65,"Factura"),t.k0s(),t.j41(66,"input",35),t.bIt("keydown.enter",function(){return o.buscarFactura()}),t.k0s()()()(),t.j41(67,"div",36)(68,"table",14)(69,"thead",15)(70,"tr")(71,"th",18),t.EFF(72,"FACTURA"),t.k0s(),t.j41(73,"th",37),t.EFF(74,"CLIENTE"),t.k0s(),t.j41(75,"th",38),t.EFF(76,"FECHA"),t.k0s(),t.j41(77,"th",16),t.EFF(78,"VALOR"),t.k0s(),t.j41(79,"th",20),t.EFF(80,"OPCIONES"),t.k0s()()(),t.j41(81,"tbody"),t.DNE(82,C,13,7,"tr",21),t.k0s()()()()()()()),2&e&&(t.R7$(12),t.Y8G("ngModel",o.txtcodSalida),t.R7$(4),t.Y8G("ngModel",o.txtcodFact),t.R7$(16),t.Y8G("ngForOf",o.SalidafacturaList),t.R7$(7),t.Y8G("formGroup",o.formularioSalidafactura),t.R7$(43),t.Y8G("ngForOf",o.detSalidafacturaList))},dependencies:[n.Sq,l.qT,l.me,l.BC,l.cb,l.j4,l.JD,l.vS,n.vh],styles:[".table-responsive[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{position:sticky;top:0;z-index:2;background-color:#0f1f6a}tfoot[_ngcontent-%COMP%]{position:sticky;bottom:0;background-color:#f1f1f1;z-index:1}.table-responsive[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .table-responsive[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:1px;border:1px solid #ccc}.custom-input[_ngcontent-%COMP%]{height:10px;padding:15px;font-size:14px}.custom-input[_ngcontent-%COMP%]:focus{outline:none;border-color:#007bff}.form-check[_ngcontent-%COMP%]{margin-bottom:30px}.custom-space[_ngcontent-%COMP%]{margin-bottom:10px}.form-check-label[_ngcontent-%COMP%]{margin-left:5x}.custom-label[_ngcontent-%COMP%]{color:#000209;font-size:16px;font-weight:700;text-decoration:underline}.card[_ngcontent-%COMP%]{margin:0;padding:0}.name-find[_ngcontent-%COMP%]{margin-bottom:14px;text-decoration:none!important}.active[_ngcontent-%COMP%]{background-color:#007bff;color:#fff}i[_ngcontent-%COMP%]{cursor:pointer}"]})}}return i})();var R=s(8871);const x=[{path:"",component:k}];let y=(()=>{class i{static{this.\u0275fac=function(e){return new(e||i)}}static{this.\u0275mod=t.$C({type:i})}static{this.\u0275inj=t.G2t({imports:[n.MD,l.X1,l.YN,R.iI.forChild(x)]})}}return i})()}}]);